2015-09-30 05:11:31 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 05:11:31 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 05:11:31 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 05:11:31 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 05:11:31 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 05:11:31 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 05:11:31 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 05:11:31 [scrapy] INFO: Spider opened
2015-09-30 05:11:31 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 05:11:31 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 05:11:35 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 05:11:37 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 05:11:43 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 05:11:48 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 05:11:49 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 05:11:49 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 05:11:53 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:11:53 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:53 [root] WARNING: horse code set
2015-09-30 05:11:53 [root] WARNING: 1
2015-09-30 05:11:53 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:53 [root] WARNING: horse code set
2015-09-30 05:11:53 [root] WARNING: 2
2015-09-30 05:11:53 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:53 [root] WARNING: horse code set
2015-09-30 05:11:53 [root] WARNING: 3
2015-09-30 05:11:53 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:53 [root] WARNING: horse code set
2015-09-30 05:11:53 [root] WARNING: 4
2015-09-30 05:11:53 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:53 [root] WARNING: horse code set
2015-09-30 05:11:53 [root] WARNING: 5
2015-09-30 05:11:53 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:53 [root] WARNING: horse code set
2015-09-30 05:11:53 [root] WARNING: 6
2015-09-30 05:11:53 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:53 [root] WARNING: horse code set
2015-09-30 05:11:53 [root] WARNING: 7
2015-09-30 05:11:53 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:53 [root] WARNING: horse code set
2015-09-30 05:11:53 [root] WARNING: 8
2015-09-30 05:11:53 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:53 [root] WARNING: horse code set
2015-09-30 05:11:53 [root] WARNING: 9
2015-09-30 05:11:53 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:53 [root] WARNING: horse code set
2015-09-30 05:11:53 [root] WARNING: 10
2015-09-30 05:11:53 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:53 [root] WARNING: horse code set
2015-09-30 05:11:53 [root] WARNING: 11
2015-09-30 05:11:53 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:53 [root] WARNING: horse code set
2015-09-30 05:11:53 [root] WARNING: 12
2015-09-30 05:11:53 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:53 [root] WARNING: horse code set
2015-09-30 05:11:53 [root] WARNING: 13
2015-09-30 05:11:53 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:53 [root] WARNING: horse code set
2015-09-30 05:11:53 [root] WARNING: 14
2015-09-30 05:11:56 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:11:56 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:56 [root] WARNING: horse code set
2015-09-30 05:11:56 [root] WARNING: 15
2015-09-30 05:11:56 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:56 [root] WARNING: horse code set
2015-09-30 05:11:56 [root] WARNING: 16
2015-09-30 05:11:56 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:56 [root] WARNING: horse code set
2015-09-30 05:11:56 [root] WARNING: 17
2015-09-30 05:11:56 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:56 [root] WARNING: horse code set
2015-09-30 05:11:56 [root] WARNING: 18
2015-09-30 05:11:56 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:56 [root] WARNING: horse code set
2015-09-30 05:11:56 [root] WARNING: 19
2015-09-30 05:11:56 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:56 [root] WARNING: horse code set
2015-09-30 05:11:56 [root] WARNING: 20
2015-09-30 05:11:56 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:56 [root] WARNING: horse code set
2015-09-30 05:11:56 [root] WARNING: 21
2015-09-30 05:11:56 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:56 [root] WARNING: horse code set
2015-09-30 05:11:56 [root] WARNING: 22
2015-09-30 05:11:56 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:56 [root] WARNING: horse code set
2015-09-30 05:11:56 [root] WARNING: 23
2015-09-30 05:11:56 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:56 [root] WARNING: horse code set
2015-09-30 05:11:56 [root] WARNING: 24
2015-09-30 05:11:56 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:56 [root] WARNING: horse code set
2015-09-30 05:11:56 [root] WARNING: 25
2015-09-30 05:11:56 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:56 [root] WARNING: horse code set
2015-09-30 05:11:56 [root] WARNING: 26
2015-09-30 05:11:56 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:56 [root] WARNING: horse code set
2015-09-30 05:11:56 [root] WARNING: 27
2015-09-30 05:11:56 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:56 [root] WARNING: horse code set
2015-09-30 05:11:56 [root] WARNING: 28
2015-09-30 05:11:58 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:11:58 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:58 [root] WARNING: horse code set
2015-09-30 05:11:58 [root] WARNING: 29
2015-09-30 05:11:58 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:58 [root] WARNING: horse code set
2015-09-30 05:11:58 [root] WARNING: 30
2015-09-30 05:11:58 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:58 [root] WARNING: horse code set
2015-09-30 05:11:58 [root] WARNING: 31
2015-09-30 05:11:58 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:58 [root] WARNING: horse code set
2015-09-30 05:11:58 [root] WARNING: 32
2015-09-30 05:11:58 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:58 [root] WARNING: horse code set
2015-09-30 05:11:58 [root] WARNING: 33
2015-09-30 05:11:58 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:58 [root] WARNING: horse code set
2015-09-30 05:11:58 [root] WARNING: 34
2015-09-30 05:11:58 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:58 [root] WARNING: horse code set
2015-09-30 05:11:58 [root] WARNING: 35
2015-09-30 05:11:58 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:58 [root] WARNING: horse code set
2015-09-30 05:11:58 [root] WARNING: 36
2015-09-30 05:11:58 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:58 [root] WARNING: horse code set
2015-09-30 05:11:58 [root] WARNING: 37
2015-09-30 05:11:58 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:58 [root] WARNING: horse code set
2015-09-30 05:11:58 [root] WARNING: 38
2015-09-30 05:11:58 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:58 [root] WARNING: horse code set
2015-09-30 05:11:58 [root] WARNING: 39
2015-09-30 05:11:58 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:58 [root] WARNING: horse code set
2015-09-30 05:11:58 [root] WARNING: 40
2015-09-30 05:11:58 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:58 [root] WARNING: horse code set
2015-09-30 05:11:58 [root] WARNING: 41
2015-09-30 05:11:58 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:58 [root] WARNING: horse code set
2015-09-30 05:11:58 [root] WARNING: 42
2015-09-30 05:11:58 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:11:58 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:58 [root] WARNING: horse code set
2015-09-30 05:11:58 [root] WARNING: 43
2015-09-30 05:11:58 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:58 [root] WARNING: horse code set
2015-09-30 05:11:58 [root] WARNING: 44
2015-09-30 05:11:58 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:58 [root] WARNING: horse code set
2015-09-30 05:11:58 [root] WARNING: 45
2015-09-30 05:11:58 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:58 [root] WARNING: horse code set
2015-09-30 05:11:58 [root] WARNING: 46
2015-09-30 05:11:58 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:58 [root] WARNING: horse code set
2015-09-30 05:11:58 [root] WARNING: 47
2015-09-30 05:11:58 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:58 [root] WARNING: horse code set
2015-09-30 05:11:58 [root] WARNING: 48
2015-09-30 05:11:58 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:58 [root] WARNING: horse code set
2015-09-30 05:11:58 [root] WARNING: 49
2015-09-30 05:11:58 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:58 [root] WARNING: horse code set
2015-09-30 05:11:58 [root] WARNING: 50
2015-09-30 05:11:58 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:58 [root] WARNING: horse code set
2015-09-30 05:11:58 [root] WARNING: 51
2015-09-30 05:11:58 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:58 [root] WARNING: horse code set
2015-09-30 05:11:58 [root] WARNING: 52
2015-09-30 05:11:58 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:58 [root] WARNING: horse code set
2015-09-30 05:11:58 [root] WARNING: 53
2015-09-30 05:11:58 [root] WARNING: -------------------------------------------------
2015-09-30 05:11:58 [root] WARNING: horse code set
2015-09-30 05:11:58 [root] WARNING: 54
2015-09-30 05:12:01 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:12:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:01 [root] WARNING: horse code set
2015-09-30 05:12:01 [root] WARNING: 55
2015-09-30 05:12:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:01 [root] WARNING: horse code set
2015-09-30 05:12:01 [root] WARNING: 56
2015-09-30 05:12:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:01 [root] WARNING: horse code set
2015-09-30 05:12:01 [root] WARNING: 57
2015-09-30 05:12:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:01 [root] WARNING: horse code set
2015-09-30 05:12:01 [root] WARNING: 58
2015-09-30 05:12:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:01 [root] WARNING: horse code set
2015-09-30 05:12:01 [root] WARNING: 59
2015-09-30 05:12:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:01 [root] WARNING: horse code set
2015-09-30 05:12:01 [root] WARNING: 60
2015-09-30 05:12:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:01 [root] WARNING: horse code set
2015-09-30 05:12:01 [root] WARNING: 61
2015-09-30 05:12:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:01 [root] WARNING: horse code set
2015-09-30 05:12:01 [root] WARNING: 62
2015-09-30 05:12:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:01 [root] WARNING: horse code set
2015-09-30 05:12:01 [root] WARNING: 63
2015-09-30 05:12:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:01 [root] WARNING: horse code set
2015-09-30 05:12:01 [root] WARNING: 64
2015-09-30 05:12:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:01 [root] WARNING: horse code set
2015-09-30 05:12:01 [root] WARNING: 65
2015-09-30 05:12:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:01 [root] WARNING: horse code set
2015-09-30 05:12:01 [root] WARNING: 66
2015-09-30 05:12:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:01 [root] WARNING: horse code set
2015-09-30 05:12:01 [root] WARNING: 67
2015-09-30 05:12:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:01 [root] WARNING: horse code set
2015-09-30 05:12:01 [root] WARNING: 68
2015-09-30 05:12:01 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:12:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:01 [root] WARNING: horse code set
2015-09-30 05:12:01 [root] WARNING: 69
2015-09-30 05:12:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:01 [root] WARNING: horse code set
2015-09-30 05:12:01 [root] WARNING: 70
2015-09-30 05:12:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:01 [root] WARNING: horse code set
2015-09-30 05:12:01 [root] WARNING: 71
2015-09-30 05:12:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:01 [root] WARNING: horse code set
2015-09-30 05:12:01 [root] WARNING: 72
2015-09-30 05:12:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:01 [root] WARNING: horse code set
2015-09-30 05:12:01 [root] WARNING: 73
2015-09-30 05:12:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:01 [root] WARNING: horse code set
2015-09-30 05:12:01 [root] WARNING: 74
2015-09-30 05:12:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:01 [root] WARNING: horse code set
2015-09-30 05:12:01 [root] WARNING: 75
2015-09-30 05:12:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:01 [root] WARNING: horse code set
2015-09-30 05:12:01 [root] WARNING: 76
2015-09-30 05:12:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:01 [root] WARNING: horse code set
2015-09-30 05:12:01 [root] WARNING: 77
2015-09-30 05:12:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:01 [root] WARNING: horse code set
2015-09-30 05:12:01 [root] WARNING: 78
2015-09-30 05:12:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:01 [root] WARNING: horse code set
2015-09-30 05:12:01 [root] WARNING: 79
2015-09-30 05:12:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:01 [root] WARNING: horse code set
2015-09-30 05:12:01 [root] WARNING: 80
2015-09-30 05:12:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:01 [root] WARNING: horse code set
2015-09-30 05:12:01 [root] WARNING: 81
2015-09-30 05:12:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:01 [root] WARNING: horse code set
2015-09-30 05:12:01 [root] WARNING: 82
2015-09-30 05:12:02 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:12:02 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:02 [root] WARNING: horse code set
2015-09-30 05:12:02 [root] WARNING: 83
2015-09-30 05:12:02 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:02 [root] WARNING: horse code set
2015-09-30 05:12:02 [root] WARNING: 84
2015-09-30 05:12:02 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:02 [root] WARNING: horse code set
2015-09-30 05:12:02 [root] WARNING: 85
2015-09-30 05:12:02 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:02 [root] WARNING: horse code set
2015-09-30 05:12:02 [root] WARNING: 86
2015-09-30 05:12:02 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:02 [root] WARNING: horse code set
2015-09-30 05:12:02 [root] WARNING: 87
2015-09-30 05:12:02 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:02 [root] WARNING: horse code set
2015-09-30 05:12:02 [root] WARNING: 88
2015-09-30 05:12:02 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:02 [root] WARNING: horse code set
2015-09-30 05:12:02 [root] WARNING: 89
2015-09-30 05:12:02 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:02 [root] WARNING: horse code set
2015-09-30 05:12:02 [root] WARNING: 90
2015-09-30 05:12:02 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:02 [root] WARNING: horse code set
2015-09-30 05:12:02 [root] WARNING: 91
2015-09-30 05:12:02 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:02 [root] WARNING: horse code set
2015-09-30 05:12:02 [root] WARNING: 92
2015-09-30 05:12:02 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:02 [root] WARNING: horse code set
2015-09-30 05:12:02 [root] WARNING: 93
2015-09-30 05:12:02 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:12:02 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:02 [root] WARNING: horse code set
2015-09-30 05:12:02 [root] WARNING: 94
2015-09-30 05:12:02 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:02 [root] WARNING: horse code set
2015-09-30 05:12:02 [root] WARNING: 95
2015-09-30 05:12:02 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:02 [root] WARNING: horse code set
2015-09-30 05:12:02 [root] WARNING: 96
2015-09-30 05:12:02 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:02 [root] WARNING: horse code set
2015-09-30 05:12:02 [root] WARNING: 97
2015-09-30 05:12:02 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:02 [root] WARNING: horse code set
2015-09-30 05:12:02 [root] WARNING: 98
2015-09-30 05:12:02 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:02 [root] WARNING: horse code set
2015-09-30 05:12:02 [root] WARNING: 99
2015-09-30 05:12:02 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:02 [root] WARNING: horse code set
2015-09-30 05:12:02 [root] WARNING: 100
2015-09-30 05:12:02 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:02 [root] WARNING: horse code set
2015-09-30 05:12:02 [root] WARNING: 101
2015-09-30 05:12:02 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:02 [root] WARNING: horse code set
2015-09-30 05:12:02 [root] WARNING: 102
2015-09-30 05:12:02 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:02 [root] WARNING: horse code set
2015-09-30 05:12:02 [root] WARNING: 103
2015-09-30 05:12:02 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:02 [root] WARNING: horse code set
2015-09-30 05:12:02 [root] WARNING: 104
2015-09-30 05:12:02 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:02 [root] WARNING: horse code set
2015-09-30 05:12:02 [root] WARNING: 105
2015-09-30 05:12:02 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:02 [root] WARNING: horse code set
2015-09-30 05:12:02 [root] WARNING: 106
2015-09-30 05:12:02 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:02 [root] WARNING: horse code set
2015-09-30 05:12:02 [root] WARNING: 107
2015-09-30 05:12:03 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:12:03 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:03 [root] WARNING: horse code set
2015-09-30 05:12:03 [root] WARNING: 108
2015-09-30 05:12:03 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:03 [root] WARNING: horse code set
2015-09-30 05:12:03 [root] WARNING: 109
2015-09-30 05:12:03 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:03 [root] WARNING: horse code set
2015-09-30 05:12:03 [root] WARNING: 110
2015-09-30 05:12:03 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:03 [root] WARNING: horse code set
2015-09-30 05:12:03 [root] WARNING: 111
2015-09-30 05:12:03 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:03 [root] WARNING: horse code set
2015-09-30 05:12:03 [root] WARNING: 112
2015-09-30 05:12:03 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:03 [root] WARNING: horse code set
2015-09-30 05:12:03 [root] WARNING: 113
2015-09-30 05:12:03 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:03 [root] WARNING: horse code set
2015-09-30 05:12:03 [root] WARNING: 114
2015-09-30 05:12:03 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:03 [root] WARNING: horse code set
2015-09-30 05:12:03 [root] WARNING: 115
2015-09-30 05:12:03 [root] WARNING: -------------------------------------------------
2015-09-30 05:12:03 [root] WARNING: horse code set
2015-09-30 05:12:03 [root] WARNING: 116
2015-09-30 05:12:09 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T096&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:12:09 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:09 [root] WARNING: 1
2015-09-30 05:12:09 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T096&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:12:09 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T200&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:12:09 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:09 [root] WARNING: 2
2015-09-30 05:12:09 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T200&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:12:10 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:12:10 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:10 [root] WARNING: 3
2015-09-30 05:12:10 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 700, in parse_horse
    accum_prev_rpnos = list(accumu(prev_rpnos))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 310, in accumu
    total += x
TypeError: unsupported operand type(s) for +=: 'int' and 'str'
2015-09-30 05:12:10 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T009&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:12:10 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:10 [root] WARNING: 4
2015-09-30 05:12:10 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T009&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:12:10 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S439&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:12:10 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:10 [root] WARNING: 5
2015-09-30 05:12:10 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S439&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:12:12 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S010&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:12:12 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:12 [root] WARNING: 6
2015-09-30 05:12:12 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S010&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:12:12 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S398&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:12:12 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:12 [root] WARNING: 7
2015-09-30 05:12:12 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S398&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:12:14 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T288&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 05:12:14 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:14 [root] WARNING: 8
2015-09-30 05:12:14 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T288&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:12:18 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P158&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 05:12:18 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:18 [root] WARNING: 9
2015-09-30 05:12:18 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P158&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 700, in parse_horse
    accum_prev_rpnos = list(accumu(prev_rpnos))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 310, in accumu
    total += x
TypeError: unsupported operand type(s) for +=: 'int' and 'str'
2015-09-30 05:12:18 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N033&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:12:18 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:18 [root] WARNING: 10
2015-09-30 05:12:19 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N033&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:12:19 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T135&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:12:19 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:19 [root] WARNING: 11
2015-09-30 05:12:19 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T135&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:12:19 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S305&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 05:12:19 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:19 [root] WARNING: 12
2015-09-30 05:12:19 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S305&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:12:20 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P222&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:12:21 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:21 [root] WARNING: 13
2015-09-30 05:12:21 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P222&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:12:21 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S346&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 05:12:21 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:21 [root] WARNING: 14
2015-09-30 05:12:21 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S346&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 700, in parse_horse
    accum_prev_rpnos = list(accumu(prev_rpnos))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 310, in accumu
    total += x
TypeError: unsupported operand type(s) for +=: 'int' and 'str'
2015-09-30 05:12:23 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P031&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 05:12:23 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:23 [root] WARNING: 15
2015-09-30 05:12:23 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P031&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:12:28 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 05:12:28 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:28 [root] WARNING: 16
2015-09-30 05:12:28 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:12:28 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P358&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 05:12:29 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:29 [root] WARNING: 17
2015-09-30 05:12:29 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P358&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 700, in parse_horse
    accum_prev_rpnos = list(accumu(prev_rpnos))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 310, in accumu
    total += x
TypeError: unsupported operand type(s) for +=: 'int' and 'str'
2015-09-30 05:12:29 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N234&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:12:29 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:29 [root] WARNING: 18
2015-09-30 05:12:30 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N234&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:12:31 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S332&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 05:12:31 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:31 [root] WARNING: 19
2015-09-30 05:12:31 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S332&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:12:31 [scrapy] INFO: Crawled 32 pages (at 32 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 05:12:34 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S076&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 05:12:34 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:34 [root] WARNING: 20
2015-09-30 05:12:34 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S076&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 700, in parse_horse
    accum_prev_rpnos = list(accumu(prev_rpnos))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 310, in accumu
    total += x
TypeError: unsupported operand type(s) for +=: 'int' and 'str'
2015-09-30 05:12:36 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 05:12:36 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:36 [root] WARNING: 21
2015-09-30 05:12:36 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 700, in parse_horse
    accum_prev_rpnos = list(accumu(prev_rpnos))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 310, in accumu
    total += x
TypeError: unsupported operand type(s) for +=: 'int' and 'str'
2015-09-30 05:12:37 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T080&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:12:37 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:37 [root] WARNING: 22
2015-09-30 05:12:37 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T080&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:12:38 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S100&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 05:12:38 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:38 [root] WARNING: 23
2015-09-30 05:12:38 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S100&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:12:39 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S023&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 05:12:39 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:39 [root] WARNING: 24
2015-09-30 05:12:39 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S023&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 700, in parse_horse
    accum_prev_rpnos = list(accumu(prev_rpnos))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 310, in accumu
    total += x
TypeError: unsupported operand type(s) for +=: 'int' and 'str'
2015-09-30 05:12:39 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T205&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:12:39 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:39 [root] WARNING: 25
2015-09-30 05:12:39 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T205&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:12:40 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T005&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:12:40 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:40 [root] WARNING: 26
2015-09-30 05:12:40 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T005&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:12:40 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P151&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 05:12:41 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:41 [root] WARNING: 27
2015-09-30 05:12:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P151&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 700, in parse_horse
    accum_prev_rpnos = list(accumu(prev_rpnos))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 310, in accumu
    total += x
TypeError: unsupported operand type(s) for +=: 'int' and 'str'
2015-09-30 05:12:41 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V061&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:12:41 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:41 [root] WARNING: 28
2015-09-30 05:12:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V061&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:12:43 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V039&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:12:43 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T342&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:12:44 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:44 [root] WARNING: 29
2015-09-30 05:12:44 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V039&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:12:44 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P044&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 05:12:44 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:44 [root] WARNING: 30
2015-09-30 05:12:44 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T342&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:12:44 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:44 [root] WARNING: 31
2015-09-30 05:12:44 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P044&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 700, in parse_horse
    accum_prev_rpnos = list(accumu(prev_rpnos))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 310, in accumu
    total += x
TypeError: unsupported operand type(s) for +=: 'int' and 'str'
2015-09-30 05:12:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N330&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:12:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:46 [root] WARNING: 32
2015-09-30 05:12:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N330&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:12:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:12:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:47 [root] WARNING: 33
2015-09-30 05:12:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:12:49 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T333&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:12:49 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:49 [root] WARNING: 34
2015-09-30 05:12:49 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T333&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:12:51 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T340&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:12:51 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:51 [root] WARNING: 35
2015-09-30 05:12:51 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T340&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:12:54 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N226&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:12:54 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:54 [root] WARNING: 36
2015-09-30 05:12:54 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N226&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:12:56 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P097&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:12:56 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:56 [root] WARNING: 37
2015-09-30 05:12:56 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P097&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:12:57 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S397&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:12:57 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:57 [root] WARNING: 38
2015-09-30 05:12:57 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S397&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:12:59 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T168&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 05:12:59 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:59 [root] WARNING: 39
2015-09-30 05:12:59 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T168&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:12:59 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S300&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 05:12:59 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:12:59 [root] WARNING: 40
2015-09-30 05:12:59 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S300&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:00 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S209&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 05:13:00 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:00 [root] WARNING: 41
2015-09-30 05:13:00 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S209&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:02 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T002&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 05:13:02 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:02 [root] WARNING: 42
2015-09-30 05:13:02 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T002&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 700, in parse_horse
    accum_prev_rpnos = list(accumu(prev_rpnos))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 310, in accumu
    total += x
TypeError: unsupported operand type(s) for +=: 'int' and 'str'
2015-09-30 05:13:04 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 05:13:04 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:04 [root] WARNING: 43
2015-09-30 05:13:04 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:04 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S375&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 05:13:04 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:13:04 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:04 [root] WARNING: 44
2015-09-30 05:13:05 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S375&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:05 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:05 [root] WARNING: 45
2015-09-30 05:13:05 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:05 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T265&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:13:05 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:05 [root] WARNING: 46
2015-09-30 05:13:05 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T265&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:08 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S421&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:13:08 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:08 [root] WARNING: 47
2015-09-30 05:13:08 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S421&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:09 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N220&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 05:13:09 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:09 [root] WARNING: 48
2015-09-30 05:13:09 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N220&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:10 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T004&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:13:10 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:10 [root] WARNING: 49
2015-09-30 05:13:10 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T004&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:10 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P316&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 05:13:10 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:10 [root] WARNING: 50
2015-09-30 05:13:10 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P316&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 700, in parse_horse
    accum_prev_rpnos = list(accumu(prev_rpnos))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 310, in accumu
    total += x
TypeError: unsupported operand type(s) for +=: 'int' and 'str'
2015-09-30 05:13:13 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T404&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:13:13 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:13 [root] WARNING: 51
2015-09-30 05:13:13 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T404&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:15 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M227&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 05:13:15 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:15 [root] WARNING: 52
2015-09-30 05:13:15 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M227&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 700, in parse_horse
    accum_prev_rpnos = list(accumu(prev_rpnos))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 310, in accumu
    total += x
TypeError: unsupported operand type(s) for +=: 'int' and 'str'
2015-09-30 05:13:16 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T215&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:13:16 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:16 [root] WARNING: 53
2015-09-30 05:13:16 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T215&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:19 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 05:13:19 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:19 [root] WARNING: 54
2015-09-30 05:13:19 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 700, in parse_horse
    accum_prev_rpnos = list(accumu(prev_rpnos))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 310, in accumu
    total += x
TypeError: unsupported operand type(s) for +=: 'int' and 'str'
2015-09-30 05:13:21 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N386&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:13:21 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:21 [root] WARNING: 55
2015-09-30 05:13:21 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N386&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:21 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N432&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:13:21 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:21 [root] WARNING: 56
2015-09-30 05:13:21 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N432&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:21 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P173&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:13:21 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:21 [root] WARNING: 57
2015-09-30 05:13:22 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P173&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:22 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S349&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:13:22 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:22 [root] WARNING: 58
2015-09-30 05:13:22 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S349&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:23 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:13:23 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:23 [root] WARNING: 59
2015-09-30 05:13:23 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:24 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:13:24 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:24 [root] WARNING: 60
2015-09-30 05:13:24 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:29 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:13:29 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:29 [root] WARNING: 61
2015-09-30 05:13:29 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:29 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S165&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 05:13:29 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:29 [root] WARNING: 62
2015-09-30 05:13:30 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S165&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:30 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 05:13:30 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T111&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 05:13:30 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:30 [root] WARNING: 63
2015-09-30 05:13:30 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:30 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:30 [root] WARNING: 64
2015-09-30 05:13:30 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T111&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:31 [scrapy] INFO: Crawled 77 pages (at 45 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 05:13:31 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S225&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 05:13:31 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:31 [root] WARNING: 65
2015-09-30 05:13:31 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S225&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:33 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 05:13:33 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:33 [root] WARNING: 66
2015-09-30 05:13:33 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:35 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S415&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 05:13:35 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:35 [root] WARNING: 67
2015-09-30 05:13:35 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S415&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:35 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T289&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 05:13:35 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:35 [root] WARNING: 68
2015-09-30 05:13:35 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T289&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:35 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T379&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 05:13:36 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:36 [root] WARNING: 69
2015-09-30 05:13:36 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T379&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:38 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T050&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 05:13:38 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:38 [root] WARNING: 70
2015-09-30 05:13:38 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T050&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:40 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N419&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 05:13:40 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T129&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 05:13:40 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:40 [root] WARNING: 71
2015-09-30 05:13:40 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N419&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:40 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:40 [root] WARNING: 72
2015-09-30 05:13:40 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T129&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:41 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T235&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 05:13:41 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:41 [root] WARNING: 73
2015-09-30 05:13:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T235&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:41 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S394&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 05:13:41 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:41 [root] WARNING: 74
2015-09-30 05:13:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S394&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:42 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S275&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 05:13:42 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:42 [root] WARNING: 75
2015-09-30 05:13:42 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S275&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:44 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 05:13:44 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:44 [root] WARNING: 76
2015-09-30 05:13:44 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 05:13:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:46 [root] WARNING: 77
2015-09-30 05:13:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:50 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P195&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 05:13:50 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:50 [root] WARNING: 78
2015-09-30 05:13:50 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P195&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:51 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N236&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 05:13:51 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:51 [root] WARNING: 79
2015-09-30 05:13:51 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N236&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:52 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 05:13:52 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:52 [root] WARNING: 80
2015-09-30 05:13:52 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:53 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 05:13:53 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:53 [root] WARNING: 81
2015-09-30 05:13:54 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:56 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N297&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 05:13:57 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:57 [root] WARNING: 82
2015-09-30 05:13:57 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N297&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:57 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P180&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 05:13:57 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:57 [root] WARNING: 83
2015-09-30 05:13:57 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P180&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:58 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 05:13:58 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:58 [root] WARNING: 84
2015-09-30 05:13:58 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:13:59 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N171&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 05:13:59 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:13:59 [root] WARNING: 85
2015-09-30 05:13:59 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N171&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:14:02 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N434&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 05:14:02 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:14:02 [root] WARNING: 86
2015-09-30 05:14:02 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N434&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:14:03 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 05:14:03 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:14:03 [root] WARNING: 87
2015-09-30 05:14:03 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:14:05 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T257&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 05:14:05 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:14:05 [root] WARNING: 88
2015-09-30 05:14:05 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T257&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:14:09 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T256&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 05:14:10 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:14:10 [root] WARNING: 89
2015-09-30 05:14:10 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T256&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:14:13 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T093&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 05:14:13 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:14:13 [root] WARNING: 90
2015-09-30 05:14:13 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T093&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:14:14 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S420&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 05:14:14 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:14:14 [root] WARNING: 91
2015-09-30 05:14:14 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S420&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:14:16 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S296&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 05:14:16 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M199&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 05:14:16 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:14:16 [root] WARNING: 92
2015-09-30 05:14:16 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S296&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:14:16 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:14:16 [root] WARNING: 93
2015-09-30 05:14:17 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M199&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:14:17 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S278&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 05:14:17 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:14:17 [root] WARNING: 94
2015-09-30 05:14:17 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S278&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:14:18 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T170&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 05:14:18 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:14:18 [root] WARNING: 95
2015-09-30 05:14:18 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T170&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:14:18 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P111&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 05:14:19 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:14:19 [root] WARNING: 96
2015-09-30 05:14:19 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P111&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:14:19 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T112&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 05:14:19 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:14:19 [root] WARNING: 97
2015-09-30 05:14:19 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T112&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:14:21 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T148&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 05:14:21 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:14:21 [root] WARNING: 98
2015-09-30 05:14:21 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T148&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:14:21 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S282&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 05:14:22 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:14:22 [root] WARNING: 99
2015-09-30 05:14:22 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S282&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:14:26 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S391&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 05:14:26 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:14:26 [root] WARNING: 100
2015-09-30 05:14:26 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S391&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:14:29 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N394&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 05:14:30 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:14:30 [root] WARNING: 101
2015-09-30 05:14:30 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N394&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:14:31 [scrapy] INFO: Crawled 114 pages (at 37 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 05:14:31 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S109&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 05:14:32 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:14:32 [root] WARNING: 102
2015-09-30 05:14:32 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S109&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:14:32 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P118&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 05:14:32 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:14:32 [root] WARNING: 103
2015-09-30 05:14:32 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P118&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 700, in parse_horse
    accum_prev_rpnos = list(accumu(prev_rpnos))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 310, in accumu
    total += x
TypeError: unsupported operand type(s) for +=: 'int' and 'str'
2015-09-30 05:14:33 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S145&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 05:14:33 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:14:33 [root] WARNING: 104
2015-09-30 05:14:33 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S145&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 700, in parse_horse
    accum_prev_rpnos = list(accumu(prev_rpnos))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 310, in accumu
    total += x
TypeError: unsupported operand type(s) for +=: 'int' and 'str'
2015-09-30 05:14:33 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P366&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 05:14:33 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P191&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 05:14:33 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:14:33 [root] WARNING: 105
2015-09-30 05:14:33 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P366&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:14:33 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:14:33 [root] WARNING: 106
2015-09-30 05:14:34 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P191&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:14:35 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 05:14:35 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:14:35 [root] WARNING: 107
2015-09-30 05:14:35 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:14:38 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S117&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 05:14:38 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:14:38 [root] WARNING: 108
2015-09-30 05:14:38 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S117&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:14:39 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T398&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:14:39 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:14:39 [root] WARNING: 109
2015-09-30 05:14:39 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T398&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:14:39 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N169&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 05:14:39 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:14:39 [root] WARNING: 110
2015-09-30 05:14:39 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N169&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 700, in parse_horse
    accum_prev_rpnos = list(accumu(prev_rpnos))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 310, in accumu
    total += x
TypeError: unsupported operand type(s) for +=: 'int' and 'str'
2015-09-30 05:14:41 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S110&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 05:14:41 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:14:41 [root] WARNING: 111
2015-09-30 05:14:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S110&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:14:44 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P372&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:14:44 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:14:44 [root] WARNING: 112
2015-09-30 05:14:44 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P372&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:14:45 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N195&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 05:14:45 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:14:45 [root] WARNING: 113
2015-09-30 05:14:45 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N195&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:14:48 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T238&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:14:48 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:14:48 [root] WARNING: 114
2015-09-30 05:14:48 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T238&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:14:52 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S022&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:14:53 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:14:53 [root] WARNING: 115
2015-09-30 05:14:53 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S022&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:14:54 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P103&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:14:54 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:14:54 [root] WARNING: 116
2015-09-30 05:14:54 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P103&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 792, in parse_horse
    places_daysoff =  [x for x in itertools.chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'itertools' is not defined
2015-09-30 05:14:54 [scrapy] INFO: Closing spider (finished)
2015-09-30 05:14:54 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 66225,
 'downloader/request_count': 130,
 'downloader/request_method_count/GET': 129,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 10041219,
 'downloader/response_count': 130,
 'downloader/response_status_count/200': 129,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 5, 14, 54, 856702),
 'log_count/DEBUG': 132,
 'log_count/ERROR': 116,
 'log_count/INFO': 10,
 'log_count/WARNING': 580,
 'request_depth_max': 5,
 'response_received_count': 129,
 'scheduler/dequeued': 130,
 'scheduler/dequeued/memory': 130,
 'scheduler/enqueued': 130,
 'scheduler/enqueued/memory': 130,
 'spider_exceptions/NameError': 100,
 'spider_exceptions/TypeError': 16,
 'start_time': datetime.datetime(2015, 9, 30, 5, 11, 31, 808840)}
2015-09-30 05:14:54 [scrapy] INFO: Spider closed (finished)
2015-09-30 05:24:38 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 05:24:38 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 05:24:38 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 05:24:38 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 05:24:38 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 05:24:38 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 05:24:38 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 05:24:38 [scrapy] INFO: Spider opened
2015-09-30 05:24:38 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 05:24:38 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 05:24:40 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 05:24:43 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 05:24:48 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 05:24:52 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 05:24:55 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 05:24:55 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 05:25:01 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:25:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:01 [root] WARNING: horse code set
2015-09-30 05:25:01 [root] WARNING: 1
2015-09-30 05:25:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:01 [root] WARNING: horse code set
2015-09-30 05:25:01 [root] WARNING: 2
2015-09-30 05:25:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:01 [root] WARNING: horse code set
2015-09-30 05:25:01 [root] WARNING: 3
2015-09-30 05:25:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:01 [root] WARNING: horse code set
2015-09-30 05:25:01 [root] WARNING: 4
2015-09-30 05:25:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:01 [root] WARNING: horse code set
2015-09-30 05:25:01 [root] WARNING: 5
2015-09-30 05:25:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:01 [root] WARNING: horse code set
2015-09-30 05:25:01 [root] WARNING: 6
2015-09-30 05:25:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:01 [root] WARNING: horse code set
2015-09-30 05:25:01 [root] WARNING: 7
2015-09-30 05:25:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:01 [root] WARNING: horse code set
2015-09-30 05:25:01 [root] WARNING: 8
2015-09-30 05:25:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:01 [root] WARNING: horse code set
2015-09-30 05:25:01 [root] WARNING: 9
2015-09-30 05:25:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:01 [root] WARNING: horse code set
2015-09-30 05:25:01 [root] WARNING: 10
2015-09-30 05:25:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:01 [root] WARNING: horse code set
2015-09-30 05:25:01 [root] WARNING: 11
2015-09-30 05:25:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:01 [root] WARNING: horse code set
2015-09-30 05:25:01 [root] WARNING: 12
2015-09-30 05:25:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:01 [root] WARNING: horse code set
2015-09-30 05:25:01 [root] WARNING: 13
2015-09-30 05:25:01 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:01 [root] WARNING: horse code set
2015-09-30 05:25:01 [root] WARNING: 14
2015-09-30 05:25:04 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:25:04 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:04 [root] WARNING: horse code set
2015-09-30 05:25:04 [root] WARNING: 15
2015-09-30 05:25:04 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:04 [root] WARNING: horse code set
2015-09-30 05:25:04 [root] WARNING: 16
2015-09-30 05:25:04 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:04 [root] WARNING: horse code set
2015-09-30 05:25:04 [root] WARNING: 17
2015-09-30 05:25:04 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:04 [root] WARNING: horse code set
2015-09-30 05:25:04 [root] WARNING: 18
2015-09-30 05:25:04 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:04 [root] WARNING: horse code set
2015-09-30 05:25:04 [root] WARNING: 19
2015-09-30 05:25:04 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:04 [root] WARNING: horse code set
2015-09-30 05:25:04 [root] WARNING: 20
2015-09-30 05:25:04 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:04 [root] WARNING: horse code set
2015-09-30 05:25:04 [root] WARNING: 21
2015-09-30 05:25:04 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:04 [root] WARNING: horse code set
2015-09-30 05:25:04 [root] WARNING: 22
2015-09-30 05:25:04 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:04 [root] WARNING: horse code set
2015-09-30 05:25:04 [root] WARNING: 23
2015-09-30 05:25:04 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:04 [root] WARNING: horse code set
2015-09-30 05:25:04 [root] WARNING: 24
2015-09-30 05:25:04 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:04 [root] WARNING: horse code set
2015-09-30 05:25:04 [root] WARNING: 25
2015-09-30 05:25:04 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:04 [root] WARNING: horse code set
2015-09-30 05:25:04 [root] WARNING: 26
2015-09-30 05:25:04 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:04 [root] WARNING: horse code set
2015-09-30 05:25:04 [root] WARNING: 27
2015-09-30 05:25:04 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:04 [root] WARNING: horse code set
2015-09-30 05:25:04 [root] WARNING: 28
2015-09-30 05:25:06 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:25:06 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:06 [root] WARNING: horse code set
2015-09-30 05:25:06 [root] WARNING: 29
2015-09-30 05:25:06 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:06 [root] WARNING: horse code set
2015-09-30 05:25:06 [root] WARNING: 30
2015-09-30 05:25:06 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:06 [root] WARNING: horse code set
2015-09-30 05:25:06 [root] WARNING: 31
2015-09-30 05:25:06 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:06 [root] WARNING: horse code set
2015-09-30 05:25:06 [root] WARNING: 32
2015-09-30 05:25:06 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:06 [root] WARNING: horse code set
2015-09-30 05:25:06 [root] WARNING: 33
2015-09-30 05:25:06 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:06 [root] WARNING: horse code set
2015-09-30 05:25:06 [root] WARNING: 34
2015-09-30 05:25:06 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:06 [root] WARNING: horse code set
2015-09-30 05:25:06 [root] WARNING: 35
2015-09-30 05:25:06 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:06 [root] WARNING: horse code set
2015-09-30 05:25:06 [root] WARNING: 36
2015-09-30 05:25:06 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:06 [root] WARNING: horse code set
2015-09-30 05:25:06 [root] WARNING: 37
2015-09-30 05:25:06 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:06 [root] WARNING: horse code set
2015-09-30 05:25:06 [root] WARNING: 38
2015-09-30 05:25:06 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:06 [root] WARNING: horse code set
2015-09-30 05:25:06 [root] WARNING: 39
2015-09-30 05:25:06 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:06 [root] WARNING: horse code set
2015-09-30 05:25:06 [root] WARNING: 40
2015-09-30 05:25:06 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:06 [root] WARNING: horse code set
2015-09-30 05:25:06 [root] WARNING: 41
2015-09-30 05:25:06 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:06 [root] WARNING: horse code set
2015-09-30 05:25:06 [root] WARNING: 42
2015-09-30 05:25:07 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:25:08 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:08 [root] WARNING: horse code set
2015-09-30 05:25:08 [root] WARNING: 43
2015-09-30 05:25:08 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:08 [root] WARNING: horse code set
2015-09-30 05:25:08 [root] WARNING: 44
2015-09-30 05:25:08 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:08 [root] WARNING: horse code set
2015-09-30 05:25:08 [root] WARNING: 45
2015-09-30 05:25:08 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:08 [root] WARNING: horse code set
2015-09-30 05:25:08 [root] WARNING: 46
2015-09-30 05:25:08 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:08 [root] WARNING: horse code set
2015-09-30 05:25:08 [root] WARNING: 47
2015-09-30 05:25:08 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:08 [root] WARNING: horse code set
2015-09-30 05:25:08 [root] WARNING: 48
2015-09-30 05:25:08 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:08 [root] WARNING: horse code set
2015-09-30 05:25:08 [root] WARNING: 49
2015-09-30 05:25:08 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:08 [root] WARNING: horse code set
2015-09-30 05:25:08 [root] WARNING: 50
2015-09-30 05:25:08 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:08 [root] WARNING: horse code set
2015-09-30 05:25:08 [root] WARNING: 51
2015-09-30 05:25:08 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:08 [root] WARNING: horse code set
2015-09-30 05:25:08 [root] WARNING: 52
2015-09-30 05:25:08 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:08 [root] WARNING: horse code set
2015-09-30 05:25:08 [root] WARNING: 53
2015-09-30 05:25:08 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:08 [root] WARNING: horse code set
2015-09-30 05:25:08 [root] WARNING: 54
2015-09-30 05:25:08 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:25:08 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:08 [root] WARNING: horse code set
2015-09-30 05:25:08 [root] WARNING: 55
2015-09-30 05:25:08 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:08 [root] WARNING: horse code set
2015-09-30 05:25:08 [root] WARNING: 56
2015-09-30 05:25:08 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:08 [root] WARNING: horse code set
2015-09-30 05:25:08 [root] WARNING: 57
2015-09-30 05:25:08 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:08 [root] WARNING: horse code set
2015-09-30 05:25:08 [root] WARNING: 58
2015-09-30 05:25:08 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:08 [root] WARNING: horse code set
2015-09-30 05:25:08 [root] WARNING: 59
2015-09-30 05:25:08 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:08 [root] WARNING: horse code set
2015-09-30 05:25:08 [root] WARNING: 60
2015-09-30 05:25:08 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:08 [root] WARNING: horse code set
2015-09-30 05:25:08 [root] WARNING: 61
2015-09-30 05:25:08 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:08 [root] WARNING: horse code set
2015-09-30 05:25:08 [root] WARNING: 62
2015-09-30 05:25:08 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:08 [root] WARNING: horse code set
2015-09-30 05:25:08 [root] WARNING: 63
2015-09-30 05:25:08 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:08 [root] WARNING: horse code set
2015-09-30 05:25:08 [root] WARNING: 64
2015-09-30 05:25:08 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:08 [root] WARNING: horse code set
2015-09-30 05:25:08 [root] WARNING: 65
2015-09-30 05:25:08 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:08 [root] WARNING: horse code set
2015-09-30 05:25:08 [root] WARNING: 66
2015-09-30 05:25:08 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:08 [root] WARNING: horse code set
2015-09-30 05:25:08 [root] WARNING: 67
2015-09-30 05:25:08 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:08 [root] WARNING: horse code set
2015-09-30 05:25:08 [root] WARNING: 68
2015-09-30 05:25:08 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:25:09 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:09 [root] WARNING: horse code set
2015-09-30 05:25:09 [root] WARNING: 69
2015-09-30 05:25:09 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:09 [root] WARNING: horse code set
2015-09-30 05:25:09 [root] WARNING: 70
2015-09-30 05:25:09 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:09 [root] WARNING: horse code set
2015-09-30 05:25:09 [root] WARNING: 71
2015-09-30 05:25:09 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:09 [root] WARNING: horse code set
2015-09-30 05:25:09 [root] WARNING: 72
2015-09-30 05:25:09 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:09 [root] WARNING: horse code set
2015-09-30 05:25:09 [root] WARNING: 73
2015-09-30 05:25:09 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:09 [root] WARNING: horse code set
2015-09-30 05:25:09 [root] WARNING: 74
2015-09-30 05:25:09 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:09 [root] WARNING: horse code set
2015-09-30 05:25:09 [root] WARNING: 75
2015-09-30 05:25:09 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:09 [root] WARNING: horse code set
2015-09-30 05:25:09 [root] WARNING: 76
2015-09-30 05:25:09 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:09 [root] WARNING: horse code set
2015-09-30 05:25:09 [root] WARNING: 77
2015-09-30 05:25:09 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:09 [root] WARNING: horse code set
2015-09-30 05:25:09 [root] WARNING: 78
2015-09-30 05:25:09 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:09 [root] WARNING: horse code set
2015-09-30 05:25:09 [root] WARNING: 79
2015-09-30 05:25:09 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:09 [root] WARNING: horse code set
2015-09-30 05:25:09 [root] WARNING: 80
2015-09-30 05:25:09 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:09 [root] WARNING: horse code set
2015-09-30 05:25:09 [root] WARNING: 81
2015-09-30 05:25:09 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:09 [root] WARNING: horse code set
2015-09-30 05:25:09 [root] WARNING: 82
2015-09-30 05:25:10 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:25:10 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:10 [root] WARNING: horse code set
2015-09-30 05:25:10 [root] WARNING: 83
2015-09-30 05:25:10 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:10 [root] WARNING: horse code set
2015-09-30 05:25:10 [root] WARNING: 84
2015-09-30 05:25:10 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:10 [root] WARNING: horse code set
2015-09-30 05:25:10 [root] WARNING: 85
2015-09-30 05:25:10 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:10 [root] WARNING: horse code set
2015-09-30 05:25:10 [root] WARNING: 86
2015-09-30 05:25:10 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:10 [root] WARNING: horse code set
2015-09-30 05:25:10 [root] WARNING: 87
2015-09-30 05:25:10 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:10 [root] WARNING: horse code set
2015-09-30 05:25:10 [root] WARNING: 88
2015-09-30 05:25:10 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:10 [root] WARNING: horse code set
2015-09-30 05:25:10 [root] WARNING: 89
2015-09-30 05:25:10 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:10 [root] WARNING: horse code set
2015-09-30 05:25:10 [root] WARNING: 90
2015-09-30 05:25:10 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:10 [root] WARNING: horse code set
2015-09-30 05:25:10 [root] WARNING: 91
2015-09-30 05:25:10 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:10 [root] WARNING: horse code set
2015-09-30 05:25:10 [root] WARNING: 92
2015-09-30 05:25:10 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:10 [root] WARNING: horse code set
2015-09-30 05:25:10 [root] WARNING: 93
2015-09-30 05:25:10 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:10 [root] WARNING: horse code set
2015-09-30 05:25:10 [root] WARNING: 94
2015-09-30 05:25:10 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:10 [root] WARNING: horse code set
2015-09-30 05:25:10 [root] WARNING: 95
2015-09-30 05:25:10 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:10 [root] WARNING: horse code set
2015-09-30 05:25:10 [root] WARNING: 96
2015-09-30 05:25:10 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:25:10 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:10 [root] WARNING: horse code set
2015-09-30 05:25:10 [root] WARNING: 97
2015-09-30 05:25:10 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:10 [root] WARNING: horse code set
2015-09-30 05:25:10 [root] WARNING: 98
2015-09-30 05:25:10 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:10 [root] WARNING: horse code set
2015-09-30 05:25:10 [root] WARNING: 99
2015-09-30 05:25:10 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:10 [root] WARNING: horse code set
2015-09-30 05:25:10 [root] WARNING: 100
2015-09-30 05:25:10 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:10 [root] WARNING: horse code set
2015-09-30 05:25:10 [root] WARNING: 101
2015-09-30 05:25:10 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:10 [root] WARNING: horse code set
2015-09-30 05:25:10 [root] WARNING: 102
2015-09-30 05:25:10 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:10 [root] WARNING: horse code set
2015-09-30 05:25:10 [root] WARNING: 103
2015-09-30 05:25:10 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:10 [root] WARNING: horse code set
2015-09-30 05:25:10 [root] WARNING: 104
2015-09-30 05:25:10 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:10 [root] WARNING: horse code set
2015-09-30 05:25:10 [root] WARNING: 105
2015-09-30 05:25:10 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:10 [root] WARNING: horse code set
2015-09-30 05:25:10 [root] WARNING: 106
2015-09-30 05:25:10 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:10 [root] WARNING: horse code set
2015-09-30 05:25:10 [root] WARNING: 107
2015-09-30 05:25:11 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:25:11 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:11 [root] WARNING: horse code set
2015-09-30 05:25:11 [root] WARNING: 108
2015-09-30 05:25:11 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:11 [root] WARNING: horse code set
2015-09-30 05:25:11 [root] WARNING: 109
2015-09-30 05:25:11 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:11 [root] WARNING: horse code set
2015-09-30 05:25:11 [root] WARNING: 110
2015-09-30 05:25:11 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:11 [root] WARNING: horse code set
2015-09-30 05:25:11 [root] WARNING: 111
2015-09-30 05:25:11 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:11 [root] WARNING: horse code set
2015-09-30 05:25:11 [root] WARNING: 112
2015-09-30 05:25:11 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:11 [root] WARNING: horse code set
2015-09-30 05:25:11 [root] WARNING: 113
2015-09-30 05:25:11 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:11 [root] WARNING: horse code set
2015-09-30 05:25:11 [root] WARNING: 114
2015-09-30 05:25:11 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:11 [root] WARNING: horse code set
2015-09-30 05:25:11 [root] WARNING: 115
2015-09-30 05:25:11 [root] WARNING: -------------------------------------------------
2015-09-30 05:25:11 [root] WARNING: horse code set
2015-09-30 05:25:11 [root] WARNING: 116
2015-09-30 05:25:13 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T200&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:25:13 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:25:13 [root] WARNING: 1
2015-09-30 05:25:13 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T200&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 616, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:25:13 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T398&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:25:13 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:25:13 [root] WARNING: 2
2015-09-30 05:25:13 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T398&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 616, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:25:14 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:25:14 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:25:14 [root] WARNING: 3
2015-09-30 05:25:14 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 616, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:25:15 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S439&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:25:15 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:25:15 [root] WARNING: 4
2015-09-30 05:25:15 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S439&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 616, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:25:15 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T009&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:25:15 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:25:15 [root] WARNING: 5
2015-09-30 05:25:15 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T009&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 616, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:25:17 [scrapy] INFO: Received SIGINT, shutting down gracefully. Send again to force 
2015-09-30 05:25:17 [scrapy] INFO: Closing spider (shutdown)
2015-09-30 05:25:17 [scrapy] INFO: Received SIGINT twice, forcing unclean shutdown
2015-09-30 05:25:17 [scrapy] DEBUG: Retrying <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P103&Option=1#htop> (failed 1 times): [<twisted.python.failure.Failure <class 'twisted.internet.error.ConnectionLost'>>, <twisted.python.failure.Failure <class 'twisted.web.http._DataLoss'>>]
2015-09-30 05:25:17 [scrapy] DEBUG: Retrying <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S022&Option=1#htop> (failed 1 times): [<twisted.python.failure.Failure <class 'twisted.internet.error.ConnectionLost'>>, <twisted.python.failure.Failure <class 'twisted.web.http._DataLoss'>>]
2015-09-30 05:25:17 [scrapy] DEBUG: Retrying <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P372&Option=1#htop> (failed 1 times): [<twisted.python.failure.Failure <class 'twisted.internet.error.ConnectionLost'>>, <twisted.python.failure.Failure <class 'twisted.web.http._DataLoss'>>]
2015-09-30 05:25:17 [scrapy] DEBUG: Retrying <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P222&Option=1#htop> (failed 1 times): [<twisted.python.failure.Failure <class 'twisted.internet.error.ConnectionLost'>>, <twisted.python.failure.Failure <class 'twisted.web.http._DataLoss'>>]
2015-09-30 05:27:40 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 05:27:40 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 05:27:40 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 05:27:41 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 05:27:41 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 05:27:41 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 05:27:41 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 05:27:41 [scrapy] INFO: Spider opened
2015-09-30 05:27:41 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 05:27:41 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 05:27:43 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 05:27:46 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 05:27:52 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 05:27:56 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 05:27:58 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 05:27:58 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 05:28:04 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:28:04 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 483, in parse_hkjc_racecard
    surface = unicode.strip(unicode.split(surface_distance, u',')[0])
TypeError: descriptor 'split' requires a 'unicode' object but received a 'str'
2015-09-30 05:28:08 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:28:09 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 483, in parse_hkjc_racecard
    surface = unicode.strip(unicode.split(surface_distance, u',')[0])
TypeError: descriptor 'split' requires a 'unicode' object but received a 'str'
2015-09-30 05:28:12 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:28:12 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 483, in parse_hkjc_racecard
    surface = unicode.strip(unicode.split(surface_distance, u',')[0])
TypeError: descriptor 'split' requires a 'unicode' object but received a 'str'
2015-09-30 05:28:14 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:28:14 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 483, in parse_hkjc_racecard
    surface = unicode.strip(unicode.split(surface_distance, u',')[0])
TypeError: descriptor 'split' requires a 'unicode' object but received a 'str'
2015-09-30 05:28:16 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:28:16 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 483, in parse_hkjc_racecard
    surface = unicode.strip(unicode.split(surface_distance, u',')[0])
TypeError: descriptor 'split' requires a 'unicode' object but received a 'str'
2015-09-30 05:28:18 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:28:18 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 483, in parse_hkjc_racecard
    surface = unicode.strip(unicode.split(surface_distance, u',')[0])
TypeError: descriptor 'split' requires a 'unicode' object but received a 'str'
2015-09-30 05:28:18 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:28:18 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 483, in parse_hkjc_racecard
    surface = unicode.strip(unicode.split(surface_distance, u',')[0])
TypeError: descriptor 'split' requires a 'unicode' object but received a 'str'
2015-09-30 05:28:20 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:28:20 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 483, in parse_hkjc_racecard
    surface = unicode.strip(unicode.split(surface_distance, u',')[0])
TypeError: descriptor 'split' requires a 'unicode' object but received a 'str'
2015-09-30 05:28:23 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:28:23 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 483, in parse_hkjc_racecard
    surface = unicode.strip(unicode.split(surface_distance, u',')[0])
TypeError: descriptor 'split' requires a 'unicode' object but received a 'str'
2015-09-30 05:28:23 [scrapy] INFO: Closing spider (finished)
2015-09-30 05:28:23 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 5227,
 'downloader/request_count': 14,
 'downloader/request_method_count/GET': 13,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 396834,
 'downloader/response_count': 14,
 'downloader/response_status_count/200': 13,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 5, 28, 23, 281861),
 'log_count/DEBUG': 16,
 'log_count/ERROR': 9,
 'log_count/INFO': 7,
 'request_depth_max': 4,
 'response_received_count': 13,
 'scheduler/dequeued': 14,
 'scheduler/dequeued/memory': 14,
 'scheduler/enqueued': 14,
 'scheduler/enqueued/memory': 14,
 'spider_exceptions/TypeError': 9,
 'start_time': datetime.datetime(2015, 9, 30, 5, 27, 41, 129297)}
2015-09-30 05:28:23 [scrapy] INFO: Spider closed (finished)
2015-09-30 05:32:17 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 05:32:17 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 05:32:17 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 05:32:17 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 05:32:17 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 05:32:17 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 05:32:17 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 05:32:17 [scrapy] INFO: Spider opened
2015-09-30 05:32:17 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 05:32:17 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 05:32:20 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 05:32:20 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 05:32:25 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 05:32:28 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 05:32:30 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 05:32:30 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 05:32:35 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:32:35 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 490, in parse_hkjc_racecard
    surface = trackvariant
NameError: global name 'trackvariant' is not defined
2015-09-30 05:32:36 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:32:37 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 490, in parse_hkjc_racecard
    surface = trackvariant
NameError: global name 'trackvariant' is not defined
2015-09-30 05:32:39 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:32:39 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 490, in parse_hkjc_racecard
    surface = trackvariant
NameError: global name 'trackvariant' is not defined
2015-09-30 05:32:40 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:32:40 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 490, in parse_hkjc_racecard
    surface = trackvariant
NameError: global name 'trackvariant' is not defined
2015-09-30 05:32:41 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:32:41 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 490, in parse_hkjc_racecard
    surface = trackvariant
NameError: global name 'trackvariant' is not defined
2015-09-30 05:32:42 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:32:42 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 490, in parse_hkjc_racecard
    surface = trackvariant
NameError: global name 'trackvariant' is not defined
2015-09-30 05:32:43 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:32:43 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 490, in parse_hkjc_racecard
    surface = trackvariant
NameError: global name 'trackvariant' is not defined
2015-09-30 05:32:44 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:32:44 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 490, in parse_hkjc_racecard
    surface = trackvariant
NameError: global name 'trackvariant' is not defined
2015-09-30 05:32:44 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:32:44 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 490, in parse_hkjc_racecard
    surface = trackvariant
NameError: global name 'trackvariant' is not defined
2015-09-30 05:32:44 [scrapy] INFO: Closing spider (finished)
2015-09-30 05:32:44 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 5227,
 'downloader/request_count': 14,
 'downloader/request_method_count/GET': 13,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 396712,
 'downloader/response_count': 14,
 'downloader/response_status_count/200': 13,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 5, 32, 44, 838147),
 'log_count/DEBUG': 16,
 'log_count/ERROR': 9,
 'log_count/INFO': 7,
 'request_depth_max': 4,
 'response_received_count': 13,
 'scheduler/dequeued': 14,
 'scheduler/dequeued/memory': 14,
 'scheduler/enqueued': 14,
 'scheduler/enqueued/memory': 14,
 'spider_exceptions/NameError': 9,
 'start_time': datetime.datetime(2015, 9, 30, 5, 32, 17, 393868)}
2015-09-30 05:32:44 [scrapy] INFO: Spider closed (finished)
2015-09-30 05:35:35 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 05:35:35 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 05:35:35 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 05:35:35 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 05:35:35 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 05:35:35 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 05:35:35 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 05:35:35 [scrapy] INFO: Spider opened
2015-09-30 05:35:35 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 05:35:35 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 05:35:38 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 05:35:39 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 05:35:46 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 05:35:49 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 05:35:52 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 05:35:52 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 05:35:57 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:35:58 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 474, in parse_hkjc_racecard
    _surface, _trackvariant, _distance, _going = None
TypeError: 'NoneType' object is not iterable
2015-09-30 05:36:02 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:36:02 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 474, in parse_hkjc_racecard
    _surface, _trackvariant, _distance, _going = None
TypeError: 'NoneType' object is not iterable
2015-09-30 05:36:04 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:36:04 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 474, in parse_hkjc_racecard
    _surface, _trackvariant, _distance, _going = None
TypeError: 'NoneType' object is not iterable
2015-09-30 05:36:05 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:36:05 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 474, in parse_hkjc_racecard
    _surface, _trackvariant, _distance, _going = None
TypeError: 'NoneType' object is not iterable
2015-09-30 05:36:06 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:36:06 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 474, in parse_hkjc_racecard
    _surface, _trackvariant, _distance, _going = None
TypeError: 'NoneType' object is not iterable
2015-09-30 05:36:08 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:36:08 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 474, in parse_hkjc_racecard
    _surface, _trackvariant, _distance, _going = None
TypeError: 'NoneType' object is not iterable
2015-09-30 05:36:08 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:36:09 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 474, in parse_hkjc_racecard
    _surface, _trackvariant, _distance, _going = None
TypeError: 'NoneType' object is not iterable
2015-09-30 05:36:09 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:36:09 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 474, in parse_hkjc_racecard
    _surface, _trackvariant, _distance, _going = None
TypeError: 'NoneType' object is not iterable
2015-09-30 05:36:09 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:36:09 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 474, in parse_hkjc_racecard
    _surface, _trackvariant, _distance, _going = None
TypeError: 'NoneType' object is not iterable
2015-09-30 05:36:09 [scrapy] INFO: Closing spider (finished)
2015-09-30 05:36:09 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 5227,
 'downloader/request_count': 14,
 'downloader/request_method_count/GET': 13,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 396802,
 'downloader/response_count': 14,
 'downloader/response_status_count/200': 13,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 5, 36, 9, 642764),
 'log_count/DEBUG': 16,
 'log_count/ERROR': 9,
 'log_count/INFO': 7,
 'request_depth_max': 4,
 'response_received_count': 13,
 'scheduler/dequeued': 14,
 'scheduler/dequeued/memory': 14,
 'scheduler/enqueued': 14,
 'scheduler/enqueued/memory': 14,
 'spider_exceptions/TypeError': 9,
 'start_time': datetime.datetime(2015, 9, 30, 5, 35, 35, 645105)}
2015-09-30 05:36:09 [scrapy] INFO: Spider closed (finished)
2015-09-30 05:36:53 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 05:36:53 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 05:36:53 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 05:36:54 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 05:36:54 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 05:36:54 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 05:36:54 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 05:36:54 [scrapy] INFO: Spider opened
2015-09-30 05:36:54 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 05:36:54 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 05:36:56 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 05:36:59 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 05:37:06 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 05:37:10 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 05:37:12 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 05:37:12 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 05:37:17 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:37:17 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:17 [root] WARNING: horse code set
2015-09-30 05:37:17 [root] WARNING: 1
2015-09-30 05:37:17 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:17 [root] WARNING: horse code set
2015-09-30 05:37:17 [root] WARNING: 2
2015-09-30 05:37:17 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:17 [root] WARNING: horse code set
2015-09-30 05:37:17 [root] WARNING: 3
2015-09-30 05:37:17 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:17 [root] WARNING: horse code set
2015-09-30 05:37:17 [root] WARNING: 4
2015-09-30 05:37:17 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:17 [root] WARNING: horse code set
2015-09-30 05:37:17 [root] WARNING: 5
2015-09-30 05:37:17 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:17 [root] WARNING: horse code set
2015-09-30 05:37:17 [root] WARNING: 6
2015-09-30 05:37:17 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:17 [root] WARNING: horse code set
2015-09-30 05:37:17 [root] WARNING: 7
2015-09-30 05:37:17 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:17 [root] WARNING: horse code set
2015-09-30 05:37:17 [root] WARNING: 8
2015-09-30 05:37:17 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:17 [root] WARNING: horse code set
2015-09-30 05:37:17 [root] WARNING: 9
2015-09-30 05:37:17 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:17 [root] WARNING: horse code set
2015-09-30 05:37:17 [root] WARNING: 10
2015-09-30 05:37:17 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:17 [root] WARNING: horse code set
2015-09-30 05:37:17 [root] WARNING: 11
2015-09-30 05:37:17 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:17 [root] WARNING: horse code set
2015-09-30 05:37:17 [root] WARNING: 12
2015-09-30 05:37:17 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:17 [root] WARNING: horse code set
2015-09-30 05:37:17 [root] WARNING: 13
2015-09-30 05:37:17 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:17 [root] WARNING: horse code set
2015-09-30 05:37:17 [root] WARNING: 14
2015-09-30 05:37:21 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:37:21 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:21 [root] WARNING: horse code set
2015-09-30 05:37:21 [root] WARNING: 15
2015-09-30 05:37:21 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:21 [root] WARNING: horse code set
2015-09-30 05:37:21 [root] WARNING: 16
2015-09-30 05:37:21 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:21 [root] WARNING: horse code set
2015-09-30 05:37:21 [root] WARNING: 17
2015-09-30 05:37:21 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:21 [root] WARNING: horse code set
2015-09-30 05:37:21 [root] WARNING: 18
2015-09-30 05:37:21 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:21 [root] WARNING: horse code set
2015-09-30 05:37:21 [root] WARNING: 19
2015-09-30 05:37:21 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:21 [root] WARNING: horse code set
2015-09-30 05:37:21 [root] WARNING: 20
2015-09-30 05:37:21 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:21 [root] WARNING: horse code set
2015-09-30 05:37:21 [root] WARNING: 21
2015-09-30 05:37:21 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:21 [root] WARNING: horse code set
2015-09-30 05:37:21 [root] WARNING: 22
2015-09-30 05:37:21 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:21 [root] WARNING: horse code set
2015-09-30 05:37:21 [root] WARNING: 23
2015-09-30 05:37:21 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:21 [root] WARNING: horse code set
2015-09-30 05:37:21 [root] WARNING: 24
2015-09-30 05:37:21 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:21 [root] WARNING: horse code set
2015-09-30 05:37:21 [root] WARNING: 25
2015-09-30 05:37:21 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:21 [root] WARNING: horse code set
2015-09-30 05:37:21 [root] WARNING: 26
2015-09-30 05:37:21 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:21 [root] WARNING: horse code set
2015-09-30 05:37:21 [root] WARNING: 27
2015-09-30 05:37:21 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:21 [root] WARNING: horse code set
2015-09-30 05:37:21 [root] WARNING: 28
2015-09-30 05:37:24 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:37:24 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:24 [root] WARNING: horse code set
2015-09-30 05:37:24 [root] WARNING: 29
2015-09-30 05:37:24 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:24 [root] WARNING: horse code set
2015-09-30 05:37:24 [root] WARNING: 30
2015-09-30 05:37:24 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:24 [root] WARNING: horse code set
2015-09-30 05:37:24 [root] WARNING: 31
2015-09-30 05:37:24 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:24 [root] WARNING: horse code set
2015-09-30 05:37:24 [root] WARNING: 32
2015-09-30 05:37:24 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:24 [root] WARNING: horse code set
2015-09-30 05:37:24 [root] WARNING: 33
2015-09-30 05:37:24 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:24 [root] WARNING: horse code set
2015-09-30 05:37:24 [root] WARNING: 34
2015-09-30 05:37:24 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:24 [root] WARNING: horse code set
2015-09-30 05:37:24 [root] WARNING: 35
2015-09-30 05:37:24 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:24 [root] WARNING: horse code set
2015-09-30 05:37:24 [root] WARNING: 36
2015-09-30 05:37:24 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:24 [root] WARNING: horse code set
2015-09-30 05:37:24 [root] WARNING: 37
2015-09-30 05:37:24 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:24 [root] WARNING: horse code set
2015-09-30 05:37:24 [root] WARNING: 38
2015-09-30 05:37:24 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:24 [root] WARNING: horse code set
2015-09-30 05:37:24 [root] WARNING: 39
2015-09-30 05:37:24 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:24 [root] WARNING: horse code set
2015-09-30 05:37:24 [root] WARNING: 40
2015-09-30 05:37:24 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:24 [root] WARNING: horse code set
2015-09-30 05:37:24 [root] WARNING: 41
2015-09-30 05:37:24 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:24 [root] WARNING: horse code set
2015-09-30 05:37:24 [root] WARNING: 42
2015-09-30 05:37:25 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:37:25 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:37:25 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:25 [root] WARNING: horse code set
2015-09-30 05:37:25 [root] WARNING: 43
2015-09-30 05:37:25 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:25 [root] WARNING: horse code set
2015-09-30 05:37:25 [root] WARNING: 44
2015-09-30 05:37:25 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:25 [root] WARNING: horse code set
2015-09-30 05:37:25 [root] WARNING: 45
2015-09-30 05:37:25 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:25 [root] WARNING: horse code set
2015-09-30 05:37:25 [root] WARNING: 46
2015-09-30 05:37:25 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:25 [root] WARNING: horse code set
2015-09-30 05:37:25 [root] WARNING: 47
2015-09-30 05:37:25 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:25 [root] WARNING: horse code set
2015-09-30 05:37:25 [root] WARNING: 48
2015-09-30 05:37:25 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:25 [root] WARNING: horse code set
2015-09-30 05:37:25 [root] WARNING: 49
2015-09-30 05:37:25 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:25 [root] WARNING: horse code set
2015-09-30 05:37:25 [root] WARNING: 50
2015-09-30 05:37:25 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:25 [root] WARNING: horse code set
2015-09-30 05:37:25 [root] WARNING: 51
2015-09-30 05:37:25 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:25 [root] WARNING: horse code set
2015-09-30 05:37:25 [root] WARNING: 52
2015-09-30 05:37:25 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:25 [root] WARNING: horse code set
2015-09-30 05:37:25 [root] WARNING: 53
2015-09-30 05:37:25 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:25 [root] WARNING: horse code set
2015-09-30 05:37:25 [root] WARNING: 54
2015-09-30 05:37:25 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:25 [root] WARNING: horse code set
2015-09-30 05:37:25 [root] WARNING: 55
2015-09-30 05:37:25 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:25 [root] WARNING: horse code set
2015-09-30 05:37:25 [root] WARNING: 56
2015-09-30 05:37:25 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:25 [root] WARNING: horse code set
2015-09-30 05:37:25 [root] WARNING: 57
2015-09-30 05:37:25 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:25 [root] WARNING: horse code set
2015-09-30 05:37:25 [root] WARNING: 58
2015-09-30 05:37:25 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:25 [root] WARNING: horse code set
2015-09-30 05:37:25 [root] WARNING: 59
2015-09-30 05:37:25 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:25 [root] WARNING: horse code set
2015-09-30 05:37:25 [root] WARNING: 60
2015-09-30 05:37:25 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:25 [root] WARNING: horse code set
2015-09-30 05:37:25 [root] WARNING: 61
2015-09-30 05:37:25 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:25 [root] WARNING: horse code set
2015-09-30 05:37:25 [root] WARNING: 62
2015-09-30 05:37:25 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:25 [root] WARNING: horse code set
2015-09-30 05:37:25 [root] WARNING: 63
2015-09-30 05:37:25 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:25 [root] WARNING: horse code set
2015-09-30 05:37:25 [root] WARNING: 64
2015-09-30 05:37:25 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:25 [root] WARNING: horse code set
2015-09-30 05:37:25 [root] WARNING: 65
2015-09-30 05:37:25 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:25 [root] WARNING: horse code set
2015-09-30 05:37:25 [root] WARNING: 66
2015-09-30 05:37:25 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:25 [root] WARNING: horse code set
2015-09-30 05:37:25 [root] WARNING: 67
2015-09-30 05:37:25 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:25 [root] WARNING: horse code set
2015-09-30 05:37:25 [root] WARNING: 68
2015-09-30 05:37:27 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:37:27 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:37:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:27 [root] WARNING: horse code set
2015-09-30 05:37:27 [root] WARNING: 69
2015-09-30 05:37:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:27 [root] WARNING: horse code set
2015-09-30 05:37:27 [root] WARNING: 70
2015-09-30 05:37:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:27 [root] WARNING: horse code set
2015-09-30 05:37:27 [root] WARNING: 71
2015-09-30 05:37:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:27 [root] WARNING: horse code set
2015-09-30 05:37:27 [root] WARNING: 72
2015-09-30 05:37:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:27 [root] WARNING: horse code set
2015-09-30 05:37:27 [root] WARNING: 73
2015-09-30 05:37:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:27 [root] WARNING: horse code set
2015-09-30 05:37:27 [root] WARNING: 74
2015-09-30 05:37:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:27 [root] WARNING: horse code set
2015-09-30 05:37:27 [root] WARNING: 75
2015-09-30 05:37:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:27 [root] WARNING: horse code set
2015-09-30 05:37:27 [root] WARNING: 76
2015-09-30 05:37:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:27 [root] WARNING: horse code set
2015-09-30 05:37:27 [root] WARNING: 77
2015-09-30 05:37:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:27 [root] WARNING: horse code set
2015-09-30 05:37:27 [root] WARNING: 78
2015-09-30 05:37:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:27 [root] WARNING: horse code set
2015-09-30 05:37:27 [root] WARNING: 79
2015-09-30 05:37:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:27 [root] WARNING: horse code set
2015-09-30 05:37:27 [root] WARNING: 80
2015-09-30 05:37:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:27 [root] WARNING: horse code set
2015-09-30 05:37:27 [root] WARNING: 81
2015-09-30 05:37:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:27 [root] WARNING: horse code set
2015-09-30 05:37:27 [root] WARNING: 82
2015-09-30 05:37:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:27 [root] WARNING: horse code set
2015-09-30 05:37:27 [root] WARNING: 83
2015-09-30 05:37:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:27 [root] WARNING: horse code set
2015-09-30 05:37:27 [root] WARNING: 84
2015-09-30 05:37:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:27 [root] WARNING: horse code set
2015-09-30 05:37:27 [root] WARNING: 85
2015-09-30 05:37:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:27 [root] WARNING: horse code set
2015-09-30 05:37:27 [root] WARNING: 86
2015-09-30 05:37:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:27 [root] WARNING: horse code set
2015-09-30 05:37:27 [root] WARNING: 87
2015-09-30 05:37:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:27 [root] WARNING: horse code set
2015-09-30 05:37:27 [root] WARNING: 88
2015-09-30 05:37:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:27 [root] WARNING: horse code set
2015-09-30 05:37:27 [root] WARNING: 89
2015-09-30 05:37:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:27 [root] WARNING: horse code set
2015-09-30 05:37:27 [root] WARNING: 90
2015-09-30 05:37:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:27 [root] WARNING: horse code set
2015-09-30 05:37:27 [root] WARNING: 91
2015-09-30 05:37:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:27 [root] WARNING: horse code set
2015-09-30 05:37:27 [root] WARNING: 92
2015-09-30 05:37:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:27 [root] WARNING: horse code set
2015-09-30 05:37:27 [root] WARNING: 93
2015-09-30 05:37:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:27 [root] WARNING: horse code set
2015-09-30 05:37:27 [root] WARNING: 94
2015-09-30 05:37:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:27 [root] WARNING: horse code set
2015-09-30 05:37:27 [root] WARNING: 95
2015-09-30 05:37:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:27 [root] WARNING: horse code set
2015-09-30 05:37:27 [root] WARNING: 96
2015-09-30 05:37:28 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:37:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:28 [root] WARNING: horse code set
2015-09-30 05:37:28 [root] WARNING: 97
2015-09-30 05:37:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:28 [root] WARNING: horse code set
2015-09-30 05:37:28 [root] WARNING: 98
2015-09-30 05:37:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:28 [root] WARNING: horse code set
2015-09-30 05:37:28 [root] WARNING: 99
2015-09-30 05:37:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:28 [root] WARNING: horse code set
2015-09-30 05:37:28 [root] WARNING: 100
2015-09-30 05:37:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:28 [root] WARNING: horse code set
2015-09-30 05:37:28 [root] WARNING: 101
2015-09-30 05:37:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:28 [root] WARNING: horse code set
2015-09-30 05:37:28 [root] WARNING: 102
2015-09-30 05:37:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:28 [root] WARNING: horse code set
2015-09-30 05:37:28 [root] WARNING: 103
2015-09-30 05:37:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:28 [root] WARNING: horse code set
2015-09-30 05:37:28 [root] WARNING: 104
2015-09-30 05:37:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:28 [root] WARNING: horse code set
2015-09-30 05:37:28 [root] WARNING: 105
2015-09-30 05:37:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:28 [root] WARNING: horse code set
2015-09-30 05:37:28 [root] WARNING: 106
2015-09-30 05:37:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:28 [root] WARNING: horse code set
2015-09-30 05:37:28 [root] WARNING: 107
2015-09-30 05:37:29 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:37:29 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:29 [root] WARNING: horse code set
2015-09-30 05:37:29 [root] WARNING: 108
2015-09-30 05:37:29 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:29 [root] WARNING: horse code set
2015-09-30 05:37:29 [root] WARNING: 109
2015-09-30 05:37:29 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:29 [root] WARNING: horse code set
2015-09-30 05:37:29 [root] WARNING: 110
2015-09-30 05:37:29 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:29 [root] WARNING: horse code set
2015-09-30 05:37:29 [root] WARNING: 111
2015-09-30 05:37:29 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:29 [root] WARNING: horse code set
2015-09-30 05:37:29 [root] WARNING: 112
2015-09-30 05:37:29 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:29 [root] WARNING: horse code set
2015-09-30 05:37:29 [root] WARNING: 113
2015-09-30 05:37:29 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:29 [root] WARNING: horse code set
2015-09-30 05:37:29 [root] WARNING: 114
2015-09-30 05:37:29 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:29 [root] WARNING: horse code set
2015-09-30 05:37:29 [root] WARNING: 115
2015-09-30 05:37:29 [root] WARNING: -------------------------------------------------
2015-09-30 05:37:29 [root] WARNING: horse code set
2015-09-30 05:37:29 [root] WARNING: 116
2015-09-30 05:37:30 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T238&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:37:30 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:37:30 [root] WARNING: 1
2015-09-30 05:37:30 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T238&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:37:31 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S022&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:37:31 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:37:31 [root] WARNING: 2
2015-09-30 05:37:31 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S022&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:37:31 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:37:31 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:37:31 [root] WARNING: 3
2015-09-30 05:37:31 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:37:34 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T200&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:37:34 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:37:34 [root] WARNING: 4
2015-09-30 05:37:34 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T200&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:37:34 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T009&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:37:34 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:37:34 [root] WARNING: 5
2015-09-30 05:37:34 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T009&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:37:35 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T096&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:37:35 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:37:35 [root] WARNING: 6
2015-09-30 05:37:35 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T096&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:37:37 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N033&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:37:37 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:37:37 [root] WARNING: 7
2015-09-30 05:37:37 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N033&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:37:38 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P222&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:37:38 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:37:38 [root] WARNING: 8
2015-09-30 05:37:38 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P222&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:37:39 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S010&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:37:39 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:37:39 [root] WARNING: 9
2015-09-30 05:37:39 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S010&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:37:39 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T288&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 05:37:39 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:37:39 [root] WARNING: 10
2015-09-30 05:37:39 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T288&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:37:41 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P158&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 05:37:41 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:37:41 [root] WARNING: 11
2015-09-30 05:37:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P158&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 801, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:37:43 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N434&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 05:37:43 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:37:43 [root] WARNING: 12
2015-09-30 05:37:43 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N434&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:37:45 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T135&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:37:45 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:37:45 [root] WARNING: 13
2015-09-30 05:37:45 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T135&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:37:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P031&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 05:37:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:37:46 [root] WARNING: 14
2015-09-30 05:37:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P031&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:37:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S346&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 05:37:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:37:46 [root] WARNING: 15
2015-09-30 05:37:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S346&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:37:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 05:37:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:37:47 [root] WARNING: 16
2015-09-30 05:37:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:37:48 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P358&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 05:37:48 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:37:48 [root] WARNING: 17
2015-09-30 05:37:48 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P358&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:37:48 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S332&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 05:37:49 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:37:49 [root] WARNING: 18
2015-09-30 05:37:49 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S332&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:37:49 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 05:37:49 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:37:49 [root] WARNING: 19
2015-09-30 05:37:49 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 801, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:37:51 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P151&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 05:37:51 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:37:51 [root] WARNING: 20
2015-09-30 05:37:51 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P151&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:37:51 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 05:37:51 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:37:51 [root] WARNING: 21
2015-09-30 05:37:51 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:37:52 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S076&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 05:37:52 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:37:52 [root] WARNING: 22
2015-09-30 05:37:52 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S076&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:37:53 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T168&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 05:37:53 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:37:53 [root] WARNING: 23
2015-09-30 05:37:53 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T168&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:37:54 [scrapy] INFO: Crawled 36 pages (at 36 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 05:37:54 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S100&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 05:37:54 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:37:54 [root] WARNING: 24
2015-09-30 05:37:54 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S100&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:37:54 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S023&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 05:37:55 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:37:55 [root] WARNING: 25
2015-09-30 05:37:55 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S023&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:37:55 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S209&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 05:37:55 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P044&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 05:37:55 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:37:55 [root] WARNING: 26
2015-09-30 05:37:55 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S209&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:37:55 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:37:55 [root] WARNING: 27
2015-09-30 05:37:55 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P044&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:37:56 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S300&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 05:37:56 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:37:56 [root] WARNING: 28
2015-09-30 05:37:56 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S300&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:00 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 05:38:00 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:00 [root] WARNING: 29
2015-09-30 05:38:00 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:00 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T002&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 05:38:00 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:00 [root] WARNING: 30
2015-09-30 05:38:00 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T002&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:02 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T265&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:38:02 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:02 [root] WARNING: 31
2015-09-30 05:38:02 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T265&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:03 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N220&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 05:38:03 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:03 [root] WARNING: 32
2015-09-30 05:38:03 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N220&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 801, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:38:03 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S421&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:38:03 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:03 [root] WARNING: 33
2015-09-30 05:38:03 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S421&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:04 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P316&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 05:38:04 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:04 [root] WARNING: 34
2015-09-30 05:38:04 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P316&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:04 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S375&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 05:38:04 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:04 [root] WARNING: 35
2015-09-30 05:38:04 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S375&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:05 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T004&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:38:05 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:05 [root] WARNING: 36
2015-09-30 05:38:05 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T004&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:05 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:38:05 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:05 [root] WARNING: 37
2015-09-30 05:38:05 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:06 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T404&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:38:06 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:06 [root] WARNING: 38
2015-09-30 05:38:06 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T404&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:08 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M227&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 05:38:08 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:08 [root] WARNING: 39
2015-09-30 05:38:08 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M227&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:09 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T215&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:38:09 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:09 [root] WARNING: 40
2015-09-30 05:38:09 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T215&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:09 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N432&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:38:09 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:09 [root] WARNING: 41
2015-09-30 05:38:09 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N432&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:10 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N386&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:38:10 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:10 [root] WARNING: 42
2015-09-30 05:38:10 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N386&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:10 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 05:38:10 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:10 [root] WARNING: 43
2015-09-30 05:38:10 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:12 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T080&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:38:12 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:12 [root] WARNING: 44
2015-09-30 05:38:12 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T080&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 801, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:38:15 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P173&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:38:15 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:15 [root] WARNING: 45
2015-09-30 05:38:15 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P173&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:17 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N234&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:38:18 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:18 [root] WARNING: 46
2015-09-30 05:38:18 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N234&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:20 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:38:20 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N330&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:38:20 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:20 [root] WARNING: 47
2015-09-30 05:38:20 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:20 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:20 [root] WARNING: 48
2015-09-30 05:38:20 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N330&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:24 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S349&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:38:24 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:24 [root] WARNING: 49
2015-09-30 05:38:24 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S349&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:24 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:38:24 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:24 [root] WARNING: 50
2015-09-30 05:38:24 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:27 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T005&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:38:27 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:27 [root] WARNING: 51
2015-09-30 05:38:27 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T005&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:28 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T205&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:38:28 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:28 [root] WARNING: 52
2015-09-30 05:38:28 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T205&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:28 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:38:28 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V061&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:38:28 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:28 [root] WARNING: 53
2015-09-30 05:38:28 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:28 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:28 [root] WARNING: 54
2015-09-30 05:38:28 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V061&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:29 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T342&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:38:29 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:29 [root] WARNING: 55
2015-09-30 05:38:29 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T342&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:29 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V039&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:38:29 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:29 [root] WARNING: 56
2015-09-30 05:38:29 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V039&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:31 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T333&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:38:31 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:31 [root] WARNING: 57
2015-09-30 05:38:31 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T333&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:32 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T340&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:38:32 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:38:32 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:32 [root] WARNING: 58
2015-09-30 05:38:32 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T340&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:32 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:32 [root] WARNING: 59
2015-09-30 05:38:32 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:34 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T235&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 05:38:34 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:34 [root] WARNING: 60
2015-09-30 05:38:34 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T235&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:35 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S397&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:38:35 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:35 [root] WARNING: 61
2015-09-30 05:38:35 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S397&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:36 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P097&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:38:36 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N226&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:38:36 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:36 [root] WARNING: 62
2015-09-30 05:38:36 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P097&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:36 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:36 [root] WARNING: 63
2015-09-30 05:38:36 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N226&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:36 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 05:38:37 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:37 [root] WARNING: 64
2015-09-30 05:38:37 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:38 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 05:38:38 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:38 [root] WARNING: 65
2015-09-30 05:38:38 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:39 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N236&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 05:38:39 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:39 [root] WARNING: 66
2015-09-30 05:38:39 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N236&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:40 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P195&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 05:38:40 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:40 [root] WARNING: 67
2015-09-30 05:38:40 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P195&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:40 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N297&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 05:38:41 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:41 [root] WARNING: 68
2015-09-30 05:38:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N297&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:44 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P180&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 05:38:44 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:44 [root] WARNING: 69
2015-09-30 05:38:44 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P180&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:44 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N171&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 05:38:45 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:45 [root] WARNING: 70
2015-09-30 05:38:45 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N171&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    print "todays draw--from meta {} todays surface {}".format(today_dr,today_surf)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 05:38:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:46 [root] WARNING: 71
2015-09-30 05:38:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    today_dr =  response.meta["draw"]
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 05:38:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:46 [root] WARNING: 72
2015-09-30 05:38:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    today_dr =  response.meta["draw"]
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S305&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 05:38:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:47 [root] WARNING: 73
2015-09-30 05:38:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S305&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    today_dr =  response.meta["draw"]
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:49 [scrapy] INFO: Received SIGINT, shutting down gracefully. Send again to force 
2015-09-30 05:38:49 [scrapy] INFO: Closing spider (shutdown)
2015-09-30 05:38:50 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S165&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 05:38:50 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:38:50 [root] WARNING: 74
2015-09-30 05:38:50 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S165&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 620, in parse_horse
    today_dr =  response.meta["draw"]
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 05:38:51 [scrapy] INFO: Received SIGINT twice, forcing unclean shutdown
2015-09-30 05:38:51 [scrapy] DEBUG: Retrying <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N248&Option=1#htop> (failed 1 times): [<twisted.python.failure.Failure <class 'twisted.internet.error.ConnectionLost'>>, <twisted.python.failure.Failure <class 'twisted.web.http._DataLoss'>>]
2015-09-30 05:38:51 [scrapy] DEBUG: Retrying <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T111&Option=1#htop> (failed 1 times): [<twisted.python.failure.Failure <class 'twisted.internet.error.ConnectionLost'>>, <twisted.python.failure.Failure <class 'twisted.web.http._DataLoss'>>]
2015-09-30 05:45:06 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 05:45:06 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 05:45:06 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 05:45:06 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 05:45:06 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 05:45:06 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 05:45:06 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 05:45:06 [scrapy] INFO: Spider opened
2015-09-30 05:45:06 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 05:45:06 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 05:45:08 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 05:45:12 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 05:45:18 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 05:45:22 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 05:45:24 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 05:45:25 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 05:45:28 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:45:28 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 488, in parse_hkjc_racecard
    surface = _get_surface(_trackvariant)
NameError: global name '_get_surface' is not defined
2015-09-30 05:45:30 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:45:30 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 488, in parse_hkjc_racecard
    surface = _get_surface(_trackvariant)
NameError: global name '_get_surface' is not defined
2015-09-30 05:45:33 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:45:33 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 488, in parse_hkjc_racecard
    surface = _get_surface(_trackvariant)
NameError: global name '_get_surface' is not defined
2015-09-30 05:45:34 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:45:34 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 488, in parse_hkjc_racecard
    surface = _get_surface(_trackvariant)
NameError: global name '_get_surface' is not defined
2015-09-30 05:45:36 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:45:36 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 488, in parse_hkjc_racecard
    surface = _get_surface(_trackvariant)
NameError: global name '_get_surface' is not defined
2015-09-30 05:45:36 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:45:36 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 488, in parse_hkjc_racecard
    surface = _get_surface(_trackvariant)
NameError: global name '_get_surface' is not defined
2015-09-30 05:45:37 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:45:37 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 488, in parse_hkjc_racecard
    surface = _get_surface(_trackvariant)
NameError: global name '_get_surface' is not defined
2015-09-30 05:45:38 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:45:38 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 488, in parse_hkjc_racecard
    surface = _get_surface(_trackvariant)
NameError: global name '_get_surface' is not defined
2015-09-30 05:45:38 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:45:38 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 488, in parse_hkjc_racecard
    surface = _get_surface(_trackvariant)
NameError: global name '_get_surface' is not defined
2015-09-30 05:45:38 [scrapy] INFO: Closing spider (finished)
2015-09-30 05:45:38 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 5227,
 'downloader/request_count': 14,
 'downloader/request_method_count/GET': 13,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 396730,
 'downloader/response_count': 14,
 'downloader/response_status_count/200': 13,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 5, 45, 38, 847750),
 'log_count/DEBUG': 16,
 'log_count/ERROR': 9,
 'log_count/INFO': 7,
 'request_depth_max': 4,
 'response_received_count': 13,
 'scheduler/dequeued': 14,
 'scheduler/dequeued/memory': 14,
 'scheduler/enqueued': 14,
 'scheduler/enqueued/memory': 14,
 'spider_exceptions/NameError': 9,
 'start_time': datetime.datetime(2015, 9, 30, 5, 45, 6, 118546)}
2015-09-30 05:45:38 [scrapy] INFO: Spider closed (finished)
2015-09-30 05:45:55 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 05:45:55 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 05:45:55 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 05:45:55 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 05:45:55 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 05:45:55 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 05:45:55 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 05:45:55 [scrapy] INFO: Spider opened
2015-09-30 05:45:55 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 05:45:55 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 05:45:57 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 05:46:00 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 05:46:05 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 05:46:08 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 05:46:11 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 05:46:11 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 05:46:14 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:46:14 [root] WARNING: -------------------------------------------------
2015-09-30 05:46:14 [root] WARNING: horse code set
2015-09-30 05:46:14 [root] WARNING: 1
2015-09-30 05:46:14 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 564, in parse_hkjc_racecard
    racegoing= going,
UnboundLocalError: local variable 'going' referenced before assignment
2015-09-30 05:46:17 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:46:17 [root] WARNING: -------------------------------------------------
2015-09-30 05:46:17 [root] WARNING: horse code set
2015-09-30 05:46:17 [root] WARNING: 2
2015-09-30 05:46:17 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 564, in parse_hkjc_racecard
    racegoing= going,
UnboundLocalError: local variable 'going' referenced before assignment
2015-09-30 05:46:19 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:46:19 [root] WARNING: -------------------------------------------------
2015-09-30 05:46:19 [root] WARNING: horse code set
2015-09-30 05:46:19 [root] WARNING: 3
2015-09-30 05:46:19 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 564, in parse_hkjc_racecard
    racegoing= going,
UnboundLocalError: local variable 'going' referenced before assignment
2015-09-30 05:46:20 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:46:20 [root] WARNING: -------------------------------------------------
2015-09-30 05:46:20 [root] WARNING: horse code set
2015-09-30 05:46:20 [root] WARNING: 4
2015-09-30 05:46:20 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 564, in parse_hkjc_racecard
    racegoing= going,
UnboundLocalError: local variable 'going' referenced before assignment
2015-09-30 05:46:21 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:46:21 [root] WARNING: -------------------------------------------------
2015-09-30 05:46:21 [root] WARNING: horse code set
2015-09-30 05:46:21 [root] WARNING: 5
2015-09-30 05:46:21 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 564, in parse_hkjc_racecard
    racegoing= going,
UnboundLocalError: local variable 'going' referenced before assignment
2015-09-30 05:46:22 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:46:22 [root] WARNING: -------------------------------------------------
2015-09-30 05:46:22 [root] WARNING: horse code set
2015-09-30 05:46:22 [root] WARNING: 6
2015-09-30 05:46:22 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 564, in parse_hkjc_racecard
    racegoing= going,
UnboundLocalError: local variable 'going' referenced before assignment
2015-09-30 05:46:23 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:46:23 [root] WARNING: -------------------------------------------------
2015-09-30 05:46:23 [root] WARNING: horse code set
2015-09-30 05:46:23 [root] WARNING: 7
2015-09-30 05:46:23 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 564, in parse_hkjc_racecard
    racegoing= going,
UnboundLocalError: local variable 'going' referenced before assignment
2015-09-30 05:46:24 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:46:24 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:46:24 [root] WARNING: -------------------------------------------------
2015-09-30 05:46:24 [root] WARNING: horse code set
2015-09-30 05:46:24 [root] WARNING: 8
2015-09-30 05:46:24 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 564, in parse_hkjc_racecard
    racegoing= going,
UnboundLocalError: local variable 'going' referenced before assignment
2015-09-30 05:46:24 [root] WARNING: -------------------------------------------------
2015-09-30 05:46:24 [root] WARNING: horse code set
2015-09-30 05:46:24 [root] WARNING: 9
2015-09-30 05:46:24 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 564, in parse_hkjc_racecard
    racegoing= going,
UnboundLocalError: local variable 'going' referenced before assignment
2015-09-30 05:46:24 [scrapy] INFO: Closing spider (finished)
2015-09-30 05:46:24 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 5227,
 'downloader/request_count': 14,
 'downloader/request_method_count/GET': 13,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 396780,
 'downloader/response_count': 14,
 'downloader/response_status_count/200': 13,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 5, 46, 24, 948246),
 'log_count/DEBUG': 16,
 'log_count/ERROR': 9,
 'log_count/INFO': 7,
 'log_count/WARNING': 27,
 'request_depth_max': 4,
 'response_received_count': 13,
 'scheduler/dequeued': 14,
 'scheduler/dequeued/memory': 14,
 'scheduler/enqueued': 14,
 'scheduler/enqueued/memory': 14,
 'spider_exceptions/UnboundLocalError': 9,
 'start_time': datetime.datetime(2015, 9, 30, 5, 45, 55, 202499)}
2015-09-30 05:46:24 [scrapy] INFO: Spider closed (finished)
2015-09-30 05:51:56 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 05:51:56 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 05:51:56 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 05:51:56 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 05:51:56 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 05:51:56 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 05:51:56 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 05:51:56 [scrapy] INFO: Spider opened
2015-09-30 05:51:56 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 05:51:56 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 05:51:58 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 05:52:01 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 05:52:06 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 05:52:11 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 05:52:13 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 05:52:13 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 05:52:20 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:52:20 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:20 [root] WARNING: horse code set
2015-09-30 05:52:20 [root] WARNING: 1
2015-09-30 05:52:20 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:20 [root] WARNING: horse code set
2015-09-30 05:52:20 [root] WARNING: 2
2015-09-30 05:52:20 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:20 [root] WARNING: horse code set
2015-09-30 05:52:20 [root] WARNING: 3
2015-09-30 05:52:20 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:20 [root] WARNING: horse code set
2015-09-30 05:52:20 [root] WARNING: 4
2015-09-30 05:52:20 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:20 [root] WARNING: horse code set
2015-09-30 05:52:20 [root] WARNING: 5
2015-09-30 05:52:20 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:20 [root] WARNING: horse code set
2015-09-30 05:52:20 [root] WARNING: 6
2015-09-30 05:52:20 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:20 [root] WARNING: horse code set
2015-09-30 05:52:20 [root] WARNING: 7
2015-09-30 05:52:20 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:20 [root] WARNING: horse code set
2015-09-30 05:52:20 [root] WARNING: 8
2015-09-30 05:52:20 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:20 [root] WARNING: horse code set
2015-09-30 05:52:20 [root] WARNING: 9
2015-09-30 05:52:20 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:20 [root] WARNING: horse code set
2015-09-30 05:52:20 [root] WARNING: 10
2015-09-30 05:52:20 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:20 [root] WARNING: horse code set
2015-09-30 05:52:20 [root] WARNING: 11
2015-09-30 05:52:20 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:20 [root] WARNING: horse code set
2015-09-30 05:52:20 [root] WARNING: 12
2015-09-30 05:52:20 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:20 [root] WARNING: horse code set
2015-09-30 05:52:20 [root] WARNING: 13
2015-09-30 05:52:20 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:20 [root] WARNING: horse code set
2015-09-30 05:52:20 [root] WARNING: 14
2015-09-30 05:52:23 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:52:23 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:23 [root] WARNING: horse code set
2015-09-30 05:52:23 [root] WARNING: 15
2015-09-30 05:52:23 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:23 [root] WARNING: horse code set
2015-09-30 05:52:23 [root] WARNING: 16
2015-09-30 05:52:23 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:23 [root] WARNING: horse code set
2015-09-30 05:52:23 [root] WARNING: 17
2015-09-30 05:52:23 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:23 [root] WARNING: horse code set
2015-09-30 05:52:23 [root] WARNING: 18
2015-09-30 05:52:23 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:23 [root] WARNING: horse code set
2015-09-30 05:52:23 [root] WARNING: 19
2015-09-30 05:52:23 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:23 [root] WARNING: horse code set
2015-09-30 05:52:23 [root] WARNING: 20
2015-09-30 05:52:23 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:23 [root] WARNING: horse code set
2015-09-30 05:52:23 [root] WARNING: 21
2015-09-30 05:52:23 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:23 [root] WARNING: horse code set
2015-09-30 05:52:23 [root] WARNING: 22
2015-09-30 05:52:23 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:23 [root] WARNING: horse code set
2015-09-30 05:52:23 [root] WARNING: 23
2015-09-30 05:52:23 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:23 [root] WARNING: horse code set
2015-09-30 05:52:23 [root] WARNING: 24
2015-09-30 05:52:23 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:23 [root] WARNING: horse code set
2015-09-30 05:52:23 [root] WARNING: 25
2015-09-30 05:52:23 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:23 [root] WARNING: horse code set
2015-09-30 05:52:23 [root] WARNING: 26
2015-09-30 05:52:23 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:23 [root] WARNING: horse code set
2015-09-30 05:52:23 [root] WARNING: 27
2015-09-30 05:52:23 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:23 [root] WARNING: horse code set
2015-09-30 05:52:23 [root] WARNING: 28
2015-09-30 05:52:24 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:52:24 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:24 [root] WARNING: horse code set
2015-09-30 05:52:24 [root] WARNING: 29
2015-09-30 05:52:24 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:24 [root] WARNING: horse code set
2015-09-30 05:52:24 [root] WARNING: 30
2015-09-30 05:52:24 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:24 [root] WARNING: horse code set
2015-09-30 05:52:24 [root] WARNING: 31
2015-09-30 05:52:24 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:24 [root] WARNING: horse code set
2015-09-30 05:52:24 [root] WARNING: 32
2015-09-30 05:52:24 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:24 [root] WARNING: horse code set
2015-09-30 05:52:24 [root] WARNING: 33
2015-09-30 05:52:24 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:24 [root] WARNING: horse code set
2015-09-30 05:52:24 [root] WARNING: 34
2015-09-30 05:52:24 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:24 [root] WARNING: horse code set
2015-09-30 05:52:24 [root] WARNING: 35
2015-09-30 05:52:24 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:24 [root] WARNING: horse code set
2015-09-30 05:52:24 [root] WARNING: 36
2015-09-30 05:52:24 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:24 [root] WARNING: horse code set
2015-09-30 05:52:24 [root] WARNING: 37
2015-09-30 05:52:24 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:24 [root] WARNING: horse code set
2015-09-30 05:52:24 [root] WARNING: 38
2015-09-30 05:52:24 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:24 [root] WARNING: horse code set
2015-09-30 05:52:24 [root] WARNING: 39
2015-09-30 05:52:24 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:24 [root] WARNING: horse code set
2015-09-30 05:52:24 [root] WARNING: 40
2015-09-30 05:52:24 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:24 [root] WARNING: horse code set
2015-09-30 05:52:24 [root] WARNING: 41
2015-09-30 05:52:24 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:24 [root] WARNING: horse code set
2015-09-30 05:52:24 [root] WARNING: 42
2015-09-30 05:52:26 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:52:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:27 [root] WARNING: horse code set
2015-09-30 05:52:27 [root] WARNING: 43
2015-09-30 05:52:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:27 [root] WARNING: horse code set
2015-09-30 05:52:27 [root] WARNING: 44
2015-09-30 05:52:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:27 [root] WARNING: horse code set
2015-09-30 05:52:27 [root] WARNING: 45
2015-09-30 05:52:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:27 [root] WARNING: horse code set
2015-09-30 05:52:27 [root] WARNING: 46
2015-09-30 05:52:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:27 [root] WARNING: horse code set
2015-09-30 05:52:27 [root] WARNING: 47
2015-09-30 05:52:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:27 [root] WARNING: horse code set
2015-09-30 05:52:27 [root] WARNING: 48
2015-09-30 05:52:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:27 [root] WARNING: horse code set
2015-09-30 05:52:27 [root] WARNING: 49
2015-09-30 05:52:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:27 [root] WARNING: horse code set
2015-09-30 05:52:27 [root] WARNING: 50
2015-09-30 05:52:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:27 [root] WARNING: horse code set
2015-09-30 05:52:27 [root] WARNING: 51
2015-09-30 05:52:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:27 [root] WARNING: horse code set
2015-09-30 05:52:27 [root] WARNING: 52
2015-09-30 05:52:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:27 [root] WARNING: horse code set
2015-09-30 05:52:27 [root] WARNING: 53
2015-09-30 05:52:27 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:27 [root] WARNING: horse code set
2015-09-30 05:52:27 [root] WARNING: 54
2015-09-30 05:52:28 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:52:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:28 [root] WARNING: horse code set
2015-09-30 05:52:28 [root] WARNING: 55
2015-09-30 05:52:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:28 [root] WARNING: horse code set
2015-09-30 05:52:28 [root] WARNING: 56
2015-09-30 05:52:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:28 [root] WARNING: horse code set
2015-09-30 05:52:28 [root] WARNING: 57
2015-09-30 05:52:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:28 [root] WARNING: horse code set
2015-09-30 05:52:28 [root] WARNING: 58
2015-09-30 05:52:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:28 [root] WARNING: horse code set
2015-09-30 05:52:28 [root] WARNING: 59
2015-09-30 05:52:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:28 [root] WARNING: horse code set
2015-09-30 05:52:28 [root] WARNING: 60
2015-09-30 05:52:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:28 [root] WARNING: horse code set
2015-09-30 05:52:28 [root] WARNING: 61
2015-09-30 05:52:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:28 [root] WARNING: horse code set
2015-09-30 05:52:28 [root] WARNING: 62
2015-09-30 05:52:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:28 [root] WARNING: horse code set
2015-09-30 05:52:28 [root] WARNING: 63
2015-09-30 05:52:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:28 [root] WARNING: horse code set
2015-09-30 05:52:28 [root] WARNING: 64
2015-09-30 05:52:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:28 [root] WARNING: horse code set
2015-09-30 05:52:28 [root] WARNING: 65
2015-09-30 05:52:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:28 [root] WARNING: horse code set
2015-09-30 05:52:28 [root] WARNING: 66
2015-09-30 05:52:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:28 [root] WARNING: horse code set
2015-09-30 05:52:28 [root] WARNING: 67
2015-09-30 05:52:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:28 [root] WARNING: horse code set
2015-09-30 05:52:28 [root] WARNING: 68
2015-09-30 05:52:28 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:52:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:28 [root] WARNING: horse code set
2015-09-30 05:52:28 [root] WARNING: 69
2015-09-30 05:52:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:28 [root] WARNING: horse code set
2015-09-30 05:52:28 [root] WARNING: 70
2015-09-30 05:52:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:28 [root] WARNING: horse code set
2015-09-30 05:52:28 [root] WARNING: 71
2015-09-30 05:52:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:28 [root] WARNING: horse code set
2015-09-30 05:52:28 [root] WARNING: 72
2015-09-30 05:52:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:28 [root] WARNING: horse code set
2015-09-30 05:52:28 [root] WARNING: 73
2015-09-30 05:52:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:28 [root] WARNING: horse code set
2015-09-30 05:52:28 [root] WARNING: 74
2015-09-30 05:52:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:28 [root] WARNING: horse code set
2015-09-30 05:52:28 [root] WARNING: 75
2015-09-30 05:52:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:28 [root] WARNING: horse code set
2015-09-30 05:52:28 [root] WARNING: 76
2015-09-30 05:52:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:28 [root] WARNING: horse code set
2015-09-30 05:52:28 [root] WARNING: 77
2015-09-30 05:52:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:28 [root] WARNING: horse code set
2015-09-30 05:52:28 [root] WARNING: 78
2015-09-30 05:52:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:28 [root] WARNING: horse code set
2015-09-30 05:52:28 [root] WARNING: 79
2015-09-30 05:52:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:28 [root] WARNING: horse code set
2015-09-30 05:52:28 [root] WARNING: 80
2015-09-30 05:52:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:28 [root] WARNING: horse code set
2015-09-30 05:52:28 [root] WARNING: 81
2015-09-30 05:52:28 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:28 [root] WARNING: horse code set
2015-09-30 05:52:28 [root] WARNING: 82
2015-09-30 05:52:29 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:52:29 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:29 [root] WARNING: horse code set
2015-09-30 05:52:29 [root] WARNING: 83
2015-09-30 05:52:29 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:29 [root] WARNING: horse code set
2015-09-30 05:52:29 [root] WARNING: 84
2015-09-30 05:52:29 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:29 [root] WARNING: horse code set
2015-09-30 05:52:29 [root] WARNING: 85
2015-09-30 05:52:29 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:29 [root] WARNING: horse code set
2015-09-30 05:52:29 [root] WARNING: 86
2015-09-30 05:52:29 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:29 [root] WARNING: horse code set
2015-09-30 05:52:29 [root] WARNING: 87
2015-09-30 05:52:29 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:29 [root] WARNING: horse code set
2015-09-30 05:52:29 [root] WARNING: 88
2015-09-30 05:52:29 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:29 [root] WARNING: horse code set
2015-09-30 05:52:29 [root] WARNING: 89
2015-09-30 05:52:29 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:29 [root] WARNING: horse code set
2015-09-30 05:52:29 [root] WARNING: 90
2015-09-30 05:52:29 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:29 [root] WARNING: horse code set
2015-09-30 05:52:29 [root] WARNING: 91
2015-09-30 05:52:29 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:29 [root] WARNING: horse code set
2015-09-30 05:52:29 [root] WARNING: 92
2015-09-30 05:52:29 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:29 [root] WARNING: horse code set
2015-09-30 05:52:29 [root] WARNING: 93
2015-09-30 05:52:29 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:52:30 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:30 [root] WARNING: horse code set
2015-09-30 05:52:30 [root] WARNING: 94
2015-09-30 05:52:30 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:30 [root] WARNING: horse code set
2015-09-30 05:52:30 [root] WARNING: 95
2015-09-30 05:52:30 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:30 [root] WARNING: horse code set
2015-09-30 05:52:30 [root] WARNING: 96
2015-09-30 05:52:30 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:30 [root] WARNING: horse code set
2015-09-30 05:52:30 [root] WARNING: 97
2015-09-30 05:52:30 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:30 [root] WARNING: horse code set
2015-09-30 05:52:30 [root] WARNING: 98
2015-09-30 05:52:30 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:30 [root] WARNING: horse code set
2015-09-30 05:52:30 [root] WARNING: 99
2015-09-30 05:52:30 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:30 [root] WARNING: horse code set
2015-09-30 05:52:30 [root] WARNING: 100
2015-09-30 05:52:30 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:30 [root] WARNING: horse code set
2015-09-30 05:52:30 [root] WARNING: 101
2015-09-30 05:52:30 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:30 [root] WARNING: horse code set
2015-09-30 05:52:30 [root] WARNING: 102
2015-09-30 05:52:30 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:30 [root] WARNING: horse code set
2015-09-30 05:52:30 [root] WARNING: 103
2015-09-30 05:52:30 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:30 [root] WARNING: horse code set
2015-09-30 05:52:30 [root] WARNING: 104
2015-09-30 05:52:30 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:30 [root] WARNING: horse code set
2015-09-30 05:52:30 [root] WARNING: 105
2015-09-30 05:52:30 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:30 [root] WARNING: horse code set
2015-09-30 05:52:30 [root] WARNING: 106
2015-09-30 05:52:30 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:30 [root] WARNING: horse code set
2015-09-30 05:52:30 [root] WARNING: 107
2015-09-30 05:52:30 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 05:52:30 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:30 [root] WARNING: horse code set
2015-09-30 05:52:30 [root] WARNING: 108
2015-09-30 05:52:30 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:30 [root] WARNING: horse code set
2015-09-30 05:52:30 [root] WARNING: 109
2015-09-30 05:52:30 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:30 [root] WARNING: horse code set
2015-09-30 05:52:30 [root] WARNING: 110
2015-09-30 05:52:30 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:30 [root] WARNING: horse code set
2015-09-30 05:52:30 [root] WARNING: 111
2015-09-30 05:52:30 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:30 [root] WARNING: horse code set
2015-09-30 05:52:30 [root] WARNING: 112
2015-09-30 05:52:30 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:30 [root] WARNING: horse code set
2015-09-30 05:52:30 [root] WARNING: 113
2015-09-30 05:52:30 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:30 [root] WARNING: horse code set
2015-09-30 05:52:30 [root] WARNING: 114
2015-09-30 05:52:30 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:30 [root] WARNING: horse code set
2015-09-30 05:52:30 [root] WARNING: 115
2015-09-30 05:52:30 [root] WARNING: -------------------------------------------------
2015-09-30 05:52:30 [root] WARNING: horse code set
2015-09-30 05:52:30 [root] WARNING: 116
2015-09-30 05:52:32 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T200&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:52:32 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:52:32 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:52:32 [root] WARNING: 1
2015-09-30 05:52:32 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T200&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:52:32 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:52:32 [root] WARNING: 2
2015-09-30 05:52:32 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:52:32 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T096&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:52:32 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:52:32 [root] WARNING: 3
2015-09-30 05:52:32 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T096&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:52:34 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T009&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:52:34 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:52:34 [root] WARNING: 4
2015-09-30 05:52:34 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T009&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:52:35 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T398&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:52:35 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:52:35 [root] WARNING: 5
2015-09-30 05:52:35 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T398&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:52:36 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S439&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:52:36 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:52:36 [root] WARNING: 6
2015-09-30 05:52:36 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S439&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:52:36 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S010&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:52:36 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:52:36 [root] WARNING: 7
2015-09-30 05:52:37 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S010&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:52:37 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S398&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:52:37 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:52:37 [root] WARNING: 8
2015-09-30 05:52:37 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S398&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:52:38 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T288&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 05:52:38 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:52:38 [root] WARNING: 9
2015-09-30 05:52:38 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T288&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:52:39 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P222&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:52:39 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:52:39 [root] WARNING: 10
2015-09-30 05:52:39 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P222&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:52:40 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T135&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:52:40 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:52:40 [root] WARNING: 11
2015-09-30 05:52:40 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T135&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:52:40 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P158&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 05:52:40 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:52:40 [root] WARNING: 12
2015-09-30 05:52:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P158&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:52:41 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P031&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 05:52:41 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:52:41 [root] WARNING: 13
2015-09-30 05:52:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P031&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:52:43 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S346&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 05:52:43 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:52:43 [root] WARNING: 14
2015-09-30 05:52:43 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S346&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:52:43 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S305&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 05:52:43 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:52:43 [root] WARNING: 15
2015-09-30 05:52:44 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S305&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:52:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 05:52:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S076&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 05:52:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:52:47 [root] WARNING: 16
2015-09-30 05:52:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:52:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:52:47 [root] WARNING: 17
2015-09-30 05:52:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S076&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:52:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P358&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 05:52:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:52:47 [root] WARNING: 18
2015-09-30 05:52:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P358&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:52:48 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N234&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:52:48 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:52:48 [root] WARNING: 19
2015-09-30 05:52:48 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N234&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:52:52 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S332&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 05:52:52 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:52:52 [root] WARNING: 20
2015-09-30 05:52:52 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S332&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:52:53 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 05:52:53 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T080&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:52:53 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:52:53 [root] WARNING: 21
2015-09-30 05:52:53 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:52:53 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:52:53 [root] WARNING: 22
2015-09-30 05:52:53 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T080&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:52:53 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S100&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 05:52:53 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:52:53 [root] WARNING: 23
2015-09-30 05:52:53 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S100&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:52:54 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T205&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:52:54 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:52:54 [root] WARNING: 24
2015-09-30 05:52:54 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T205&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:52:55 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P151&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 05:52:55 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:52:55 [root] WARNING: 25
2015-09-30 05:52:55 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P151&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:52:55 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S023&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 05:52:55 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:52:55 [root] WARNING: 26
2015-09-30 05:52:55 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S023&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:52:55 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V061&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:52:55 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P044&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 05:52:55 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T005&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:52:55 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:52:55 [root] WARNING: 27
2015-09-30 05:52:55 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V061&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:52:56 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:52:56 [root] WARNING: 28
2015-09-30 05:52:56 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P044&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:52:56 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N330&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:52:56 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:52:56 [root] WARNING: 29
2015-09-30 05:52:56 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T005&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:52:56 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:52:56 [root] WARNING: 30
2015-09-30 05:52:56 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N330&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:52:56 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T342&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:52:56 [scrapy] INFO: Crawled 44 pages (at 44 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 05:52:56 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:52:56 [root] WARNING: 31
2015-09-30 05:52:56 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T342&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:52:57 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V039&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:52:57 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:52:57 [root] WARNING: 32
2015-09-30 05:52:57 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V039&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:52:58 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:52:59 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:52:59 [root] WARNING: 33
2015-09-30 05:52:59 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:52:59 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T333&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:52:59 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:52:59 [root] WARNING: 34
2015-09-30 05:52:59 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T333&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:00 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T340&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:53:00 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:00 [root] WARNING: 35
2015-09-30 05:53:00 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T340&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:03 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S397&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:53:03 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:03 [root] WARNING: 36
2015-09-30 05:53:04 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S397&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:04 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N226&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:53:04 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:04 [root] WARNING: 37
2015-09-30 05:53:05 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N226&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:05 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T168&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 05:53:05 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:05 [root] WARNING: 38
2015-09-30 05:53:05 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T168&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:07 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P097&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 05:53:07 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:07 [root] WARNING: 39
2015-09-30 05:53:07 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P097&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:07 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 05:53:08 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:08 [root] WARNING: 40
2015-09-30 05:53:08 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:09 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S209&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 05:53:10 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:10 [root] WARNING: 41
2015-09-30 05:53:10 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S209&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:10 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T002&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 05:53:10 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:10 [root] WARNING: 42
2015-09-30 05:53:10 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T002&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:11 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S300&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 05:53:11 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:11 [root] WARNING: 43
2015-09-30 05:53:11 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S300&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:13 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N220&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 05:53:13 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:13 [root] WARNING: 44
2015-09-30 05:53:13 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N220&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:13 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P316&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 05:53:13 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S375&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 05:53:13 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:13 [root] WARNING: 45
2015-09-30 05:53:14 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P316&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:14 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:14 [root] WARNING: 46
2015-09-30 05:53:14 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S375&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:15 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 05:53:15 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:15 [root] WARNING: 47
2015-09-30 05:53:16 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:16 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 05:53:16 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:16 [root] WARNING: 48
2015-09-30 05:53:16 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:17 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T111&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 05:53:17 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:17 [root] WARNING: 49
2015-09-30 05:53:17 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T111&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:17 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S165&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 05:53:17 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M227&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 05:53:17 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:17 [root] WARNING: 50
2015-09-30 05:53:17 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S165&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:17 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:17 [root] WARNING: 51
2015-09-30 05:53:18 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M227&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:18 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 05:53:18 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:18 [root] WARNING: 52
2015-09-30 05:53:18 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:18 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S225&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 05:53:18 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:18 [root] WARNING: 53
2015-09-30 05:53:18 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S225&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:19 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S415&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 05:53:19 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:19 [root] WARNING: 54
2015-09-30 05:53:19 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S415&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:20 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T289&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 05:53:20 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:20 [root] WARNING: 55
2015-09-30 05:53:20 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T289&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:21 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T379&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 05:53:21 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:21 [root] WARNING: 56
2015-09-30 05:53:21 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T379&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:22 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N419&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 05:53:22 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:22 [root] WARNING: 57
2015-09-30 05:53:22 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N419&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:22 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T050&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 05:53:22 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:22 [root] WARNING: 58
2015-09-30 05:53:22 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T050&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:25 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:53:25 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T129&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 05:53:25 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:25 [root] WARNING: 59
2015-09-30 05:53:25 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:25 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:25 [root] WARNING: 60
2015-09-30 05:53:25 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T129&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:25 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S394&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 05:53:25 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:25 [root] WARNING: 61
2015-09-30 05:53:25 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S394&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:25 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S275&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 05:53:25 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:25 [root] WARNING: 62
2015-09-30 05:53:25 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S275&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:26 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T265&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:53:26 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:26 [root] WARNING: 63
2015-09-30 05:53:26 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T265&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:27 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S421&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:53:27 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:27 [root] WARNING: 64
2015-09-30 05:53:27 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S421&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:28 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T004&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:53:28 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:28 [root] WARNING: 65
2015-09-30 05:53:28 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T004&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:28 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T404&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:53:29 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:29 [root] WARNING: 66
2015-09-30 05:53:29 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T404&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:30 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T215&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:53:30 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:30 [root] WARNING: 67
2015-09-30 05:53:30 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T215&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:34 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N432&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:53:34 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:34 [root] WARNING: 68
2015-09-30 05:53:34 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N432&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:34 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:53:34 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:34 [root] WARNING: 69
2015-09-30 05:53:34 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:34 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N386&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:53:35 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:35 [root] WARNING: 70
2015-09-30 05:53:35 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N386&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:35 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:53:35 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:35 [root] WARNING: 71
2015-09-30 05:53:35 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:36 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P173&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:53:37 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:37 [root] WARNING: 72
2015-09-30 05:53:37 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P173&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:38 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T235&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 05:53:38 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:38 [root] WARNING: 73
2015-09-30 05:53:38 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T235&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:38 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S349&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:53:38 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:38 [root] WARNING: 74
2015-09-30 05:53:38 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S349&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:40 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 05:53:40 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:40 [root] WARNING: 75
2015-09-30 05:53:40 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:41 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 05:53:41 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:41 [root] WARNING: 76
2015-09-30 05:53:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:41 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 05:53:41 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:41 [root] WARNING: 77
2015-09-30 05:53:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:42 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 05:53:42 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:42 [root] WARNING: 78
2015-09-30 05:53:43 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:45 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P180&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 05:53:45 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:45 [root] WARNING: 79
2015-09-30 05:53:45 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P180&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N297&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 05:53:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:46 [root] WARNING: 80
2015-09-30 05:53:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N297&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P195&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 05:53:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:46 [root] WARNING: 81
2015-09-30 05:53:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P195&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 05:53:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:47 [root] WARNING: 82
2015-09-30 05:53:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 05:53:48 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:48 [root] WARNING: 83
2015-09-30 05:53:48 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:48 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N236&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 05:53:48 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:48 [root] WARNING: 84
2015-09-30 05:53:48 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N236&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:50 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 05:53:50 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:50 [root] WARNING: 85
2015-09-30 05:53:50 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:51 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N171&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 05:53:51 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:51 [root] WARNING: 86
2015-09-30 05:53:51 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N171&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:51 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T257&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 05:53:51 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:51 [root] WARNING: 87
2015-09-30 05:53:51 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T257&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:53 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T256&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 05:53:53 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:53 [root] WARNING: 88
2015-09-30 05:53:53 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T256&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:54 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N434&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 05:53:54 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:54 [root] WARNING: 89
2015-09-30 05:53:54 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N434&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:55 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S296&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 05:53:55 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:55 [root] WARNING: 90
2015-09-30 05:53:55 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S296&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:56 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T093&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 05:53:56 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:53:56 [root] WARNING: 91
2015-09-30 05:53:56 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T093&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:53:56 [scrapy] INFO: Crawled 104 pages (at 60 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 05:54:00 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P111&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 05:54:00 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:54:00 [root] WARNING: 92
2015-09-30 05:54:00 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P111&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:54:01 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M199&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 05:54:01 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:54:01 [root] WARNING: 93
2015-09-30 05:54:02 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M199&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:54:02 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S420&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 05:54:02 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:54:02 [root] WARNING: 94
2015-09-30 05:54:02 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S420&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:54:02 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S278&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 05:54:03 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:54:03 [root] WARNING: 95
2015-09-30 05:54:03 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S278&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:54:03 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T170&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 05:54:03 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:54:03 [root] WARNING: 96
2015-09-30 05:54:03 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T170&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:54:05 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T112&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 05:54:05 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:54:05 [root] WARNING: 97
2015-09-30 05:54:05 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T112&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:54:08 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N394&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 05:54:08 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:54:08 [root] WARNING: 98
2015-09-30 05:54:08 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N394&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:54:08 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T148&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 05:54:08 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:54:08 [root] WARNING: 99
2015-09-30 05:54:09 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T148&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:54:09 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S282&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 05:54:09 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:54:09 [root] WARNING: 100
2015-09-30 05:54:09 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S282&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:54:14 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S391&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 05:54:14 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:54:14 [root] WARNING: 101
2015-09-30 05:54:14 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S391&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:54:19 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P191&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 05:54:19 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:54:19 [root] WARNING: 102
2015-09-30 05:54:19 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P191&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:54:20 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S109&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 05:54:20 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:54:20 [root] WARNING: 103
2015-09-30 05:54:20 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S109&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:54:20 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P118&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 05:54:20 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:54:20 [root] WARNING: 104
2015-09-30 05:54:20 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P118&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:54:22 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N169&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 05:54:22 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:54:22 [root] WARNING: 105
2015-09-30 05:54:22 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N169&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:54:22 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S117&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 05:54:22 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P366&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 05:54:22 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:54:22 [root] WARNING: 106
2015-09-30 05:54:22 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S117&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:54:22 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:54:22 [root] WARNING: 107
2015-09-30 05:54:22 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P366&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:54:22 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S145&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 05:54:22 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:54:22 [root] WARNING: 108
2015-09-30 05:54:22 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S145&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:54:22 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 05:54:23 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:54:23 [root] WARNING: 109
2015-09-30 05:54:23 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:54:25 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P372&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:54:25 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:54:25 [root] WARNING: 110
2015-09-30 05:54:25 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P372&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:54:26 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S110&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 05:54:27 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:54:27 [root] WARNING: 111
2015-09-30 05:54:27 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S110&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:54:27 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T238&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:54:27 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:54:27 [root] WARNING: 112
2015-09-30 05:54:27 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T238&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:54:28 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S022&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:54:28 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:54:28 [root] WARNING: 113
2015-09-30 05:54:28 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S022&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:54:31 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N195&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 05:54:31 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:54:31 [root] WARNING: 114
2015-09-30 05:54:31 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N195&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:54:31 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P103&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:54:31 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:54:31 [root] WARNING: 115
2015-09-30 05:54:32 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P103&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:54:32 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N033&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 05:54:32 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 05:54:32 [root] WARNING: 116
2015-09-30 05:54:32 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N033&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 785, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'chain' is not defined
2015-09-30 05:54:32 [scrapy] INFO: Closing spider (finished)
2015-09-30 05:54:32 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 65614,
 'downloader/request_count': 130,
 'downloader/request_method_count/GET': 129,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 10042754,
 'downloader/response_count': 130,
 'downloader/response_status_count/200': 129,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 5, 54, 32, 430170),
 'log_count/DEBUG': 132,
 'log_count/ERROR': 116,
 'log_count/INFO': 9,
 'log_count/WARNING': 580,
 'request_depth_max': 5,
 'response_received_count': 129,
 'scheduler/dequeued': 130,
 'scheduler/dequeued/memory': 130,
 'scheduler/enqueued': 130,
 'scheduler/enqueued/memory': 130,
 'spider_exceptions/NameError': 116,
 'start_time': datetime.datetime(2015, 9, 30, 5, 51, 56, 904681)}
2015-09-30 05:54:32 [scrapy] INFO: Spider closed (finished)
2015-09-30 06:00:27 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 06:00:27 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 06:00:27 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 06:00:27 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 06:00:27 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 06:00:27 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 06:00:27 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 06:00:27 [scrapy] INFO: Spider opened
2015-09-30 06:00:27 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 06:00:27 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 06:00:29 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 06:00:33 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 06:00:37 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 06:00:40 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 06:00:43 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 06:00:43 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 06:00:47 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 06:00:47 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:47 [root] WARNING: horse code set
2015-09-30 06:00:47 [root] WARNING: 1
2015-09-30 06:00:47 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:47 [root] WARNING: horse code set
2015-09-30 06:00:47 [root] WARNING: 2
2015-09-30 06:00:47 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:47 [root] WARNING: horse code set
2015-09-30 06:00:47 [root] WARNING: 3
2015-09-30 06:00:47 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:47 [root] WARNING: horse code set
2015-09-30 06:00:47 [root] WARNING: 4
2015-09-30 06:00:47 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:47 [root] WARNING: horse code set
2015-09-30 06:00:47 [root] WARNING: 5
2015-09-30 06:00:47 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:47 [root] WARNING: horse code set
2015-09-30 06:00:47 [root] WARNING: 6
2015-09-30 06:00:47 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:47 [root] WARNING: horse code set
2015-09-30 06:00:47 [root] WARNING: 7
2015-09-30 06:00:47 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:47 [root] WARNING: horse code set
2015-09-30 06:00:47 [root] WARNING: 8
2015-09-30 06:00:47 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:47 [root] WARNING: horse code set
2015-09-30 06:00:47 [root] WARNING: 9
2015-09-30 06:00:47 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:47 [root] WARNING: horse code set
2015-09-30 06:00:47 [root] WARNING: 10
2015-09-30 06:00:47 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:47 [root] WARNING: horse code set
2015-09-30 06:00:47 [root] WARNING: 11
2015-09-30 06:00:47 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:47 [root] WARNING: horse code set
2015-09-30 06:00:47 [root] WARNING: 12
2015-09-30 06:00:47 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:47 [root] WARNING: horse code set
2015-09-30 06:00:47 [root] WARNING: 13
2015-09-30 06:00:47 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:47 [root] WARNING: horse code set
2015-09-30 06:00:47 [root] WARNING: 14
2015-09-30 06:00:49 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 06:00:49 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:49 [root] WARNING: horse code set
2015-09-30 06:00:49 [root] WARNING: 15
2015-09-30 06:00:49 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:49 [root] WARNING: horse code set
2015-09-30 06:00:49 [root] WARNING: 16
2015-09-30 06:00:49 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:49 [root] WARNING: horse code set
2015-09-30 06:00:49 [root] WARNING: 17
2015-09-30 06:00:49 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:49 [root] WARNING: horse code set
2015-09-30 06:00:49 [root] WARNING: 18
2015-09-30 06:00:49 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:49 [root] WARNING: horse code set
2015-09-30 06:00:49 [root] WARNING: 19
2015-09-30 06:00:49 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:49 [root] WARNING: horse code set
2015-09-30 06:00:49 [root] WARNING: 20
2015-09-30 06:00:49 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:49 [root] WARNING: horse code set
2015-09-30 06:00:49 [root] WARNING: 21
2015-09-30 06:00:49 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:49 [root] WARNING: horse code set
2015-09-30 06:00:49 [root] WARNING: 22
2015-09-30 06:00:49 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:49 [root] WARNING: horse code set
2015-09-30 06:00:49 [root] WARNING: 23
2015-09-30 06:00:49 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:49 [root] WARNING: horse code set
2015-09-30 06:00:49 [root] WARNING: 24
2015-09-30 06:00:49 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:49 [root] WARNING: horse code set
2015-09-30 06:00:49 [root] WARNING: 25
2015-09-30 06:00:49 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:49 [root] WARNING: horse code set
2015-09-30 06:00:49 [root] WARNING: 26
2015-09-30 06:00:49 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:49 [root] WARNING: horse code set
2015-09-30 06:00:49 [root] WARNING: 27
2015-09-30 06:00:49 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:49 [root] WARNING: horse code set
2015-09-30 06:00:49 [root] WARNING: 28
2015-09-30 06:00:51 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 06:00:52 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:52 [root] WARNING: horse code set
2015-09-30 06:00:52 [root] WARNING: 29
2015-09-30 06:00:52 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:52 [root] WARNING: horse code set
2015-09-30 06:00:52 [root] WARNING: 30
2015-09-30 06:00:52 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:52 [root] WARNING: horse code set
2015-09-30 06:00:52 [root] WARNING: 31
2015-09-30 06:00:52 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:52 [root] WARNING: horse code set
2015-09-30 06:00:52 [root] WARNING: 32
2015-09-30 06:00:52 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:52 [root] WARNING: horse code set
2015-09-30 06:00:52 [root] WARNING: 33
2015-09-30 06:00:52 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:52 [root] WARNING: horse code set
2015-09-30 06:00:52 [root] WARNING: 34
2015-09-30 06:00:52 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:52 [root] WARNING: horse code set
2015-09-30 06:00:52 [root] WARNING: 35
2015-09-30 06:00:52 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:52 [root] WARNING: horse code set
2015-09-30 06:00:52 [root] WARNING: 36
2015-09-30 06:00:52 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:52 [root] WARNING: horse code set
2015-09-30 06:00:52 [root] WARNING: 37
2015-09-30 06:00:52 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:52 [root] WARNING: horse code set
2015-09-30 06:00:52 [root] WARNING: 38
2015-09-30 06:00:52 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:52 [root] WARNING: horse code set
2015-09-30 06:00:52 [root] WARNING: 39
2015-09-30 06:00:52 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:52 [root] WARNING: horse code set
2015-09-30 06:00:52 [root] WARNING: 40
2015-09-30 06:00:52 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:52 [root] WARNING: horse code set
2015-09-30 06:00:52 [root] WARNING: 41
2015-09-30 06:00:52 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:52 [root] WARNING: horse code set
2015-09-30 06:00:52 [root] WARNING: 42
2015-09-30 06:00:54 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 06:00:54 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:54 [root] WARNING: horse code set
2015-09-30 06:00:54 [root] WARNING: 43
2015-09-30 06:00:54 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:54 [root] WARNING: horse code set
2015-09-30 06:00:54 [root] WARNING: 44
2015-09-30 06:00:54 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:54 [root] WARNING: horse code set
2015-09-30 06:00:54 [root] WARNING: 45
2015-09-30 06:00:54 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:54 [root] WARNING: horse code set
2015-09-30 06:00:54 [root] WARNING: 46
2015-09-30 06:00:54 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:54 [root] WARNING: horse code set
2015-09-30 06:00:54 [root] WARNING: 47
2015-09-30 06:00:54 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:54 [root] WARNING: horse code set
2015-09-30 06:00:54 [root] WARNING: 48
2015-09-30 06:00:54 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:54 [root] WARNING: horse code set
2015-09-30 06:00:54 [root] WARNING: 49
2015-09-30 06:00:54 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:54 [root] WARNING: horse code set
2015-09-30 06:00:54 [root] WARNING: 50
2015-09-30 06:00:54 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:54 [root] WARNING: horse code set
2015-09-30 06:00:54 [root] WARNING: 51
2015-09-30 06:00:54 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:54 [root] WARNING: horse code set
2015-09-30 06:00:54 [root] WARNING: 52
2015-09-30 06:00:54 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:54 [root] WARNING: horse code set
2015-09-30 06:00:54 [root] WARNING: 53
2015-09-30 06:00:54 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:54 [root] WARNING: horse code set
2015-09-30 06:00:54 [root] WARNING: 54
2015-09-30 06:00:54 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 06:00:54 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:54 [root] WARNING: horse code set
2015-09-30 06:00:54 [root] WARNING: 55
2015-09-30 06:00:54 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:54 [root] WARNING: horse code set
2015-09-30 06:00:54 [root] WARNING: 56
2015-09-30 06:00:54 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:54 [root] WARNING: horse code set
2015-09-30 06:00:54 [root] WARNING: 57
2015-09-30 06:00:54 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:54 [root] WARNING: horse code set
2015-09-30 06:00:54 [root] WARNING: 58
2015-09-30 06:00:54 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:54 [root] WARNING: horse code set
2015-09-30 06:00:54 [root] WARNING: 59
2015-09-30 06:00:54 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:54 [root] WARNING: horse code set
2015-09-30 06:00:54 [root] WARNING: 60
2015-09-30 06:00:54 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:54 [root] WARNING: horse code set
2015-09-30 06:00:54 [root] WARNING: 61
2015-09-30 06:00:54 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:54 [root] WARNING: horse code set
2015-09-30 06:00:54 [root] WARNING: 62
2015-09-30 06:00:54 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:54 [root] WARNING: horse code set
2015-09-30 06:00:54 [root] WARNING: 63
2015-09-30 06:00:54 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:54 [root] WARNING: horse code set
2015-09-30 06:00:54 [root] WARNING: 64
2015-09-30 06:00:54 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:54 [root] WARNING: horse code set
2015-09-30 06:00:54 [root] WARNING: 65
2015-09-30 06:00:54 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:54 [root] WARNING: horse code set
2015-09-30 06:00:54 [root] WARNING: 66
2015-09-30 06:00:54 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:54 [root] WARNING: horse code set
2015-09-30 06:00:54 [root] WARNING: 67
2015-09-30 06:00:54 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:54 [root] WARNING: horse code set
2015-09-30 06:00:54 [root] WARNING: 68
2015-09-30 06:00:55 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 06:00:55 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:55 [root] WARNING: horse code set
2015-09-30 06:00:55 [root] WARNING: 69
2015-09-30 06:00:55 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:55 [root] WARNING: horse code set
2015-09-30 06:00:55 [root] WARNING: 70
2015-09-30 06:00:55 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:55 [root] WARNING: horse code set
2015-09-30 06:00:55 [root] WARNING: 71
2015-09-30 06:00:55 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:55 [root] WARNING: horse code set
2015-09-30 06:00:55 [root] WARNING: 72
2015-09-30 06:00:55 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:55 [root] WARNING: horse code set
2015-09-30 06:00:55 [root] WARNING: 73
2015-09-30 06:00:55 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:55 [root] WARNING: horse code set
2015-09-30 06:00:55 [root] WARNING: 74
2015-09-30 06:00:55 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:55 [root] WARNING: horse code set
2015-09-30 06:00:55 [root] WARNING: 75
2015-09-30 06:00:55 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:55 [root] WARNING: horse code set
2015-09-30 06:00:55 [root] WARNING: 76
2015-09-30 06:00:55 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:55 [root] WARNING: horse code set
2015-09-30 06:00:55 [root] WARNING: 77
2015-09-30 06:00:55 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:55 [root] WARNING: horse code set
2015-09-30 06:00:55 [root] WARNING: 78
2015-09-30 06:00:55 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:55 [root] WARNING: horse code set
2015-09-30 06:00:55 [root] WARNING: 79
2015-09-30 06:00:55 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:55 [root] WARNING: horse code set
2015-09-30 06:00:55 [root] WARNING: 80
2015-09-30 06:00:55 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:55 [root] WARNING: horse code set
2015-09-30 06:00:55 [root] WARNING: 81
2015-09-30 06:00:55 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:55 [root] WARNING: horse code set
2015-09-30 06:00:55 [root] WARNING: 82
2015-09-30 06:00:56 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 06:00:56 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 06:00:56 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:56 [root] WARNING: horse code set
2015-09-30 06:00:56 [root] WARNING: 83
2015-09-30 06:00:56 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:56 [root] WARNING: horse code set
2015-09-30 06:00:56 [root] WARNING: 84
2015-09-30 06:00:56 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:56 [root] WARNING: horse code set
2015-09-30 06:00:56 [root] WARNING: 85
2015-09-30 06:00:56 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:56 [root] WARNING: horse code set
2015-09-30 06:00:56 [root] WARNING: 86
2015-09-30 06:00:56 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:56 [root] WARNING: horse code set
2015-09-30 06:00:56 [root] WARNING: 87
2015-09-30 06:00:56 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:56 [root] WARNING: horse code set
2015-09-30 06:00:56 [root] WARNING: 88
2015-09-30 06:00:56 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:56 [root] WARNING: horse code set
2015-09-30 06:00:56 [root] WARNING: 89
2015-09-30 06:00:56 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:56 [root] WARNING: horse code set
2015-09-30 06:00:56 [root] WARNING: 90
2015-09-30 06:00:56 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:56 [root] WARNING: horse code set
2015-09-30 06:00:56 [root] WARNING: 91
2015-09-30 06:00:56 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:56 [root] WARNING: horse code set
2015-09-30 06:00:56 [root] WARNING: 92
2015-09-30 06:00:56 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:56 [root] WARNING: horse code set
2015-09-30 06:00:56 [root] WARNING: 93
2015-09-30 06:00:56 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:56 [root] WARNING: horse code set
2015-09-30 06:00:56 [root] WARNING: 94
2015-09-30 06:00:56 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:56 [root] WARNING: horse code set
2015-09-30 06:00:56 [root] WARNING: 95
2015-09-30 06:00:56 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:56 [root] WARNING: horse code set
2015-09-30 06:00:56 [root] WARNING: 96
2015-09-30 06:00:57 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:57 [root] WARNING: horse code set
2015-09-30 06:00:57 [root] WARNING: 97
2015-09-30 06:00:57 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:57 [root] WARNING: horse code set
2015-09-30 06:00:57 [root] WARNING: 98
2015-09-30 06:00:57 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:57 [root] WARNING: horse code set
2015-09-30 06:00:57 [root] WARNING: 99
2015-09-30 06:00:57 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:57 [root] WARNING: horse code set
2015-09-30 06:00:57 [root] WARNING: 100
2015-09-30 06:00:57 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:57 [root] WARNING: horse code set
2015-09-30 06:00:57 [root] WARNING: 101
2015-09-30 06:00:57 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:57 [root] WARNING: horse code set
2015-09-30 06:00:57 [root] WARNING: 102
2015-09-30 06:00:57 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:57 [root] WARNING: horse code set
2015-09-30 06:00:57 [root] WARNING: 103
2015-09-30 06:00:57 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:57 [root] WARNING: horse code set
2015-09-30 06:00:57 [root] WARNING: 104
2015-09-30 06:00:57 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:57 [root] WARNING: horse code set
2015-09-30 06:00:57 [root] WARNING: 105
2015-09-30 06:00:57 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:57 [root] WARNING: horse code set
2015-09-30 06:00:57 [root] WARNING: 106
2015-09-30 06:00:57 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:57 [root] WARNING: horse code set
2015-09-30 06:00:57 [root] WARNING: 107
2015-09-30 06:00:58 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 06:00:58 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:58 [root] WARNING: horse code set
2015-09-30 06:00:58 [root] WARNING: 108
2015-09-30 06:00:58 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:58 [root] WARNING: horse code set
2015-09-30 06:00:58 [root] WARNING: 109
2015-09-30 06:00:58 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:58 [root] WARNING: horse code set
2015-09-30 06:00:58 [root] WARNING: 110
2015-09-30 06:00:58 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:58 [root] WARNING: horse code set
2015-09-30 06:00:58 [root] WARNING: 111
2015-09-30 06:00:58 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:58 [root] WARNING: horse code set
2015-09-30 06:00:58 [root] WARNING: 112
2015-09-30 06:00:58 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:58 [root] WARNING: horse code set
2015-09-30 06:00:58 [root] WARNING: 113
2015-09-30 06:00:58 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:58 [root] WARNING: horse code set
2015-09-30 06:00:58 [root] WARNING: 114
2015-09-30 06:00:58 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:58 [root] WARNING: horse code set
2015-09-30 06:00:58 [root] WARNING: 115
2015-09-30 06:00:58 [root] WARNING: -------------------------------------------------
2015-09-30 06:00:58 [root] WARNING: horse code set
2015-09-30 06:00:58 [root] WARNING: 116
2015-09-30 06:01:00 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T200&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 06:01:00 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 06:01:00 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:00 [root] WARNING: 1
2015-09-30 06:01:00 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T200&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:00 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T398&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 06:01:00 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:00 [root] WARNING: 2
2015-09-30 06:01:00 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:00 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:00 [root] WARNING: 3
2015-09-30 06:01:00 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T398&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:02 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T238&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 06:01:02 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T009&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 06:01:02 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:02 [root] WARNING: 4
2015-09-30 06:01:02 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T238&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:02 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:02 [root] WARNING: 5
2015-09-30 06:01:02 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T009&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:03 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S022&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 06:01:03 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:03 [root] WARNING: 6
2015-09-30 06:01:03 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S022&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 651, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 06:01:05 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P372&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 06:01:05 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:05 [root] WARNING: 7
2015-09-30 06:01:05 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P372&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:05 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P103&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 06:01:06 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:06 [root] WARNING: 8
2015-09-30 06:01:06 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P103&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:06 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T288&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 06:01:06 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:06 [root] WARNING: 9
2015-09-30 06:01:06 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T288&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:08 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P158&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 06:01:08 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:08 [root] WARNING: 10
2015-09-30 06:01:08 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P158&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 651, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 06:01:09 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P222&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 06:01:09 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T135&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 06:01:09 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:09 [root] WARNING: 11
2015-09-30 06:01:09 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P222&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:09 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:09 [root] WARNING: 12
2015-09-30 06:01:09 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T135&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:09 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P031&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 06:01:09 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:09 [root] WARNING: 13
2015-09-30 06:01:09 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P031&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:10 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S305&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 06:01:10 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:10 [root] WARNING: 14
2015-09-30 06:01:10 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S305&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:11 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S397&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 06:01:11 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:11 [root] WARNING: 15
2015-09-30 06:01:12 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S397&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:13 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 06:01:13 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:13 [root] WARNING: 16
2015-09-30 06:01:13 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:13 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S346&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 06:01:14 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:14 [root] WARNING: 17
2015-09-30 06:01:14 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S346&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:14 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P358&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 06:01:14 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:14 [root] WARNING: 18
2015-09-30 06:01:14 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P358&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:18 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S076&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 06:01:18 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P044&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 06:01:18 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:18 [root] WARNING: 19
2015-09-30 06:01:18 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S076&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:18 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:18 [root] WARNING: 20
2015-09-30 06:01:19 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P044&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:20 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 06:01:20 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:20 [root] WARNING: 21
2015-09-30 06:01:20 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:20 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S332&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 06:01:20 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:20 [root] WARNING: 22
2015-09-30 06:01:20 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S332&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:21 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S100&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 06:01:21 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:21 [root] WARNING: 23
2015-09-30 06:01:21 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S100&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:22 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P151&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 06:01:22 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:22 [root] WARNING: 24
2015-09-30 06:01:22 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P151&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 651, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 06:01:23 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S023&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 06:01:24 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:24 [root] WARNING: 25
2015-09-30 06:01:24 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S023&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:24 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T168&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 06:01:24 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:24 [root] WARNING: 26
2015-09-30 06:01:24 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T168&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:25 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S209&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 06:01:25 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:25 [root] WARNING: 27
2015-09-30 06:01:25 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S209&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:25 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S300&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 06:01:25 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:25 [root] WARNING: 28
2015-09-30 06:01:25 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S300&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 651, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 06:01:26 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N220&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 06:01:27 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:27 [root] WARNING: 29
2015-09-30 06:01:27 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N220&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:27 [scrapy] INFO: Crawled 42 pages (at 42 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 06:01:28 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T002&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 06:01:28 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:28 [root] WARNING: 30
2015-09-30 06:01:28 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T002&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:28 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 06:01:28 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:28 [root] WARNING: 31
2015-09-30 06:01:28 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:33 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P316&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 06:01:33 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:33 [root] WARNING: 32
2015-09-30 06:01:33 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P316&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:34 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T080&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 06:01:34 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:34 [root] WARNING: 33
2015-09-30 06:01:34 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T080&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:35 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S375&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 06:01:35 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M227&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 06:01:35 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:35 [root] WARNING: 34
2015-09-30 06:01:35 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S375&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:35 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:35 [root] WARNING: 35
2015-09-30 06:01:35 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M227&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:36 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V061&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 06:01:36 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:36 [root] WARNING: 36
2015-09-30 06:01:36 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V061&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:37 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T005&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 06:01:37 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:37 [root] WARNING: 37
2015-09-30 06:01:37 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T005&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:37 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T205&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 06:01:37 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:37 [root] WARNING: 38
2015-09-30 06:01:37 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T205&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:38 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 06:01:38 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:38 [root] WARNING: 39
2015-09-30 06:01:38 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:38 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T342&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 06:01:38 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:38 [root] WARNING: 40
2015-09-30 06:01:38 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T342&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:39 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V039&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 06:01:39 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N234&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 06:01:39 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:39 [root] WARNING: 41
2015-09-30 06:01:39 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V039&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:39 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:39 [root] WARNING: 42
2015-09-30 06:01:40 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N234&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 651, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 06:01:40 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T333&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 06:01:40 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:40 [root] WARNING: 43
2015-09-30 06:01:40 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T333&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:40 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N330&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 06:01:40 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:40 [root] WARNING: 44
2015-09-30 06:01:40 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N330&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 651, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 06:01:41 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T340&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 06:01:41 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:41 [root] WARNING: 45
2015-09-30 06:01:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T340&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:41 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 06:01:41 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:41 [root] WARNING: 46
2015-09-30 06:01:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:42 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 06:01:42 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:42 [root] WARNING: 47
2015-09-30 06:01:42 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:42 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P097&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 06:01:43 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:43 [root] WARNING: 48
2015-09-30 06:01:43 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P097&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 651, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 06:01:45 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S421&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 06:01:45 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:45 [root] WARNING: 49
2015-09-30 06:01:45 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S421&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:45 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N226&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 06:01:45 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:45 [root] WARNING: 50
2015-09-30 06:01:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N226&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T265&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 06:01:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T404&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 06:01:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:46 [root] WARNING: 51
2015-09-30 06:01:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T265&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:46 [root] WARNING: 52
2015-09-30 06:01:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T404&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T215&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 06:01:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:46 [root] WARNING: 53
2015-09-30 06:01:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T215&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T004&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 06:01:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:47 [root] WARNING: 54
2015-09-30 06:01:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T004&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 651, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 06:01:51 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P173&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 06:01:51 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N432&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 06:01:51 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:51 [root] WARNING: 55
2015-09-30 06:01:51 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P173&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 651, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 06:01:51 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:51 [root] WARNING: 56
2015-09-30 06:01:51 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N432&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 651, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 06:01:52 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 06:01:52 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:52 [root] WARNING: 57
2015-09-30 06:01:52 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:52 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N386&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 06:01:52 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 06:01:52 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:52 [root] WARNING: 58
2015-09-30 06:01:53 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N386&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 651, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 06:01:53 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:53 [root] WARNING: 59
2015-09-30 06:01:53 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:53 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S349&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 06:01:53 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:53 [root] WARNING: 60
2015-09-30 06:01:53 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S349&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:55 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T111&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 06:01:55 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:55 [root] WARNING: 61
2015-09-30 06:01:55 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T111&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:55 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S165&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 06:01:55 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:55 [root] WARNING: 62
2015-09-30 06:01:55 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S165&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:56 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 06:01:56 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:56 [root] WARNING: 63
2015-09-30 06:01:56 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:58 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T289&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 06:01:58 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S225&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 06:01:58 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 06:01:58 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:58 [root] WARNING: 64
2015-09-30 06:01:58 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T289&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:58 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:58 [root] WARNING: 65
2015-09-30 06:01:58 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S225&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:58 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:58 [root] WARNING: 66
2015-09-30 06:01:58 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:58 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 06:01:58 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S415&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 06:01:58 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:58 [root] WARNING: 67
2015-09-30 06:01:59 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 651, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 06:01:59 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:59 [root] WARNING: 68
2015-09-30 06:01:59 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S415&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:01:59 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T379&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 06:01:59 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:01:59 [root] WARNING: 69
2015-09-30 06:01:59 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T379&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:02:00 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N419&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 06:02:00 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:02:00 [root] WARNING: 70
2015-09-30 06:02:00 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N419&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 651, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 06:02:00 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T050&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 06:02:00 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:02:00 [root] WARNING: 71
2015-09-30 06:02:00 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T050&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:02:02 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S394&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 06:02:02 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:02:02 [root] WARNING: 72
2015-09-30 06:02:02 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S394&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:02:02 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T129&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 06:02:02 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S275&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 06:02:02 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:02:02 [root] WARNING: 73
2015-09-30 06:02:02 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T129&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:02:02 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:02:02 [root] WARNING: 74
2015-09-30 06:02:03 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S275&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:02:04 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T235&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 06:02:04 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:02:04 [root] WARNING: 75
2015-09-30 06:02:04 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T235&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:02:05 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 06:02:05 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:02:05 [root] WARNING: 76
2015-09-30 06:02:05 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:02:07 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 06:02:07 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 06:02:07 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:02:07 [root] WARNING: 77
2015-09-30 06:02:07 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:02:07 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:02:07 [root] WARNING: 78
2015-09-30 06:02:08 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 651, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 06:02:13 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N297&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 06:02:13 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 06:02:13 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:02:13 [root] WARNING: 79
2015-09-30 06:02:14 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N297&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:02:14 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:02:14 [root] WARNING: 80
2015-09-30 06:02:14 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 651, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 06:02:14 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N236&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 06:02:14 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:02:14 [root] WARNING: 81
2015-09-30 06:02:14 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N236&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:02:15 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P195&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 06:02:15 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N171&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 06:02:15 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:02:15 [root] WARNING: 82
2015-09-30 06:02:15 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P195&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 651, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 06:02:15 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:02:15 [root] WARNING: 83
2015-09-30 06:02:15 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N171&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:02:17 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 06:02:17 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:02:17 [root] WARNING: 84
2015-09-30 06:02:17 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 651, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 06:02:18 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P180&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 06:02:18 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:02:18 [root] WARNING: 85
2015-09-30 06:02:18 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P180&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 651, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 06:02:19 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N434&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 06:02:19 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:02:19 [root] WARNING: 86
2015-09-30 06:02:19 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N434&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:02:19 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T257&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 06:02:19 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:02:19 [root] WARNING: 87
2015-09-30 06:02:19 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T257&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 788, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 06:02:21 [scrapy] INFO: Received SIGINT, shutting down gracefully. Send again to force 
2015-09-30 06:02:21 [scrapy] INFO: Closing spider (shutdown)
2015-09-30 06:02:21 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T256&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 06:02:21 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:02:21 [root] WARNING: 88
2015-09-30 06:02:21 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T256&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 651, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 06:02:21 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 06:02:21 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 06:02:21 [root] WARNING: 89
2015-09-30 06:02:21 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 651, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 06:02:21 [scrapy] INFO: Received SIGINT twice, forcing unclean shutdown
2015-09-30 06:02:21 [scrapy] DEBUG: Retrying <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M199&Option=1#htop> (failed 1 times): [<twisted.python.failure.Failure <class 'twisted.internet.error.ConnectionLost'>>, <twisted.python.failure.Failure <class 'twisted.web.http._DataLoss'>>]
2015-09-30 06:02:21 [scrapy] DEBUG: Retrying <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S296&Option=1#htop> (failed 1 times): [<twisted.python.failure.Failure <class 'twisted.internet.error.ConnectionLost'>>, <twisted.python.failure.Failure <class 'twisted.web.http._DataLoss'>>]
2015-09-30 06:02:21 [scrapy] DEBUG: Retrying <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P111&Option=1#htop> (failed 1 times): [<twisted.python.failure.Failure <class 'twisted.internet.error.ConnectionLost'>>, <twisted.python.failure.Failure <class 'twisted.web.http._DataLoss'>>]
2015-09-30 06:02:21 [scrapy] DEBUG: Retrying <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T093&Option=1#htop> (failed 1 times): [<twisted.python.failure.Failure <class 'twisted.internet.error.ConnectionLost'>>, <twisted.python.failure.Failure <class 'twisted.web.http._DataLoss'>>]
2015-09-30 07:04:15 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 07:04:15 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 07:04:15 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 07:04:15 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 07:04:15 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 07:04:15 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 07:04:15 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 07:04:15 [scrapy] INFO: Spider opened
2015-09-30 07:04:15 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 07:04:15 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 07:04:17 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 07:04:21 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 07:04:26 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 07:04:30 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 07:04:32 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 07:04:32 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 07:04:36 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:04:36 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 509, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:04:38 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:04:38 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 509, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:04:41 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:04:41 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 509, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:04:43 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:04:43 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 509, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:04:44 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:04:44 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 509, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:04:44 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:04:45 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 509, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:04:45 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:04:45 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 509, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:04:46 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:04:46 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 509, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:04:46 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:04:47 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 509, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:04:47 [scrapy] INFO: Closing spider (finished)
2015-09-30 07:04:47 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 5227,
 'downloader/request_count': 14,
 'downloader/request_method_count/GET': 13,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 396845,
 'downloader/response_count': 14,
 'downloader/response_status_count/200': 13,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 7, 4, 47, 54277),
 'log_count/DEBUG': 16,
 'log_count/ERROR': 9,
 'log_count/INFO': 7,
 'request_depth_max': 4,
 'response_received_count': 13,
 'scheduler/dequeued': 14,
 'scheduler/dequeued/memory': 14,
 'scheduler/enqueued': 14,
 'scheduler/enqueued/memory': 14,
 'spider_exceptions/AssertionError': 9,
 'start_time': datetime.datetime(2015, 9, 30, 7, 4, 15, 577324)}
2015-09-30 07:04:47 [scrapy] INFO: Spider closed (finished)
2015-09-30 07:06:32 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 07:06:32 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 07:06:32 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 07:06:32 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 07:06:32 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 07:06:32 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 07:06:32 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 07:06:32 [scrapy] INFO: Spider opened
2015-09-30 07:06:32 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 07:06:32 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 07:06:35 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 07:06:38 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 07:06:44 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 07:06:47 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 07:06:49 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 07:06:49 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 07:06:56 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:06:56 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 509, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:06:58 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:06:59 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 509, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:07:01 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:07:01 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 509, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:07:02 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:07:02 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 509, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:07:04 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:07:04 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 509, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:07:04 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:07:04 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 509, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:07:06 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:07:06 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 509, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:07:07 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:07:07 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 509, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:07:07 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:07:07 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 509, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:07:07 [scrapy] INFO: Closing spider (finished)
2015-09-30 07:07:07 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 5227,
 'downloader/request_count': 14,
 'downloader/request_method_count/GET': 13,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 396900,
 'downloader/response_count': 14,
 'downloader/response_status_count/200': 13,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 7, 7, 7, 494316),
 'log_count/DEBUG': 16,
 'log_count/ERROR': 9,
 'log_count/INFO': 7,
 'request_depth_max': 4,
 'response_received_count': 13,
 'scheduler/dequeued': 14,
 'scheduler/dequeued/memory': 14,
 'scheduler/enqueued': 14,
 'scheduler/enqueued/memory': 14,
 'spider_exceptions/AssertionError': 9,
 'start_time': datetime.datetime(2015, 9, 30, 7, 6, 32, 611854)}
2015-09-30 07:07:07 [scrapy] INFO: Spider closed (finished)
2015-09-30 07:25:05 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 07:25:05 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 07:25:05 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 07:25:06 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 07:25:06 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 07:25:06 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 07:25:06 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 07:25:06 [scrapy] INFO: Spider opened
2015-09-30 07:25:06 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 07:25:06 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 07:25:07 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 07:25:09 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 07:25:15 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 07:25:18 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 07:25:21 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 07:25:21 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 07:25:28 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:25:28 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 484, in parse_hkjc_racecard
    _going = getgoingabb(_going)
NameError: global name 'getgoingabb' is not defined
2015-09-30 07:25:31 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:25:31 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 484, in parse_hkjc_racecard
    _going = getgoingabb(_going)
NameError: global name 'getgoingabb' is not defined
2015-09-30 07:25:34 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:25:34 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 484, in parse_hkjc_racecard
    _going = getgoingabb(_going)
NameError: global name 'getgoingabb' is not defined
2015-09-30 07:25:36 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:25:36 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 484, in parse_hkjc_racecard
    _going = getgoingabb(_going)
NameError: global name 'getgoingabb' is not defined
2015-09-30 07:25:36 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:25:36 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 484, in parse_hkjc_racecard
    _going = getgoingabb(_going)
NameError: global name 'getgoingabb' is not defined
2015-09-30 07:25:37 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:25:37 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 484, in parse_hkjc_racecard
    _going = getgoingabb(_going)
NameError: global name 'getgoingabb' is not defined
2015-09-30 07:25:38 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:25:38 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 484, in parse_hkjc_racecard
    _going = getgoingabb(_going)
NameError: global name 'getgoingabb' is not defined
2015-09-30 07:25:38 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:25:38 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 484, in parse_hkjc_racecard
    _going = getgoingabb(_going)
NameError: global name 'getgoingabb' is not defined
2015-09-30 07:25:38 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:25:38 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 484, in parse_hkjc_racecard
    _going = getgoingabb(_going)
NameError: global name 'getgoingabb' is not defined
2015-09-30 07:25:38 [scrapy] INFO: Closing spider (finished)
2015-09-30 07:25:38 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 5227,
 'downloader/request_count': 14,
 'downloader/request_method_count/GET': 13,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 396804,
 'downloader/response_count': 14,
 'downloader/response_status_count/200': 13,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 7, 25, 38, 928500),
 'log_count/DEBUG': 16,
 'log_count/ERROR': 9,
 'log_count/INFO': 7,
 'request_depth_max': 4,
 'response_received_count': 13,
 'scheduler/dequeued': 14,
 'scheduler/dequeued/memory': 14,
 'scheduler/enqueued': 14,
 'scheduler/enqueued/memory': 14,
 'spider_exceptions/NameError': 9,
 'start_time': datetime.datetime(2015, 9, 30, 7, 25, 6, 95856)}
2015-09-30 07:25:38 [scrapy] INFO: Spider closed (finished)
2015-09-30 07:25:56 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 07:25:56 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 07:25:56 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 07:25:56 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 07:25:56 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 07:25:56 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 07:25:56 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 07:25:56 [scrapy] INFO: Spider opened
2015-09-30 07:25:56 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 07:25:56 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 07:25:59 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 07:26:04 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 07:26:10 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 07:26:13 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 07:26:15 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 07:26:16 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 07:26:21 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:26:21 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 484, in parse_hkjc_racecard
    _going = get_goingabb(_going)
NameError: global name 'get_goingabb' is not defined
2015-09-30 07:26:23 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:26:24 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 484, in parse_hkjc_racecard
    _going = get_goingabb(_going)
NameError: global name 'get_goingabb' is not defined
2015-09-30 07:26:25 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:26:25 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 484, in parse_hkjc_racecard
    _going = get_goingabb(_going)
NameError: global name 'get_goingabb' is not defined
2015-09-30 07:26:27 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:26:27 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 484, in parse_hkjc_racecard
    _going = get_goingabb(_going)
NameError: global name 'get_goingabb' is not defined
2015-09-30 07:26:28 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:26:29 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 484, in parse_hkjc_racecard
    _going = get_goingabb(_going)
NameError: global name 'get_goingabb' is not defined
2015-09-30 07:26:29 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:26:29 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 484, in parse_hkjc_racecard
    _going = get_goingabb(_going)
NameError: global name 'get_goingabb' is not defined
2015-09-30 07:26:29 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:26:29 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 484, in parse_hkjc_racecard
    _going = get_goingabb(_going)
NameError: global name 'get_goingabb' is not defined
2015-09-30 07:26:30 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:26:30 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 484, in parse_hkjc_racecard
    _going = get_goingabb(_going)
NameError: global name 'get_goingabb' is not defined
2015-09-30 07:26:31 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:26:31 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 484, in parse_hkjc_racecard
    _going = get_goingabb(_going)
NameError: global name 'get_goingabb' is not defined
2015-09-30 07:26:31 [scrapy] INFO: Closing spider (finished)
2015-09-30 07:26:31 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 5227,
 'downloader/request_count': 14,
 'downloader/request_method_count/GET': 13,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 396860,
 'downloader/response_count': 14,
 'downloader/response_status_count/200': 13,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 7, 26, 31, 331172),
 'log_count/DEBUG': 16,
 'log_count/ERROR': 9,
 'log_count/INFO': 7,
 'request_depth_max': 4,
 'response_received_count': 13,
 'scheduler/dequeued': 14,
 'scheduler/dequeued/memory': 14,
 'scheduler/enqueued': 14,
 'scheduler/enqueued/memory': 14,
 'spider_exceptions/NameError': 9,
 'start_time': datetime.datetime(2015, 9, 30, 7, 25, 56, 565199)}
2015-09-30 07:26:31 [scrapy] INFO: Spider closed (finished)
2015-09-30 07:27:48 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 07:27:48 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 07:27:48 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 07:27:48 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 07:27:48 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 07:27:48 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 07:27:48 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 07:27:48 [scrapy] INFO: Spider opened
2015-09-30 07:27:48 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 07:27:48 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 07:27:50 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 07:27:52 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 07:27:59 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 07:28:02 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 07:28:04 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 07:28:04 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 07:28:11 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:28:11 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 484, in parse_hkjc_racecard
    _going = get_goingabb(_going,_surface)
NameError: global name 'get_goingabb' is not defined
2015-09-30 07:28:14 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:28:14 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 484, in parse_hkjc_racecard
    _going = get_goingabb(_going,_surface)
NameError: global name 'get_goingabb' is not defined
2015-09-30 07:28:17 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:28:17 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 484, in parse_hkjc_racecard
    _going = get_goingabb(_going,_surface)
NameError: global name 'get_goingabb' is not defined
2015-09-30 07:28:18 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:28:18 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 484, in parse_hkjc_racecard
    _going = get_goingabb(_going,_surface)
NameError: global name 'get_goingabb' is not defined
2015-09-30 07:28:19 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:28:19 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 484, in parse_hkjc_racecard
    _going = get_goingabb(_going,_surface)
NameError: global name 'get_goingabb' is not defined
2015-09-30 07:28:20 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:28:20 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 484, in parse_hkjc_racecard
    _going = get_goingabb(_going,_surface)
NameError: global name 'get_goingabb' is not defined
2015-09-30 07:28:21 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:28:21 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 484, in parse_hkjc_racecard
    _going = get_goingabb(_going,_surface)
NameError: global name 'get_goingabb' is not defined
2015-09-30 07:28:21 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:28:21 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 484, in parse_hkjc_racecard
    _going = get_goingabb(_going,_surface)
NameError: global name 'get_goingabb' is not defined
2015-09-30 07:28:24 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:28:24 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 484, in parse_hkjc_racecard
    _going = get_goingabb(_going,_surface)
NameError: global name 'get_goingabb' is not defined
2015-09-30 07:28:24 [scrapy] INFO: Closing spider (finished)
2015-09-30 07:28:24 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 5227,
 'downloader/request_count': 14,
 'downloader/request_method_count/GET': 13,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 396806,
 'downloader/response_count': 14,
 'downloader/response_status_count/200': 13,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 7, 28, 24, 347255),
 'log_count/DEBUG': 16,
 'log_count/ERROR': 9,
 'log_count/INFO': 7,
 'request_depth_max': 4,
 'response_received_count': 13,
 'scheduler/dequeued': 14,
 'scheduler/dequeued/memory': 14,
 'scheduler/enqueued': 14,
 'scheduler/enqueued/memory': 14,
 'spider_exceptions/NameError': 9,
 'start_time': datetime.datetime(2015, 9, 30, 7, 27, 48, 145724)}
2015-09-30 07:28:24 [scrapy] INFO: Spider closed (finished)
2015-09-30 07:29:02 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 07:29:02 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 07:29:02 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 07:29:02 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 07:29:02 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 07:29:02 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 07:29:02 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 07:29:02 [scrapy] INFO: Spider opened
2015-09-30 07:29:02 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 07:29:02 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 07:29:04 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 07:29:06 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 07:29:12 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 07:29:16 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 07:29:18 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 07:29:18 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 07:29:23 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:29:23 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 498, in parse_hkjc_racecard
    raceclass = getraceclass(prize_rating_class.split(u',')[-1])
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 231, in getraceclass
    return surfaces.get(unicode.strip(cl), "no rc")
NameError: global name 'surfaces' is not defined
2015-09-30 07:29:25 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:29:25 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 498, in parse_hkjc_racecard
    raceclass = getraceclass(prize_rating_class.split(u',')[-1])
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 231, in getraceclass
    return surfaces.get(unicode.strip(cl), "no rc")
NameError: global name 'surfaces' is not defined
2015-09-30 07:29:27 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:29:27 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 498, in parse_hkjc_racecard
    raceclass = getraceclass(prize_rating_class.split(u',')[-1])
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 231, in getraceclass
    return surfaces.get(unicode.strip(cl), "no rc")
NameError: global name 'surfaces' is not defined
2015-09-30 07:29:28 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:29:28 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 498, in parse_hkjc_racecard
    raceclass = getraceclass(prize_rating_class.split(u',')[-1])
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 231, in getraceclass
    return surfaces.get(unicode.strip(cl), "no rc")
NameError: global name 'surfaces' is not defined
2015-09-30 07:29:29 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:29:29 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 498, in parse_hkjc_racecard
    raceclass = getraceclass(prize_rating_class.split(u',')[-1])
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 231, in getraceclass
    return surfaces.get(unicode.strip(cl), "no rc")
NameError: global name 'surfaces' is not defined
2015-09-30 07:29:31 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:29:31 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 498, in parse_hkjc_racecard
    raceclass = getraceclass(prize_rating_class.split(u',')[-1])
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 231, in getraceclass
    return surfaces.get(unicode.strip(cl), "no rc")
NameError: global name 'surfaces' is not defined
2015-09-30 07:29:31 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:29:32 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 498, in parse_hkjc_racecard
    raceclass = getraceclass(prize_rating_class.split(u',')[-1])
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 231, in getraceclass
    return surfaces.get(unicode.strip(cl), "no rc")
NameError: global name 'surfaces' is not defined
2015-09-30 07:29:32 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:29:32 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:29:32 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 498, in parse_hkjc_racecard
    raceclass = getraceclass(prize_rating_class.split(u',')[-1])
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 231, in getraceclass
    return surfaces.get(unicode.strip(cl), "no rc")
NameError: global name 'surfaces' is not defined
2015-09-30 07:29:32 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 498, in parse_hkjc_racecard
    raceclass = getraceclass(prize_rating_class.split(u',')[-1])
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 231, in getraceclass
    return surfaces.get(unicode.strip(cl), "no rc")
NameError: global name 'surfaces' is not defined
2015-09-30 07:29:32 [scrapy] INFO: Closing spider (finished)
2015-09-30 07:29:32 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 5227,
 'downloader/request_count': 14,
 'downloader/request_method_count/GET': 13,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 396880,
 'downloader/response_count': 14,
 'downloader/response_status_count/200': 13,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 7, 29, 32, 406802),
 'log_count/DEBUG': 16,
 'log_count/ERROR': 9,
 'log_count/INFO': 7,
 'request_depth_max': 4,
 'response_received_count': 13,
 'scheduler/dequeued': 14,
 'scheduler/dequeued/memory': 14,
 'scheduler/enqueued': 14,
 'scheduler/enqueued/memory': 14,
 'spider_exceptions/NameError': 9,
 'start_time': datetime.datetime(2015, 9, 30, 7, 29, 2, 461143)}
2015-09-30 07:29:32 [scrapy] INFO: Spider closed (finished)
2015-09-30 07:33:06 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 07:33:06 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 07:33:06 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 07:33:06 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 07:33:06 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 07:33:06 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 07:33:06 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 07:33:06 [scrapy] INFO: Spider opened
2015-09-30 07:33:06 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 07:33:06 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 07:33:08 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 07:33:12 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 07:33:19 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 07:33:23 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 07:33:26 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 07:33:26 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 07:33:32 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:33:32 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 482, in parse_hkjc_racecard
    raceclass = get_raceclass(prize_rating_class.split(u',')[-1])
NameError: global name 'get_raceclass' is not defined
2015-09-30 07:33:34 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:33:34 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 482, in parse_hkjc_racecard
    raceclass = get_raceclass(prize_rating_class.split(u',')[-1])
NameError: global name 'get_raceclass' is not defined
2015-09-30 07:33:37 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:33:37 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 482, in parse_hkjc_racecard
    raceclass = get_raceclass(prize_rating_class.split(u',')[-1])
NameError: global name 'get_raceclass' is not defined
2015-09-30 07:33:39 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:33:39 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 482, in parse_hkjc_racecard
    raceclass = get_raceclass(prize_rating_class.split(u',')[-1])
NameError: global name 'get_raceclass' is not defined
2015-09-30 07:33:40 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:33:40 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:33:40 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 482, in parse_hkjc_racecard
    raceclass = get_raceclass(prize_rating_class.split(u',')[-1])
NameError: global name 'get_raceclass' is not defined
2015-09-30 07:33:40 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 482, in parse_hkjc_racecard
    raceclass = get_raceclass(prize_rating_class.split(u',')[-1])
NameError: global name 'get_raceclass' is not defined
2015-09-30 07:33:42 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:33:42 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 482, in parse_hkjc_racecard
    raceclass = get_raceclass(prize_rating_class.split(u',')[-1])
NameError: global name 'get_raceclass' is not defined
2015-09-30 07:33:42 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:33:43 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 482, in parse_hkjc_racecard
    raceclass = get_raceclass(prize_rating_class.split(u',')[-1])
NameError: global name 'get_raceclass' is not defined
2015-09-30 07:33:43 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:33:43 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 482, in parse_hkjc_racecard
    raceclass = get_raceclass(prize_rating_class.split(u',')[-1])
NameError: global name 'get_raceclass' is not defined
2015-09-30 07:33:43 [scrapy] INFO: Closing spider (finished)
2015-09-30 07:33:43 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 5227,
 'downloader/request_count': 14,
 'downloader/request_method_count/GET': 13,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 396855,
 'downloader/response_count': 14,
 'downloader/response_status_count/200': 13,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 7, 33, 43, 606006),
 'log_count/DEBUG': 16,
 'log_count/ERROR': 9,
 'log_count/INFO': 7,
 'request_depth_max': 4,
 'response_received_count': 13,
 'scheduler/dequeued': 14,
 'scheduler/dequeued/memory': 14,
 'scheduler/enqueued': 14,
 'scheduler/enqueued/memory': 14,
 'spider_exceptions/NameError': 9,
 'start_time': datetime.datetime(2015, 9, 30, 7, 33, 6, 407265)}
2015-09-30 07:33:43 [scrapy] INFO: Spider closed (finished)
2015-09-30 07:35:28 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 07:35:28 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 07:35:28 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 07:35:28 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 07:35:28 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 07:35:28 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 07:35:28 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 07:35:28 [scrapy] INFO: Spider opened
2015-09-30 07:35:28 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 07:35:28 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 07:35:31 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 07:35:35 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 07:35:44 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 07:35:48 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 07:35:51 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 07:35:51 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 07:35:55 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:35:55 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 447, in parse_hkjc_racecard
    surface = get_surface(_trackvariant)
NameError: global name 'get_surface' is not defined
2015-09-30 07:35:57 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:35:57 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 447, in parse_hkjc_racecard
    surface = get_surface(_trackvariant)
NameError: global name 'get_surface' is not defined
2015-09-30 07:36:00 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:36:00 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 447, in parse_hkjc_racecard
    surface = get_surface(_trackvariant)
NameError: global name 'get_surface' is not defined
2015-09-30 07:36:00 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:36:01 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 447, in parse_hkjc_racecard
    surface = get_surface(_trackvariant)
NameError: global name 'get_surface' is not defined
2015-09-30 07:36:01 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:36:01 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 447, in parse_hkjc_racecard
    surface = get_surface(_trackvariant)
NameError: global name 'get_surface' is not defined
2015-09-30 07:36:02 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:36:02 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 447, in parse_hkjc_racecard
    surface = get_surface(_trackvariant)
NameError: global name 'get_surface' is not defined
2015-09-30 07:36:03 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:36:03 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 447, in parse_hkjc_racecard
    surface = get_surface(_trackvariant)
NameError: global name 'get_surface' is not defined
2015-09-30 07:36:03 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:36:03 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 447, in parse_hkjc_racecard
    surface = get_surface(_trackvariant)
NameError: global name 'get_surface' is not defined
2015-09-30 07:36:04 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:36:04 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 447, in parse_hkjc_racecard
    surface = get_surface(_trackvariant)
NameError: global name 'get_surface' is not defined
2015-09-30 07:36:04 [scrapy] INFO: Closing spider (finished)
2015-09-30 07:36:04 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 5227,
 'downloader/request_count': 14,
 'downloader/request_method_count/GET': 13,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 396806,
 'downloader/response_count': 14,
 'downloader/response_status_count/200': 13,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 7, 36, 4, 793864),
 'log_count/DEBUG': 16,
 'log_count/ERROR': 9,
 'log_count/INFO': 7,
 'request_depth_max': 4,
 'response_received_count': 13,
 'scheduler/dequeued': 14,
 'scheduler/dequeued/memory': 14,
 'scheduler/enqueued': 14,
 'scheduler/enqueued/memory': 14,
 'spider_exceptions/NameError': 9,
 'start_time': datetime.datetime(2015, 9, 30, 7, 35, 28, 984477)}
2015-09-30 07:36:04 [scrapy] INFO: Spider closed (finished)
2015-09-30 07:36:22 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 07:36:22 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 07:36:22 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 07:36:22 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 07:36:22 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 07:36:22 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 07:36:22 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 07:36:22 [scrapy] INFO: Spider opened
2015-09-30 07:36:22 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 07:36:22 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 07:36:24 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 07:36:26 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 07:36:32 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 07:36:37 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 07:36:39 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 07:36:39 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 07:36:42 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:36:42 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 458, in parse_hkjc_racecard
    raceclass = get_raceclass(prize_rating_class.split(u',')[-1])
NameError: global name 'get_raceclass' is not defined
2015-09-30 07:36:44 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:36:44 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 458, in parse_hkjc_racecard
    raceclass = get_raceclass(prize_rating_class.split(u',')[-1])
NameError: global name 'get_raceclass' is not defined
2015-09-30 07:36:46 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:36:46 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 458, in parse_hkjc_racecard
    raceclass = get_raceclass(prize_rating_class.split(u',')[-1])
NameError: global name 'get_raceclass' is not defined
2015-09-30 07:36:47 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:36:47 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 458, in parse_hkjc_racecard
    raceclass = get_raceclass(prize_rating_class.split(u',')[-1])
NameError: global name 'get_raceclass' is not defined
2015-09-30 07:36:49 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:36:49 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 458, in parse_hkjc_racecard
    raceclass = get_raceclass(prize_rating_class.split(u',')[-1])
NameError: global name 'get_raceclass' is not defined
2015-09-30 07:36:49 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:36:49 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 458, in parse_hkjc_racecard
    raceclass = get_raceclass(prize_rating_class.split(u',')[-1])
NameError: global name 'get_raceclass' is not defined
2015-09-30 07:36:50 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:36:50 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 458, in parse_hkjc_racecard
    raceclass = get_raceclass(prize_rating_class.split(u',')[-1])
NameError: global name 'get_raceclass' is not defined
2015-09-30 07:36:52 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:36:52 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 458, in parse_hkjc_racecard
    raceclass = get_raceclass(prize_rating_class.split(u',')[-1])
NameError: global name 'get_raceclass' is not defined
2015-09-30 07:36:52 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:36:52 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 458, in parse_hkjc_racecard
    raceclass = get_raceclass(prize_rating_class.split(u',')[-1])
NameError: global name 'get_raceclass' is not defined
2015-09-30 07:36:52 [scrapy] INFO: Closing spider (finished)
2015-09-30 07:36:52 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 5227,
 'downloader/request_count': 14,
 'downloader/request_method_count/GET': 13,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 396924,
 'downloader/response_count': 14,
 'downloader/response_status_count/200': 13,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 7, 36, 52, 987322),
 'log_count/DEBUG': 16,
 'log_count/ERROR': 9,
 'log_count/INFO': 7,
 'request_depth_max': 4,
 'response_received_count': 13,
 'scheduler/dequeued': 14,
 'scheduler/dequeued/memory': 14,
 'scheduler/enqueued': 14,
 'scheduler/enqueued/memory': 14,
 'spider_exceptions/NameError': 9,
 'start_time': datetime.datetime(2015, 9, 30, 7, 36, 22, 814980)}
2015-09-30 07:36:52 [scrapy] INFO: Spider closed (finished)
2015-09-30 07:37:27 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 07:37:27 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 07:37:27 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 07:37:27 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 07:37:27 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 07:37:27 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 07:37:27 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 07:37:27 [scrapy] INFO: Spider opened
2015-09-30 07:37:27 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 07:37:27 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 07:37:29 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 07:37:31 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 07:37:38 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 07:37:40 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 07:37:42 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 07:37:42 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 07:37:48 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:37:48 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 458, in parse_hkjc_racecard
    raceclass = hkjc_utilities.get_raceclass(prize_rating_class.split(u',')[-1])
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 13, in get_raceclass
    return hkjcclasses.get(d, "None")
NameError: global name 'd' is not defined
2015-09-30 07:37:51 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:37:51 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 458, in parse_hkjc_racecard
    raceclass = hkjc_utilities.get_raceclass(prize_rating_class.split(u',')[-1])
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 13, in get_raceclass
    return hkjcclasses.get(d, "None")
NameError: global name 'd' is not defined
2015-09-30 07:37:53 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:37:53 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 458, in parse_hkjc_racecard
    raceclass = hkjc_utilities.get_raceclass(prize_rating_class.split(u',')[-1])
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 13, in get_raceclass
    return hkjcclasses.get(d, "None")
NameError: global name 'd' is not defined
2015-09-30 07:37:55 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:37:55 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 458, in parse_hkjc_racecard
    raceclass = hkjc_utilities.get_raceclass(prize_rating_class.split(u',')[-1])
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 13, in get_raceclass
    return hkjcclasses.get(d, "None")
NameError: global name 'd' is not defined
2015-09-30 07:37:56 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:37:56 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:37:56 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 458, in parse_hkjc_racecard
    raceclass = hkjc_utilities.get_raceclass(prize_rating_class.split(u',')[-1])
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 13, in get_raceclass
    return hkjcclasses.get(d, "None")
NameError: global name 'd' is not defined
2015-09-30 07:37:56 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 458, in parse_hkjc_racecard
    raceclass = hkjc_utilities.get_raceclass(prize_rating_class.split(u',')[-1])
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 13, in get_raceclass
    return hkjcclasses.get(d, "None")
NameError: global name 'd' is not defined
2015-09-30 07:37:57 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:37:57 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 458, in parse_hkjc_racecard
    raceclass = hkjc_utilities.get_raceclass(prize_rating_class.split(u',')[-1])
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 13, in get_raceclass
    return hkjcclasses.get(d, "None")
NameError: global name 'd' is not defined
2015-09-30 07:37:58 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:37:58 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 458, in parse_hkjc_racecard
    raceclass = hkjc_utilities.get_raceclass(prize_rating_class.split(u',')[-1])
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 13, in get_raceclass
    return hkjcclasses.get(d, "None")
NameError: global name 'd' is not defined
2015-09-30 07:37:58 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:37:58 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 458, in parse_hkjc_racecard
    raceclass = hkjc_utilities.get_raceclass(prize_rating_class.split(u',')[-1])
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 13, in get_raceclass
    return hkjcclasses.get(d, "None")
NameError: global name 'd' is not defined
2015-09-30 07:37:58 [scrapy] INFO: Closing spider (finished)
2015-09-30 07:37:58 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 5227,
 'downloader/request_count': 14,
 'downloader/request_method_count/GET': 13,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 396807,
 'downloader/response_count': 14,
 'downloader/response_status_count/200': 13,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 7, 37, 58, 685912),
 'log_count/DEBUG': 16,
 'log_count/ERROR': 9,
 'log_count/INFO': 7,
 'request_depth_max': 4,
 'response_received_count': 13,
 'scheduler/dequeued': 14,
 'scheduler/dequeued/memory': 14,
 'scheduler/enqueued': 14,
 'scheduler/enqueued/memory': 14,
 'spider_exceptions/NameError': 9,
 'start_time': datetime.datetime(2015, 9, 30, 7, 37, 27, 282714)}
2015-09-30 07:37:58 [scrapy] INFO: Spider closed (finished)
2015-09-30 07:38:44 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 07:38:44 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 07:38:44 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 07:38:44 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 07:38:44 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 07:38:44 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 07:38:44 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 07:38:44 [scrapy] INFO: Spider opened
2015-09-30 07:38:44 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 07:38:44 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 07:38:47 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 07:38:50 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 07:38:54 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 07:38:59 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 07:39:00 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 07:39:01 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 07:39:07 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:39:08 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 471, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:39:11 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:39:11 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 471, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:39:12 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:39:13 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 471, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:39:15 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:39:15 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 471, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:39:16 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:39:16 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 471, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:39:16 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:39:16 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 471, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:39:18 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:39:18 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 471, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:39:19 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:39:19 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 471, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:39:20 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:39:20 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 471, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:39:20 [scrapy] INFO: Closing spider (finished)
2015-09-30 07:39:20 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 5227,
 'downloader/request_count': 14,
 'downloader/request_method_count/GET': 13,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 396921,
 'downloader/response_count': 14,
 'downloader/response_status_count/200': 13,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 7, 39, 20, 893142),
 'log_count/DEBUG': 16,
 'log_count/ERROR': 9,
 'log_count/INFO': 7,
 'request_depth_max': 4,
 'response_received_count': 13,
 'scheduler/dequeued': 14,
 'scheduler/dequeued/memory': 14,
 'scheduler/enqueued': 14,
 'scheduler/enqueued/memory': 14,
 'spider_exceptions/AssertionError': 9,
 'start_time': datetime.datetime(2015, 9, 30, 7, 38, 44, 631810)}
2015-09-30 07:39:20 [scrapy] INFO: Spider closed (finished)
2015-09-30 07:40:04 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 07:40:04 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 07:40:04 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 07:40:05 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 07:40:05 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 07:40:05 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 07:40:05 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 07:40:05 [scrapy] INFO: Spider opened
2015-09-30 07:40:05 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 07:40:05 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 07:40:07 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 07:40:10 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 07:40:15 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 07:40:19 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 07:40:21 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 07:40:21 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 07:40:26 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:40:26 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 471, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:40:26 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:40:26 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 471, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:40:30 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:40:30 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 471, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:40:32 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:40:32 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 471, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:40:33 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:40:33 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 471, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:40:34 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:40:34 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 471, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:40:34 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:40:34 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 471, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:40:35 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:40:35 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 471, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:40:37 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:40:37 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 471, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:40:37 [scrapy] INFO: Closing spider (finished)
2015-09-30 07:40:37 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 5227,
 'downloader/request_count': 14,
 'downloader/request_method_count/GET': 13,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 396855,
 'downloader/response_count': 14,
 'downloader/response_status_count/200': 13,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 7, 40, 37, 212061),
 'log_count/DEBUG': 16,
 'log_count/ERROR': 9,
 'log_count/INFO': 7,
 'request_depth_max': 4,
 'response_received_count': 13,
 'scheduler/dequeued': 14,
 'scheduler/dequeued/memory': 14,
 'scheduler/enqueued': 14,
 'scheduler/enqueued/memory': 14,
 'spider_exceptions/AssertionError': 9,
 'start_time': datetime.datetime(2015, 9, 30, 7, 40, 5, 89062)}
2015-09-30 07:40:37 [scrapy] INFO: Spider closed (finished)
2015-09-30 07:44:13 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 07:44:13 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 07:44:13 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 07:44:13 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 07:44:13 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 07:44:13 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 07:44:13 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 07:44:13 [scrapy] INFO: Spider opened
2015-09-30 07:44:13 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 07:44:13 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 07:44:14 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 07:44:18 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 07:44:23 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 07:44:25 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 07:44:27 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 07:44:27 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 07:44:33 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:44:33 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 458, in parse_hkjc_racecard
    _raceclass = unicode.strip(unicode.split(prize_rating_class.split(u',')[-1]))
TypeError: descriptor 'strip' requires a 'unicode' object but received a 'list'
2015-09-30 07:44:36 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:44:36 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 458, in parse_hkjc_racecard
    _raceclass = unicode.strip(unicode.split(prize_rating_class.split(u',')[-1]))
TypeError: descriptor 'strip' requires a 'unicode' object but received a 'list'
2015-09-30 07:44:39 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:44:39 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 458, in parse_hkjc_racecard
    _raceclass = unicode.strip(unicode.split(prize_rating_class.split(u',')[-1]))
TypeError: descriptor 'strip' requires a 'unicode' object but received a 'list'
2015-09-30 07:44:41 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:44:41 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 458, in parse_hkjc_racecard
    _raceclass = unicode.strip(unicode.split(prize_rating_class.split(u',')[-1]))
TypeError: descriptor 'strip' requires a 'unicode' object but received a 'list'
2015-09-30 07:44:42 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:44:42 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 458, in parse_hkjc_racecard
    _raceclass = unicode.strip(unicode.split(prize_rating_class.split(u',')[-1]))
TypeError: descriptor 'strip' requires a 'unicode' object but received a 'list'
2015-09-30 07:44:44 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:44:44 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 458, in parse_hkjc_racecard
    _raceclass = unicode.strip(unicode.split(prize_rating_class.split(u',')[-1]))
TypeError: descriptor 'strip' requires a 'unicode' object but received a 'list'
2015-09-30 07:44:44 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:44:44 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 458, in parse_hkjc_racecard
    _raceclass = unicode.strip(unicode.split(prize_rating_class.split(u',')[-1]))
TypeError: descriptor 'strip' requires a 'unicode' object but received a 'list'
2015-09-30 07:44:45 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:44:45 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 458, in parse_hkjc_racecard
    _raceclass = unicode.strip(unicode.split(prize_rating_class.split(u',')[-1]))
TypeError: descriptor 'strip' requires a 'unicode' object but received a 'list'
2015-09-30 07:44:45 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:44:46 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 458, in parse_hkjc_racecard
    _raceclass = unicode.strip(unicode.split(prize_rating_class.split(u',')[-1]))
TypeError: descriptor 'strip' requires a 'unicode' object but received a 'list'
2015-09-30 07:44:46 [scrapy] INFO: Closing spider (finished)
2015-09-30 07:44:46 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 5227,
 'downloader/request_count': 14,
 'downloader/request_method_count/GET': 13,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 396776,
 'downloader/response_count': 14,
 'downloader/response_status_count/200': 13,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 7, 44, 46, 84375),
 'log_count/DEBUG': 16,
 'log_count/ERROR': 9,
 'log_count/INFO': 7,
 'request_depth_max': 4,
 'response_received_count': 13,
 'scheduler/dequeued': 14,
 'scheduler/dequeued/memory': 14,
 'scheduler/enqueued': 14,
 'scheduler/enqueued/memory': 14,
 'spider_exceptions/TypeError': 9,
 'start_time': datetime.datetime(2015, 9, 30, 7, 44, 13, 98017)}
2015-09-30 07:44:46 [scrapy] INFO: Spider closed (finished)
2015-09-30 07:46:19 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 07:46:19 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 07:46:19 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 07:46:19 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 07:46:19 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 07:46:19 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 07:46:19 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 07:46:19 [scrapy] INFO: Spider opened
2015-09-30 07:46:19 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 07:46:19 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 07:46:22 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 07:46:25 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 07:46:30 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 07:46:33 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 07:46:36 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 07:46:36 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 07:46:41 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:46:41 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 458, in parse_hkjc_racecard
    _raceclass = unicode.strip( unicode.split(prize_rating_class.split, u',')[-1] )
TypeError: descriptor 'split' requires a 'unicode' object but received a 'builtin_function_or_method'
2015-09-30 07:46:43 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:46:43 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 458, in parse_hkjc_racecard
    _raceclass = unicode.strip( unicode.split(prize_rating_class.split, u',')[-1] )
TypeError: descriptor 'split' requires a 'unicode' object but received a 'builtin_function_or_method'
2015-09-30 07:46:47 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:46:47 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 458, in parse_hkjc_racecard
    _raceclass = unicode.strip( unicode.split(prize_rating_class.split, u',')[-1] )
TypeError: descriptor 'split' requires a 'unicode' object but received a 'builtin_function_or_method'
2015-09-30 07:46:48 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:46:49 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 458, in parse_hkjc_racecard
    _raceclass = unicode.strip( unicode.split(prize_rating_class.split, u',')[-1] )
TypeError: descriptor 'split' requires a 'unicode' object but received a 'builtin_function_or_method'
2015-09-30 07:46:49 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:46:49 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 458, in parse_hkjc_racecard
    _raceclass = unicode.strip( unicode.split(prize_rating_class.split, u',')[-1] )
TypeError: descriptor 'split' requires a 'unicode' object but received a 'builtin_function_or_method'
2015-09-30 07:46:50 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:46:50 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 458, in parse_hkjc_racecard
    _raceclass = unicode.strip( unicode.split(prize_rating_class.split, u',')[-1] )
TypeError: descriptor 'split' requires a 'unicode' object but received a 'builtin_function_or_method'
2015-09-30 07:46:51 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:46:51 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 458, in parse_hkjc_racecard
    _raceclass = unicode.strip( unicode.split(prize_rating_class.split, u',')[-1] )
TypeError: descriptor 'split' requires a 'unicode' object but received a 'builtin_function_or_method'
2015-09-30 07:46:52 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:46:52 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 458, in parse_hkjc_racecard
    _raceclass = unicode.strip( unicode.split(prize_rating_class.split, u',')[-1] )
TypeError: descriptor 'split' requires a 'unicode' object but received a 'builtin_function_or_method'
2015-09-30 07:46:55 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:46:55 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 458, in parse_hkjc_racecard
    _raceclass = unicode.strip( unicode.split(prize_rating_class.split, u',')[-1] )
TypeError: descriptor 'split' requires a 'unicode' object but received a 'builtin_function_or_method'
2015-09-30 07:46:55 [scrapy] INFO: Closing spider (finished)
2015-09-30 07:46:55 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 5227,
 'downloader/request_count': 14,
 'downloader/request_method_count/GET': 13,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 396851,
 'downloader/response_count': 14,
 'downloader/response_status_count/200': 13,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 7, 46, 55, 750214),
 'log_count/DEBUG': 16,
 'log_count/ERROR': 9,
 'log_count/INFO': 7,
 'request_depth_max': 4,
 'response_received_count': 13,
 'scheduler/dequeued': 14,
 'scheduler/dequeued/memory': 14,
 'scheduler/enqueued': 14,
 'scheduler/enqueued/memory': 14,
 'spider_exceptions/TypeError': 9,
 'start_time': datetime.datetime(2015, 9, 30, 7, 46, 19, 983394)}
2015-09-30 07:46:55 [scrapy] INFO: Spider closed (finished)
2015-09-30 07:47:33 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 07:47:33 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 07:47:33 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 07:47:33 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 07:47:33 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 07:47:33 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 07:47:33 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 07:47:33 [scrapy] INFO: Spider opened
2015-09-30 07:47:33 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 07:47:33 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 07:47:35 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 07:47:39 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 07:47:45 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 07:47:50 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 07:47:53 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 07:47:54 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 07:47:56 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:47:56 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 472, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:48:02 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:48:02 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 472, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:48:03 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:48:03 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 472, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:48:04 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:48:04 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 472, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:48:06 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:48:06 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 472, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:48:07 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:48:07 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 472, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:48:07 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:48:07 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 472, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:48:08 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:48:08 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 472, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:48:08 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:48:09 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 472, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:48:09 [scrapy] INFO: Closing spider (finished)
2015-09-30 07:48:09 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 5227,
 'downloader/request_count': 14,
 'downloader/request_method_count/GET': 13,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 396809,
 'downloader/response_count': 14,
 'downloader/response_status_count/200': 13,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 7, 48, 9, 17575),
 'log_count/DEBUG': 16,
 'log_count/ERROR': 9,
 'log_count/INFO': 7,
 'request_depth_max': 4,
 'response_received_count': 13,
 'scheduler/dequeued': 14,
 'scheduler/dequeued/memory': 14,
 'scheduler/enqueued': 14,
 'scheduler/enqueued/memory': 14,
 'spider_exceptions/AssertionError': 9,
 'start_time': datetime.datetime(2015, 9, 30, 7, 47, 33, 802944)}
2015-09-30 07:48:09 [scrapy] INFO: Spider closed (finished)
2015-09-30 07:52:11 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 07:52:11 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 07:52:11 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 07:52:11 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 07:52:11 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 07:52:11 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 07:52:11 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 07:52:11 [scrapy] INFO: Spider opened
2015-09-30 07:52:11 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 07:52:11 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 07:52:13 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 07:52:17 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 07:52:21 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 07:52:25 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 07:52:29 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 07:52:29 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 07:52:36 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:52:36 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 473, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:52:38 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:52:38 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 473, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:52:42 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:52:42 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 473, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:52:42 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:52:42 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 473, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:52:45 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:52:45 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 473, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:52:46 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:52:46 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 473, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:52:46 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:52:47 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 473, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:52:48 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:52:48 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 473, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:52:49 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:52:49 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 473, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:52:49 [scrapy] INFO: Closing spider (finished)
2015-09-30 07:52:49 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 5227,
 'downloader/request_count': 14,
 'downloader/request_method_count/GET': 13,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 396919,
 'downloader/response_count': 14,
 'downloader/response_status_count/200': 13,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 7, 52, 49, 631517),
 'log_count/DEBUG': 16,
 'log_count/ERROR': 9,
 'log_count/INFO': 7,
 'request_depth_max': 4,
 'response_received_count': 13,
 'scheduler/dequeued': 14,
 'scheduler/dequeued/memory': 14,
 'scheduler/enqueued': 14,
 'scheduler/enqueued/memory': 14,
 'spider_exceptions/AssertionError': 9,
 'start_time': datetime.datetime(2015, 9, 30, 7, 52, 11, 403077)}
2015-09-30 07:52:49 [scrapy] INFO: Spider closed (finished)
2015-09-30 07:55:38 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 07:55:38 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 07:55:38 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 07:55:38 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 07:55:38 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 07:55:38 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 07:55:38 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 07:55:38 [scrapy] INFO: Spider opened
2015-09-30 07:55:38 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 07:55:38 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 07:55:41 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 07:55:42 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 07:55:50 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 07:55:55 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 07:55:57 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 07:55:57 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 07:56:03 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:56:03 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 474, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:56:07 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:56:07 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 474, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:56:09 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:56:09 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 474, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:56:10 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:56:10 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 474, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:56:11 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:56:12 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 474, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:56:12 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:56:13 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 474, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:56:14 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:56:14 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 474, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:56:14 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:56:14 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 474, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:56:16 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:56:16 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 474, in parse_hkjc_racecard
    assert 1==0
AssertionError
2015-09-30 07:56:16 [scrapy] INFO: Closing spider (finished)
2015-09-30 07:56:16 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 5227,
 'downloader/request_count': 14,
 'downloader/request_method_count/GET': 13,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 396805,
 'downloader/response_count': 14,
 'downloader/response_status_count/200': 13,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 7, 56, 16, 233036),
 'log_count/DEBUG': 16,
 'log_count/ERROR': 9,
 'log_count/INFO': 7,
 'request_depth_max': 4,
 'response_received_count': 13,
 'scheduler/dequeued': 14,
 'scheduler/dequeued/memory': 14,
 'scheduler/enqueued': 14,
 'scheduler/enqueued/memory': 14,
 'spider_exceptions/AssertionError': 9,
 'start_time': datetime.datetime(2015, 9, 30, 7, 55, 38, 771331)}
2015-09-30 07:56:16 [scrapy] INFO: Spider closed (finished)
2015-09-30 07:58:07 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 07:58:07 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 07:58:07 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 07:58:07 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 07:58:08 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 07:58:08 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 07:58:08 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 07:58:08 [scrapy] INFO: Spider opened
2015-09-30 07:58:08 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 07:58:08 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 07:58:10 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 07:58:13 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 07:58:21 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 07:58:24 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 07:58:28 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 07:58:28 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 07:58:33 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:58:33 [root] WARNING: -------------------------------------------------
2015-09-30 07:58:33 [root] WARNING: horse code set
2015-09-30 07:58:33 [root] WARNING: 1
2015-09-30 07:58:33 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 537, in parse_hkjc_racecard
    racecoursecode=get_racecoursecode(racecourse),
NameError: global name 'racecourse' is not defined
2015-09-30 07:58:36 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:58:36 [root] WARNING: -------------------------------------------------
2015-09-30 07:58:36 [root] WARNING: horse code set
2015-09-30 07:58:36 [root] WARNING: 2
2015-09-30 07:58:36 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 537, in parse_hkjc_racecard
    racecoursecode=get_racecoursecode(racecourse),
NameError: global name 'racecourse' is not defined
2015-09-30 07:58:39 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:58:39 [root] WARNING: -------------------------------------------------
2015-09-30 07:58:39 [root] WARNING: horse code set
2015-09-30 07:58:39 [root] WARNING: 3
2015-09-30 07:58:39 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 537, in parse_hkjc_racecard
    racecoursecode=get_racecoursecode(racecourse),
NameError: global name 'racecourse' is not defined
2015-09-30 07:58:40 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:58:40 [root] WARNING: -------------------------------------------------
2015-09-30 07:58:40 [root] WARNING: horse code set
2015-09-30 07:58:40 [root] WARNING: 4
2015-09-30 07:58:40 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 537, in parse_hkjc_racecard
    racecoursecode=get_racecoursecode(racecourse),
NameError: global name 'racecourse' is not defined
2015-09-30 07:58:41 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:58:41 [root] WARNING: -------------------------------------------------
2015-09-30 07:58:41 [root] WARNING: horse code set
2015-09-30 07:58:41 [root] WARNING: 5
2015-09-30 07:58:41 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 537, in parse_hkjc_racecard
    racecoursecode=get_racecoursecode(racecourse),
NameError: global name 'racecourse' is not defined
2015-09-30 07:58:41 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:58:42 [root] WARNING: -------------------------------------------------
2015-09-30 07:58:42 [root] WARNING: horse code set
2015-09-30 07:58:42 [root] WARNING: 6
2015-09-30 07:58:42 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 537, in parse_hkjc_racecard
    racecoursecode=get_racecoursecode(racecourse),
NameError: global name 'racecourse' is not defined
2015-09-30 07:58:43 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:58:43 [root] WARNING: -------------------------------------------------
2015-09-30 07:58:43 [root] WARNING: horse code set
2015-09-30 07:58:43 [root] WARNING: 7
2015-09-30 07:58:43 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 537, in parse_hkjc_racecard
    racecoursecode=get_racecoursecode(racecourse),
NameError: global name 'racecourse' is not defined
2015-09-30 07:58:43 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:58:44 [root] WARNING: -------------------------------------------------
2015-09-30 07:58:44 [root] WARNING: horse code set
2015-09-30 07:58:44 [root] WARNING: 8
2015-09-30 07:58:44 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 537, in parse_hkjc_racecard
    racecoursecode=get_racecoursecode(racecourse),
NameError: global name 'racecourse' is not defined
2015-09-30 07:58:44 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 07:58:44 [root] WARNING: -------------------------------------------------
2015-09-30 07:58:44 [root] WARNING: horse code set
2015-09-30 07:58:44 [root] WARNING: 9
2015-09-30 07:58:44 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 537, in parse_hkjc_racecard
    racecoursecode=get_racecoursecode(racecourse),
NameError: global name 'racecourse' is not defined
2015-09-30 07:58:44 [scrapy] INFO: Closing spider (finished)
2015-09-30 07:58:44 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 5227,
 'downloader/request_count': 14,
 'downloader/request_method_count/GET': 13,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 396829,
 'downloader/response_count': 14,
 'downloader/response_status_count/200': 13,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 7, 58, 44, 974828),
 'log_count/DEBUG': 16,
 'log_count/ERROR': 9,
 'log_count/INFO': 7,
 'log_count/WARNING': 27,
 'request_depth_max': 4,
 'response_received_count': 13,
 'scheduler/dequeued': 14,
 'scheduler/dequeued/memory': 14,
 'scheduler/enqueued': 14,
 'scheduler/enqueued/memory': 14,
 'spider_exceptions/NameError': 9,
 'start_time': datetime.datetime(2015, 9, 30, 7, 58, 8, 15292)}
2015-09-30 07:58:44 [scrapy] INFO: Spider closed (finished)
2015-09-30 07:59:45 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 07:59:45 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 07:59:45 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 07:59:45 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 07:59:45 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 07:59:45 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 07:59:45 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 07:59:45 [scrapy] INFO: Spider opened
2015-09-30 07:59:45 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 07:59:45 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 07:59:49 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 07:59:52 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 08:00:00 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 08:00:03 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 08:00:05 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 08:00:05 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 08:00:10 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:00:10 [root] WARNING: -------------------------------------------------
2015-09-30 08:00:10 [root] WARNING: horse code set
2015-09-30 08:00:10 [root] WARNING: 1
2015-09-30 08:00:10 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 540, in parse_hkjc_racecard
    racedistance=get_distance(distance),
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 138, in get_distance
    if 'M' in d or 'm' in d:
TypeError: argument of type 'NoneType' is not iterable
2015-09-30 08:00:12 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:00:12 [root] WARNING: -------------------------------------------------
2015-09-30 08:00:12 [root] WARNING: horse code set
2015-09-30 08:00:12 [root] WARNING: 2
2015-09-30 08:00:12 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 540, in parse_hkjc_racecard
    racedistance=get_distance(distance),
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 138, in get_distance
    if 'M' in d or 'm' in d:
TypeError: argument of type 'NoneType' is not iterable
2015-09-30 08:00:13 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:00:13 [root] WARNING: -------------------------------------------------
2015-09-30 08:00:13 [root] WARNING: horse code set
2015-09-30 08:00:13 [root] WARNING: 3
2015-09-30 08:00:13 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 540, in parse_hkjc_racecard
    racedistance=get_distance(distance),
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 138, in get_distance
    if 'M' in d or 'm' in d:
TypeError: argument of type 'NoneType' is not iterable
2015-09-30 08:00:14 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:00:14 [root] WARNING: -------------------------------------------------
2015-09-30 08:00:14 [root] WARNING: horse code set
2015-09-30 08:00:14 [root] WARNING: 4
2015-09-30 08:00:14 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 540, in parse_hkjc_racecard
    racedistance=get_distance(distance),
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 138, in get_distance
    if 'M' in d or 'm' in d:
TypeError: argument of type 'NoneType' is not iterable
2015-09-30 08:00:17 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:00:17 [root] WARNING: -------------------------------------------------
2015-09-30 08:00:17 [root] WARNING: horse code set
2015-09-30 08:00:17 [root] WARNING: 5
2015-09-30 08:00:17 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 540, in parse_hkjc_racecard
    racedistance=get_distance(distance),
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 138, in get_distance
    if 'M' in d or 'm' in d:
TypeError: argument of type 'NoneType' is not iterable
2015-09-30 08:00:18 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:00:18 [root] WARNING: -------------------------------------------------
2015-09-30 08:00:18 [root] WARNING: horse code set
2015-09-30 08:00:18 [root] WARNING: 6
2015-09-30 08:00:18 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 540, in parse_hkjc_racecard
    racedistance=get_distance(distance),
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 138, in get_distance
    if 'M' in d or 'm' in d:
TypeError: argument of type 'NoneType' is not iterable
2015-09-30 08:00:18 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:00:18 [root] WARNING: -------------------------------------------------
2015-09-30 08:00:18 [root] WARNING: horse code set
2015-09-30 08:00:18 [root] WARNING: 7
2015-09-30 08:00:18 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 540, in parse_hkjc_racecard
    racedistance=get_distance(distance),
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 138, in get_distance
    if 'M' in d or 'm' in d:
TypeError: argument of type 'NoneType' is not iterable
2015-09-30 08:00:19 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:00:19 [root] WARNING: -------------------------------------------------
2015-09-30 08:00:19 [root] WARNING: horse code set
2015-09-30 08:00:19 [root] WARNING: 8
2015-09-30 08:00:19 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 540, in parse_hkjc_racecard
    racedistance=get_distance(distance),
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 138, in get_distance
    if 'M' in d or 'm' in d:
TypeError: argument of type 'NoneType' is not iterable
2015-09-30 08:00:20 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:00:20 [root] WARNING: -------------------------------------------------
2015-09-30 08:00:20 [root] WARNING: horse code set
2015-09-30 08:00:20 [root] WARNING: 9
2015-09-30 08:00:20 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 540, in parse_hkjc_racecard
    racedistance=get_distance(distance),
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 138, in get_distance
    if 'M' in d or 'm' in d:
TypeError: argument of type 'NoneType' is not iterable
2015-09-30 08:00:20 [scrapy] INFO: Closing spider (finished)
2015-09-30 08:00:20 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 5227,
 'downloader/request_count': 14,
 'downloader/request_method_count/GET': 13,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 396902,
 'downloader/response_count': 14,
 'downloader/response_status_count/200': 13,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 8, 0, 20, 797924),
 'log_count/DEBUG': 16,
 'log_count/ERROR': 9,
 'log_count/INFO': 7,
 'log_count/WARNING': 27,
 'request_depth_max': 4,
 'response_received_count': 13,
 'scheduler/dequeued': 14,
 'scheduler/dequeued/memory': 14,
 'scheduler/enqueued': 14,
 'scheduler/enqueued/memory': 14,
 'spider_exceptions/TypeError': 9,
 'start_time': datetime.datetime(2015, 9, 30, 7, 59, 45, 414079)}
2015-09-30 08:00:20 [scrapy] INFO: Spider closed (finished)
2015-09-30 08:01:24 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 08:01:24 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 08:01:24 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 08:01:24 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 08:01:24 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 08:01:24 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 08:01:24 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 08:01:24 [scrapy] INFO: Spider opened
2015-09-30 08:01:24 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 08:01:24 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 08:01:27 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 08:01:31 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 08:01:39 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 08:01:42 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 08:01:44 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 08:01:44 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 08:01:47 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:01:47 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:47 [root] WARNING: horse code set
2015-09-30 08:01:47 [root] WARNING: 1
2015-09-30 08:01:47 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:47 [root] WARNING: horse code set
2015-09-30 08:01:47 [root] WARNING: 2
2015-09-30 08:01:47 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:47 [root] WARNING: horse code set
2015-09-30 08:01:47 [root] WARNING: 3
2015-09-30 08:01:47 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:47 [root] WARNING: horse code set
2015-09-30 08:01:47 [root] WARNING: 4
2015-09-30 08:01:47 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:47 [root] WARNING: horse code set
2015-09-30 08:01:47 [root] WARNING: 5
2015-09-30 08:01:47 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:47 [root] WARNING: horse code set
2015-09-30 08:01:47 [root] WARNING: 6
2015-09-30 08:01:47 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:47 [root] WARNING: horse code set
2015-09-30 08:01:47 [root] WARNING: 7
2015-09-30 08:01:47 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:47 [root] WARNING: horse code set
2015-09-30 08:01:47 [root] WARNING: 8
2015-09-30 08:01:47 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:47 [root] WARNING: horse code set
2015-09-30 08:01:47 [root] WARNING: 9
2015-09-30 08:01:47 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:47 [root] WARNING: horse code set
2015-09-30 08:01:47 [root] WARNING: 10
2015-09-30 08:01:47 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:47 [root] WARNING: horse code set
2015-09-30 08:01:47 [root] WARNING: 11
2015-09-30 08:01:47 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:47 [root] WARNING: horse code set
2015-09-30 08:01:47 [root] WARNING: 12
2015-09-30 08:01:47 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:47 [root] WARNING: horse code set
2015-09-30 08:01:47 [root] WARNING: 13
2015-09-30 08:01:47 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:47 [root] WARNING: horse code set
2015-09-30 08:01:47 [root] WARNING: 14
2015-09-30 08:01:49 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:01:50 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:50 [root] WARNING: horse code set
2015-09-30 08:01:50 [root] WARNING: 15
2015-09-30 08:01:50 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:50 [root] WARNING: horse code set
2015-09-30 08:01:50 [root] WARNING: 16
2015-09-30 08:01:50 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:50 [root] WARNING: horse code set
2015-09-30 08:01:50 [root] WARNING: 17
2015-09-30 08:01:50 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:50 [root] WARNING: horse code set
2015-09-30 08:01:50 [root] WARNING: 18
2015-09-30 08:01:50 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:50 [root] WARNING: horse code set
2015-09-30 08:01:50 [root] WARNING: 19
2015-09-30 08:01:50 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:50 [root] WARNING: horse code set
2015-09-30 08:01:50 [root] WARNING: 20
2015-09-30 08:01:50 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:50 [root] WARNING: horse code set
2015-09-30 08:01:50 [root] WARNING: 21
2015-09-30 08:01:50 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:50 [root] WARNING: horse code set
2015-09-30 08:01:50 [root] WARNING: 22
2015-09-30 08:01:50 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:50 [root] WARNING: horse code set
2015-09-30 08:01:50 [root] WARNING: 23
2015-09-30 08:01:50 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:50 [root] WARNING: horse code set
2015-09-30 08:01:50 [root] WARNING: 24
2015-09-30 08:01:50 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:50 [root] WARNING: horse code set
2015-09-30 08:01:50 [root] WARNING: 25
2015-09-30 08:01:50 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:50 [root] WARNING: horse code set
2015-09-30 08:01:50 [root] WARNING: 26
2015-09-30 08:01:50 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:50 [root] WARNING: horse code set
2015-09-30 08:01:50 [root] WARNING: 27
2015-09-30 08:01:50 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:50 [root] WARNING: horse code set
2015-09-30 08:01:50 [root] WARNING: 28
2015-09-30 08:01:53 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:01:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:53 [root] WARNING: horse code set
2015-09-30 08:01:53 [root] WARNING: 29
2015-09-30 08:01:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:53 [root] WARNING: horse code set
2015-09-30 08:01:53 [root] WARNING: 30
2015-09-30 08:01:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:53 [root] WARNING: horse code set
2015-09-30 08:01:53 [root] WARNING: 31
2015-09-30 08:01:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:53 [root] WARNING: horse code set
2015-09-30 08:01:53 [root] WARNING: 32
2015-09-30 08:01:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:53 [root] WARNING: horse code set
2015-09-30 08:01:53 [root] WARNING: 33
2015-09-30 08:01:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:53 [root] WARNING: horse code set
2015-09-30 08:01:53 [root] WARNING: 34
2015-09-30 08:01:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:53 [root] WARNING: horse code set
2015-09-30 08:01:53 [root] WARNING: 35
2015-09-30 08:01:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:53 [root] WARNING: horse code set
2015-09-30 08:01:53 [root] WARNING: 36
2015-09-30 08:01:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:53 [root] WARNING: horse code set
2015-09-30 08:01:53 [root] WARNING: 37
2015-09-30 08:01:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:53 [root] WARNING: horse code set
2015-09-30 08:01:53 [root] WARNING: 38
2015-09-30 08:01:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:53 [root] WARNING: horse code set
2015-09-30 08:01:53 [root] WARNING: 39
2015-09-30 08:01:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:53 [root] WARNING: horse code set
2015-09-30 08:01:53 [root] WARNING: 40
2015-09-30 08:01:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:53 [root] WARNING: horse code set
2015-09-30 08:01:53 [root] WARNING: 41
2015-09-30 08:01:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:53 [root] WARNING: horse code set
2015-09-30 08:01:53 [root] WARNING: 42
2015-09-30 08:01:53 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:01:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:53 [root] WARNING: horse code set
2015-09-30 08:01:53 [root] WARNING: 43
2015-09-30 08:01:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:53 [root] WARNING: horse code set
2015-09-30 08:01:53 [root] WARNING: 44
2015-09-30 08:01:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:53 [root] WARNING: horse code set
2015-09-30 08:01:53 [root] WARNING: 45
2015-09-30 08:01:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:53 [root] WARNING: horse code set
2015-09-30 08:01:53 [root] WARNING: 46
2015-09-30 08:01:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:53 [root] WARNING: horse code set
2015-09-30 08:01:53 [root] WARNING: 47
2015-09-30 08:01:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:53 [root] WARNING: horse code set
2015-09-30 08:01:53 [root] WARNING: 48
2015-09-30 08:01:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:53 [root] WARNING: horse code set
2015-09-30 08:01:53 [root] WARNING: 49
2015-09-30 08:01:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:53 [root] WARNING: horse code set
2015-09-30 08:01:53 [root] WARNING: 50
2015-09-30 08:01:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:53 [root] WARNING: horse code set
2015-09-30 08:01:53 [root] WARNING: 51
2015-09-30 08:01:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:53 [root] WARNING: horse code set
2015-09-30 08:01:53 [root] WARNING: 52
2015-09-30 08:01:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:53 [root] WARNING: horse code set
2015-09-30 08:01:53 [root] WARNING: 53
2015-09-30 08:01:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:53 [root] WARNING: horse code set
2015-09-30 08:01:53 [root] WARNING: 54
2015-09-30 08:01:54 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:01:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:54 [root] WARNING: horse code set
2015-09-30 08:01:54 [root] WARNING: 55
2015-09-30 08:01:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:54 [root] WARNING: horse code set
2015-09-30 08:01:54 [root] WARNING: 56
2015-09-30 08:01:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:54 [root] WARNING: horse code set
2015-09-30 08:01:54 [root] WARNING: 57
2015-09-30 08:01:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:54 [root] WARNING: horse code set
2015-09-30 08:01:54 [root] WARNING: 58
2015-09-30 08:01:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:54 [root] WARNING: horse code set
2015-09-30 08:01:54 [root] WARNING: 59
2015-09-30 08:01:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:54 [root] WARNING: horse code set
2015-09-30 08:01:54 [root] WARNING: 60
2015-09-30 08:01:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:54 [root] WARNING: horse code set
2015-09-30 08:01:54 [root] WARNING: 61
2015-09-30 08:01:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:54 [root] WARNING: horse code set
2015-09-30 08:01:54 [root] WARNING: 62
2015-09-30 08:01:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:54 [root] WARNING: horse code set
2015-09-30 08:01:54 [root] WARNING: 63
2015-09-30 08:01:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:54 [root] WARNING: horse code set
2015-09-30 08:01:54 [root] WARNING: 64
2015-09-30 08:01:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:54 [root] WARNING: horse code set
2015-09-30 08:01:54 [root] WARNING: 65
2015-09-30 08:01:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:54 [root] WARNING: horse code set
2015-09-30 08:01:54 [root] WARNING: 66
2015-09-30 08:01:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:54 [root] WARNING: horse code set
2015-09-30 08:01:54 [root] WARNING: 67
2015-09-30 08:01:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:54 [root] WARNING: horse code set
2015-09-30 08:01:54 [root] WARNING: 68
2015-09-30 08:01:55 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:01:55 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:55 [root] WARNING: horse code set
2015-09-30 08:01:55 [root] WARNING: 69
2015-09-30 08:01:55 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:55 [root] WARNING: horse code set
2015-09-30 08:01:55 [root] WARNING: 70
2015-09-30 08:01:55 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:55 [root] WARNING: horse code set
2015-09-30 08:01:55 [root] WARNING: 71
2015-09-30 08:01:55 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:55 [root] WARNING: horse code set
2015-09-30 08:01:55 [root] WARNING: 72
2015-09-30 08:01:55 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:55 [root] WARNING: horse code set
2015-09-30 08:01:55 [root] WARNING: 73
2015-09-30 08:01:55 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:55 [root] WARNING: horse code set
2015-09-30 08:01:55 [root] WARNING: 74
2015-09-30 08:01:55 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:55 [root] WARNING: horse code set
2015-09-30 08:01:55 [root] WARNING: 75
2015-09-30 08:01:55 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:55 [root] WARNING: horse code set
2015-09-30 08:01:55 [root] WARNING: 76
2015-09-30 08:01:55 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:55 [root] WARNING: horse code set
2015-09-30 08:01:55 [root] WARNING: 77
2015-09-30 08:01:55 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:55 [root] WARNING: horse code set
2015-09-30 08:01:55 [root] WARNING: 78
2015-09-30 08:01:55 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:55 [root] WARNING: horse code set
2015-09-30 08:01:55 [root] WARNING: 79
2015-09-30 08:01:55 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:55 [root] WARNING: horse code set
2015-09-30 08:01:55 [root] WARNING: 80
2015-09-30 08:01:55 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:55 [root] WARNING: horse code set
2015-09-30 08:01:55 [root] WARNING: 81
2015-09-30 08:01:55 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:55 [root] WARNING: horse code set
2015-09-30 08:01:55 [root] WARNING: 82
2015-09-30 08:01:56 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:01:57 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:57 [root] WARNING: horse code set
2015-09-30 08:01:57 [root] WARNING: 83
2015-09-30 08:01:57 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:57 [root] WARNING: horse code set
2015-09-30 08:01:57 [root] WARNING: 84
2015-09-30 08:01:57 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:57 [root] WARNING: horse code set
2015-09-30 08:01:57 [root] WARNING: 85
2015-09-30 08:01:57 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:57 [root] WARNING: horse code set
2015-09-30 08:01:57 [root] WARNING: 86
2015-09-30 08:01:57 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:57 [root] WARNING: horse code set
2015-09-30 08:01:57 [root] WARNING: 87
2015-09-30 08:01:57 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:57 [root] WARNING: horse code set
2015-09-30 08:01:57 [root] WARNING: 88
2015-09-30 08:01:57 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:57 [root] WARNING: horse code set
2015-09-30 08:01:57 [root] WARNING: 89
2015-09-30 08:01:57 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:57 [root] WARNING: horse code set
2015-09-30 08:01:57 [root] WARNING: 90
2015-09-30 08:01:57 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:57 [root] WARNING: horse code set
2015-09-30 08:01:57 [root] WARNING: 91
2015-09-30 08:01:57 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:57 [root] WARNING: horse code set
2015-09-30 08:01:57 [root] WARNING: 92
2015-09-30 08:01:57 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:57 [root] WARNING: horse code set
2015-09-30 08:01:57 [root] WARNING: 93
2015-09-30 08:01:57 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:01:57 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:57 [root] WARNING: horse code set
2015-09-30 08:01:57 [root] WARNING: 94
2015-09-30 08:01:57 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:57 [root] WARNING: horse code set
2015-09-30 08:01:57 [root] WARNING: 95
2015-09-30 08:01:57 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:57 [root] WARNING: horse code set
2015-09-30 08:01:57 [root] WARNING: 96
2015-09-30 08:01:57 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:57 [root] WARNING: horse code set
2015-09-30 08:01:57 [root] WARNING: 97
2015-09-30 08:01:57 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:57 [root] WARNING: horse code set
2015-09-30 08:01:57 [root] WARNING: 98
2015-09-30 08:01:57 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:57 [root] WARNING: horse code set
2015-09-30 08:01:57 [root] WARNING: 99
2015-09-30 08:01:57 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:57 [root] WARNING: horse code set
2015-09-30 08:01:57 [root] WARNING: 100
2015-09-30 08:01:57 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:57 [root] WARNING: horse code set
2015-09-30 08:01:57 [root] WARNING: 101
2015-09-30 08:01:57 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:57 [root] WARNING: horse code set
2015-09-30 08:01:57 [root] WARNING: 102
2015-09-30 08:01:57 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:57 [root] WARNING: horse code set
2015-09-30 08:01:57 [root] WARNING: 103
2015-09-30 08:01:57 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:57 [root] WARNING: horse code set
2015-09-30 08:01:57 [root] WARNING: 104
2015-09-30 08:01:57 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:57 [root] WARNING: horse code set
2015-09-30 08:01:57 [root] WARNING: 105
2015-09-30 08:01:57 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:57 [root] WARNING: horse code set
2015-09-30 08:01:57 [root] WARNING: 106
2015-09-30 08:01:57 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:57 [root] WARNING: horse code set
2015-09-30 08:01:57 [root] WARNING: 107
2015-09-30 08:01:58 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:01:58 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:58 [root] WARNING: horse code set
2015-09-30 08:01:58 [root] WARNING: 108
2015-09-30 08:01:58 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:58 [root] WARNING: horse code set
2015-09-30 08:01:58 [root] WARNING: 109
2015-09-30 08:01:58 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:58 [root] WARNING: horse code set
2015-09-30 08:01:58 [root] WARNING: 110
2015-09-30 08:01:58 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:58 [root] WARNING: horse code set
2015-09-30 08:01:58 [root] WARNING: 111
2015-09-30 08:01:58 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:58 [root] WARNING: horse code set
2015-09-30 08:01:58 [root] WARNING: 112
2015-09-30 08:01:58 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:58 [root] WARNING: horse code set
2015-09-30 08:01:58 [root] WARNING: 113
2015-09-30 08:01:58 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:58 [root] WARNING: horse code set
2015-09-30 08:01:58 [root] WARNING: 114
2015-09-30 08:01:58 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:58 [root] WARNING: horse code set
2015-09-30 08:01:58 [root] WARNING: 115
2015-09-30 08:01:58 [root] WARNING: -------------------------------------------------
2015-09-30 08:01:58 [root] WARNING: horse code set
2015-09-30 08:01:58 [root] WARNING: 116
2015-09-30 08:01:59 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T200&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:01:59 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:01:59 [root] WARNING: 1
2015-09-30 08:01:59 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T200&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:01 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T238&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:02:01 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:01 [root] WARNING: 2
2015-09-30 08:02:01 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T238&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:01 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S022&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:02:01 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:01 [root] WARNING: 3
2015-09-30 08:02:01 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S022&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:02:04 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T009&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:02:04 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:04 [root] WARNING: 4
2015-09-30 08:02:04 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T009&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:04 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T096&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:02:04 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:04 [root] WARNING: 5
2015-09-30 08:02:04 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T096&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:04 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:02:04 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:04 [root] WARNING: 6
2015-09-30 08:02:04 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:06 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N033&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:02:06 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:06 [root] WARNING: 7
2015-09-30 08:02:06 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N033&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:02:09 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S010&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:02:09 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:09 [root] WARNING: 8
2015-09-30 08:02:09 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S010&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:10 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T288&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:02:10 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:10 [root] WARNING: 9
2015-09-30 08:02:10 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T288&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:12 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P222&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:02:12 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:12 [root] WARNING: 10
2015-09-30 08:02:12 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P222&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:12 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P158&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:02:12 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:12 [root] WARNING: 11
2015-09-30 08:02:12 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P158&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:02:13 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S305&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:02:13 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S346&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:02:13 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:13 [root] WARNING: 12
2015-09-30 08:02:13 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S305&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:13 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:13 [root] WARNING: 13
2015-09-30 08:02:13 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S346&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:13 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T135&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:02:13 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:13 [root] WARNING: 14
2015-09-30 08:02:13 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T135&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:14 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P031&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:02:14 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:14 [root] WARNING: 15
2015-09-30 08:02:15 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P031&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:15 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:02:15 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:15 [root] WARNING: 16
2015-09-30 08:02:15 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:17 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P358&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:02:18 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:18 [root] WARNING: 17
2015-09-30 08:02:18 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P358&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:19 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S076&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:02:19 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:19 [root] WARNING: 18
2015-09-30 08:02:19 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S076&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:19 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N234&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:02:20 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:20 [root] WARNING: 19
2015-09-30 08:02:20 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N234&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:02:22 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S332&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:02:22 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:22 [root] WARNING: 20
2015-09-30 08:02:22 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S332&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:22 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P151&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:02:22 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:22 [root] WARNING: 21
2015-09-30 08:02:23 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P151&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:02:24 [scrapy] INFO: Crawled 34 pages (at 34 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 08:02:27 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S100&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:02:27 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P044&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:02:27 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:27 [root] WARNING: 22
2015-09-30 08:02:27 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S100&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:27 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:27 [root] WARNING: 23
2015-09-30 08:02:27 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P044&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:31 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S023&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:02:31 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:31 [root] WARNING: 24
2015-09-30 08:02:31 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S023&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:31 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:02:31 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:31 [root] WARNING: 25
2015-09-30 08:02:31 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:33 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T080&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:02:33 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:33 [root] WARNING: 26
2015-09-30 08:02:33 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T080&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:35 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T205&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:02:35 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:35 [root] WARNING: 27
2015-09-30 08:02:35 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T205&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:36 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V061&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:02:37 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:37 [root] WARNING: 28
2015-09-30 08:02:37 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V061&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:38 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T005&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:02:38 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:38 [root] WARNING: 29
2015-09-30 08:02:38 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T005&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:39 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T342&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:02:39 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:39 [root] WARNING: 30
2015-09-30 08:02:39 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T342&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:39 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V039&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:02:39 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:39 [root] WARNING: 31
2015-09-30 08:02:39 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V039&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:40 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T333&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:02:40 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N330&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:02:40 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:40 [root] WARNING: 32
2015-09-30 08:02:40 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T333&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:40 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:40 [root] WARNING: 33
2015-09-30 08:02:40 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N330&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:02:40 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:02:41 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:41 [root] WARNING: 34
2015-09-30 08:02:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:41 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T340&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:02:41 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:41 [root] WARNING: 35
2015-09-30 08:02:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T340&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S397&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:02:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:46 [root] WARNING: 36
2015-09-30 08:02:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S397&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:48 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N226&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:02:48 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:48 [root] WARNING: 37
2015-09-30 08:02:48 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N226&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:48 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S209&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:02:48 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T168&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:02:48 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:48 [root] WARNING: 38
2015-09-30 08:02:48 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S209&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:48 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:48 [root] WARNING: 39
2015-09-30 08:02:48 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T168&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:49 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P097&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:02:49 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:49 [root] WARNING: 40
2015-09-30 08:02:49 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P097&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:02:49 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S300&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:02:50 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:50 [root] WARNING: 41
2015-09-30 08:02:50 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S300&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:02:50 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:02:51 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:51 [root] WARNING: 42
2015-09-30 08:02:51 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:51 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N220&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:02:51 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:51 [root] WARNING: 43
2015-09-30 08:02:52 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N220&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:52 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T002&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:02:52 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:52 [root] WARNING: 44
2015-09-30 08:02:52 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T002&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:54 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:02:54 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:54 [root] WARNING: 45
2015-09-30 08:02:54 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:56 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S375&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:02:56 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:56 [root] WARNING: 46
2015-09-30 08:02:56 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S375&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:57 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S421&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:02:58 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:58 [root] WARNING: 47
2015-09-30 08:02:58 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S421&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:58 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T004&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:02:58 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P316&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:02:58 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T265&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:02:58 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:58 [root] WARNING: 48
2015-09-30 08:02:58 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T004&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:02:58 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:58 [root] WARNING: 49
2015-09-30 08:02:58 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P316&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:58 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:58 [root] WARNING: 50
2015-09-30 08:02:58 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T265&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:59 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T404&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:02:59 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:59 [root] WARNING: 51
2015-09-30 08:02:59 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T404&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:02:59 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T215&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:02:59 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:02:59 [root] WARNING: 52
2015-09-30 08:02:59 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T215&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:03:04 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:03:04 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:04 [root] WARNING: 53
2015-09-30 08:03:04 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:03:07 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N432&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:03:07 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:07 [root] WARNING: 54
2015-09-30 08:03:07 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N432&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:03:08 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S349&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:03:08 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:08 [root] WARNING: 55
2015-09-30 08:03:08 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S349&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:03:08 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:03:08 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N386&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:03:08 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:08 [root] WARNING: 56
2015-09-30 08:03:08 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:03:08 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P173&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:03:08 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:08 [root] WARNING: 57
2015-09-30 08:03:08 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N386&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:03:08 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:08 [root] WARNING: 58
2015-09-30 08:03:08 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P173&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:03:08 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:03:08 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:08 [root] WARNING: 59
2015-09-30 08:03:09 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:03:13 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:03:14 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:14 [root] WARNING: 60
2015-09-30 08:03:14 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:03:15 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M227&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:03:15 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:15 [root] WARNING: 61
2015-09-30 08:03:16 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M227&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:03:17 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T111&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:03:17 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:17 [root] WARNING: 62
2015-09-30 08:03:17 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T111&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:03:17 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:03:17 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S225&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:03:17 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:17 [root] WARNING: 63
2015-09-30 08:03:18 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:03:18 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:18 [root] WARNING: 64
2015-09-30 08:03:18 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S225&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:03:18 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S165&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:03:18 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:18 [root] WARNING: 65
2015-09-30 08:03:18 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S165&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:03:22 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:03:22 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:22 [root] WARNING: 66
2015-09-30 08:03:22 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:03:23 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S415&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:03:23 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:23 [root] WARNING: 67
2015-09-30 08:03:23 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S415&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:03:23 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N419&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:03:23 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:23 [root] WARNING: 68
2015-09-30 08:03:23 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N419&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:03:24 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T379&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:03:24 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:24 [root] WARNING: 69
2015-09-30 08:03:24 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T379&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:03:24 [scrapy] INFO: Crawled 82 pages (at 48 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 08:03:25 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T289&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:03:25 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:25 [root] WARNING: 70
2015-09-30 08:03:25 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T289&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:03:26 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T050&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:03:26 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:26 [root] WARNING: 71
2015-09-30 08:03:26 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T050&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:03:28 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T129&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:03:28 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:28 [root] WARNING: 72
2015-09-30 08:03:28 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T129&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:03:30 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S275&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:03:30 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T235&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:03:30 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:30 [root] WARNING: 73
2015-09-30 08:03:30 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S275&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:03:30 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:30 [root] WARNING: 74
2015-09-30 08:03:30 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T235&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:03:31 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:03:31 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:31 [root] WARNING: 75
2015-09-30 08:03:31 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:03:31 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S394&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:03:31 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:31 [root] WARNING: 76
2015-09-30 08:03:31 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S394&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:03:32 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:03:32 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:03:32 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:32 [root] WARNING: 77
2015-09-30 08:03:32 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:03:32 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:32 [root] WARNING: 78
2015-09-30 08:03:32 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:03:35 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N236&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:03:36 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:36 [root] WARNING: 79
2015-09-30 08:03:36 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N236&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:03:37 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:03:37 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:37 [root] WARNING: 80
2015-09-30 08:03:37 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:03:37 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P195&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:03:38 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:38 [root] WARNING: 81
2015-09-30 08:03:38 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P195&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:03:40 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:03:41 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:41 [root] WARNING: 82
2015-09-30 08:03:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:03:41 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T257&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:03:41 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:41 [root] WARNING: 83
2015-09-30 08:03:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T257&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:03:43 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P180&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:03:43 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:43 [root] WARNING: 84
2015-09-30 08:03:43 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P180&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:03:43 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N297&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:03:43 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:43 [root] WARNING: 85
2015-09-30 08:03:44 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N297&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:03:44 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N434&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:03:44 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:44 [root] WARNING: 86
2015-09-30 08:03:44 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N434&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:03:44 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N171&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:03:44 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:44 [root] WARNING: 87
2015-09-30 08:03:44 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N171&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:03:44 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:03:45 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:45 [root] WARNING: 88
2015-09-30 08:03:45 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:03:45 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T256&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:03:45 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:45 [root] WARNING: 89
2015-09-30 08:03:45 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T256&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:03:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M199&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:03:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:46 [root] WARNING: 90
2015-09-30 08:03:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M199&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:03:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S296&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:03:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:47 [root] WARNING: 91
2015-09-30 08:03:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S296&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:03:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T093&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:03:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:47 [root] WARNING: 92
2015-09-30 08:03:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T093&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:03:50 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S420&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:03:50 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:50 [root] WARNING: 93
2015-09-30 08:03:50 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S420&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:03:50 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S278&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:03:50 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:50 [root] WARNING: 94
2015-09-30 08:03:51 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S278&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:03:51 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P111&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:03:51 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T170&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:03:51 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:51 [root] WARNING: 95
2015-09-30 08:03:51 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P111&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:03:51 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:51 [root] WARNING: 96
2015-09-30 08:03:51 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T170&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:03:53 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T148&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:03:53 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T112&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:03:53 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:53 [root] WARNING: 97
2015-09-30 08:03:53 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T148&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:03:53 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:53 [root] WARNING: 98
2015-09-30 08:03:53 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T112&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:03:56 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S282&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:03:56 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:03:56 [root] WARNING: 99
2015-09-30 08:03:56 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S282&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:04:00 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S391&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:04:00 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S109&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:04:00 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:04:00 [root] WARNING: 100
2015-09-30 08:04:00 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S391&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:04:00 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N394&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:04:00 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:04:00 [root] WARNING: 101
2015-09-30 08:04:00 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S109&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:04:00 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:04:00 [root] WARNING: 102
2015-09-30 08:04:01 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N394&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:04:03 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P366&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:04:03 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:04:03 [root] WARNING: 103
2015-09-30 08:04:03 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P366&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:04:09 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S145&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:04:09 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:04:09 [root] WARNING: 104
2015-09-30 08:04:10 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S145&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:04:10 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P118&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:04:10 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:04:10 [root] WARNING: 105
2015-09-30 08:04:10 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P118&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:04:12 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S117&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:04:13 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:04:13 [root] WARNING: 106
2015-09-30 08:04:13 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S117&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:04:15 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S398&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:04:15 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:04:15 [root] WARNING: 107
2015-09-30 08:04:15 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S398&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:04:17 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S439&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:04:17 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:04:17 [root] WARNING: 108
2015-09-30 08:04:17 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S439&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:04:18 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P191&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:04:18 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:04:18 [root] WARNING: 109
2015-09-30 08:04:18 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P191&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:04:18 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S110&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:04:18 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:04:18 [root] WARNING: 110
2015-09-30 08:04:18 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S110&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:04:19 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:04:19 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T398&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:04:19 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:04:19 [root] WARNING: 111
2015-09-30 08:04:19 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:04:19 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:04:19 [root] WARNING: 112
2015-09-30 08:04:19 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T398&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:04:20 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N195&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:04:20 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:04:20 [root] WARNING: 113
2015-09-30 08:04:20 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N195&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:04:22 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P372&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:04:22 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N169&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:04:22 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:04:22 [root] WARNING: 114
2015-09-30 08:04:22 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P372&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:04:22 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:04:22 [root] WARNING: 115
2015-09-30 08:04:22 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N169&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:04:24 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P103&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:04:24 [scrapy] INFO: Crawled 129 pages (at 47 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 08:04:24 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:04:24 [root] WARNING: 116
2015-09-30 08:04:25 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P103&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 765, in parse_horse
    places_daysoff =  [x for x in chain.from_iterable(izip_longest(prev_places,dayssincelastrun_h )) if x]
NameError: global name 'izip_longest' is not defined
2015-09-30 08:04:25 [scrapy] INFO: Closing spider (finished)
2015-09-30 08:04:25 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 59934,
 'downloader/request_count': 130,
 'downloader/request_method_count/GET': 129,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 10043510,
 'downloader/response_count': 130,
 'downloader/response_status_count/200': 129,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 8, 4, 25, 151556),
 'log_count/DEBUG': 132,
 'log_count/ERROR': 116,
 'log_count/INFO': 10,
 'log_count/WARNING': 580,
 'request_depth_max': 5,
 'response_received_count': 129,
 'scheduler/dequeued': 130,
 'scheduler/dequeued/memory': 130,
 'scheduler/enqueued': 130,
 'scheduler/enqueued/memory': 130,
 'spider_exceptions/NameError': 87,
 'spider_exceptions/ValueError': 29,
 'start_time': datetime.datetime(2015, 9, 30, 8, 1, 24, 898985)}
2015-09-30 08:04:25 [scrapy] INFO: Spider closed (finished)
2015-09-30 08:09:51 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 08:09:51 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 08:09:51 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 08:09:51 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 08:09:52 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 08:09:52 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 08:09:52 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 08:09:52 [scrapy] INFO: Spider opened
2015-09-30 08:09:52 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 08:09:52 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 08:09:55 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 08:09:58 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 08:10:04 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 08:10:08 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 08:10:10 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 08:10:10 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 08:10:16 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:10:16 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:16 [root] WARNING: horse code set
2015-09-30 08:10:16 [root] WARNING: 1
2015-09-30 08:10:16 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:16 [root] WARNING: horse code set
2015-09-30 08:10:16 [root] WARNING: 2
2015-09-30 08:10:16 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:16 [root] WARNING: horse code set
2015-09-30 08:10:16 [root] WARNING: 3
2015-09-30 08:10:16 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:16 [root] WARNING: horse code set
2015-09-30 08:10:16 [root] WARNING: 4
2015-09-30 08:10:16 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:16 [root] WARNING: horse code set
2015-09-30 08:10:16 [root] WARNING: 5
2015-09-30 08:10:16 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:16 [root] WARNING: horse code set
2015-09-30 08:10:16 [root] WARNING: 6
2015-09-30 08:10:16 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:16 [root] WARNING: horse code set
2015-09-30 08:10:16 [root] WARNING: 7
2015-09-30 08:10:16 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:16 [root] WARNING: horse code set
2015-09-30 08:10:16 [root] WARNING: 8
2015-09-30 08:10:16 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:16 [root] WARNING: horse code set
2015-09-30 08:10:16 [root] WARNING: 9
2015-09-30 08:10:16 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:16 [root] WARNING: horse code set
2015-09-30 08:10:16 [root] WARNING: 10
2015-09-30 08:10:16 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:16 [root] WARNING: horse code set
2015-09-30 08:10:16 [root] WARNING: 11
2015-09-30 08:10:16 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:16 [root] WARNING: horse code set
2015-09-30 08:10:16 [root] WARNING: 12
2015-09-30 08:10:16 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:16 [root] WARNING: horse code set
2015-09-30 08:10:16 [root] WARNING: 13
2015-09-30 08:10:16 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:16 [root] WARNING: horse code set
2015-09-30 08:10:16 [root] WARNING: 14
2015-09-30 08:10:19 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:10:19 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:19 [root] WARNING: horse code set
2015-09-30 08:10:19 [root] WARNING: 15
2015-09-30 08:10:19 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:19 [root] WARNING: horse code set
2015-09-30 08:10:19 [root] WARNING: 16
2015-09-30 08:10:19 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:19 [root] WARNING: horse code set
2015-09-30 08:10:19 [root] WARNING: 17
2015-09-30 08:10:19 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:19 [root] WARNING: horse code set
2015-09-30 08:10:19 [root] WARNING: 18
2015-09-30 08:10:19 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:19 [root] WARNING: horse code set
2015-09-30 08:10:19 [root] WARNING: 19
2015-09-30 08:10:19 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:19 [root] WARNING: horse code set
2015-09-30 08:10:19 [root] WARNING: 20
2015-09-30 08:10:19 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:19 [root] WARNING: horse code set
2015-09-30 08:10:19 [root] WARNING: 21
2015-09-30 08:10:19 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:19 [root] WARNING: horse code set
2015-09-30 08:10:19 [root] WARNING: 22
2015-09-30 08:10:19 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:19 [root] WARNING: horse code set
2015-09-30 08:10:19 [root] WARNING: 23
2015-09-30 08:10:19 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:19 [root] WARNING: horse code set
2015-09-30 08:10:19 [root] WARNING: 24
2015-09-30 08:10:19 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:19 [root] WARNING: horse code set
2015-09-30 08:10:19 [root] WARNING: 25
2015-09-30 08:10:19 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:19 [root] WARNING: horse code set
2015-09-30 08:10:19 [root] WARNING: 26
2015-09-30 08:10:19 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:19 [root] WARNING: horse code set
2015-09-30 08:10:19 [root] WARNING: 27
2015-09-30 08:10:19 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:19 [root] WARNING: horse code set
2015-09-30 08:10:19 [root] WARNING: 28
2015-09-30 08:10:20 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:10:20 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:20 [root] WARNING: horse code set
2015-09-30 08:10:20 [root] WARNING: 29
2015-09-30 08:10:20 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:20 [root] WARNING: horse code set
2015-09-30 08:10:20 [root] WARNING: 30
2015-09-30 08:10:20 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:20 [root] WARNING: horse code set
2015-09-30 08:10:20 [root] WARNING: 31
2015-09-30 08:10:20 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:20 [root] WARNING: horse code set
2015-09-30 08:10:20 [root] WARNING: 32
2015-09-30 08:10:20 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:20 [root] WARNING: horse code set
2015-09-30 08:10:20 [root] WARNING: 33
2015-09-30 08:10:20 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:20 [root] WARNING: horse code set
2015-09-30 08:10:20 [root] WARNING: 34
2015-09-30 08:10:20 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:20 [root] WARNING: horse code set
2015-09-30 08:10:20 [root] WARNING: 35
2015-09-30 08:10:20 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:20 [root] WARNING: horse code set
2015-09-30 08:10:20 [root] WARNING: 36
2015-09-30 08:10:20 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:20 [root] WARNING: horse code set
2015-09-30 08:10:20 [root] WARNING: 37
2015-09-30 08:10:20 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:20 [root] WARNING: horse code set
2015-09-30 08:10:20 [root] WARNING: 38
2015-09-30 08:10:20 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:20 [root] WARNING: horse code set
2015-09-30 08:10:20 [root] WARNING: 39
2015-09-30 08:10:20 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:20 [root] WARNING: horse code set
2015-09-30 08:10:20 [root] WARNING: 40
2015-09-30 08:10:20 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:20 [root] WARNING: horse code set
2015-09-30 08:10:20 [root] WARNING: 41
2015-09-30 08:10:20 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:20 [root] WARNING: horse code set
2015-09-30 08:10:20 [root] WARNING: 42
2015-09-30 08:10:23 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:10:23 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:23 [root] WARNING: horse code set
2015-09-30 08:10:23 [root] WARNING: 43
2015-09-30 08:10:23 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:23 [root] WARNING: horse code set
2015-09-30 08:10:23 [root] WARNING: 44
2015-09-30 08:10:23 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:23 [root] WARNING: horse code set
2015-09-30 08:10:23 [root] WARNING: 45
2015-09-30 08:10:23 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:23 [root] WARNING: horse code set
2015-09-30 08:10:23 [root] WARNING: 46
2015-09-30 08:10:23 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:23 [root] WARNING: horse code set
2015-09-30 08:10:23 [root] WARNING: 47
2015-09-30 08:10:23 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:23 [root] WARNING: horse code set
2015-09-30 08:10:23 [root] WARNING: 48
2015-09-30 08:10:23 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:23 [root] WARNING: horse code set
2015-09-30 08:10:23 [root] WARNING: 49
2015-09-30 08:10:23 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:23 [root] WARNING: horse code set
2015-09-30 08:10:23 [root] WARNING: 50
2015-09-30 08:10:23 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:23 [root] WARNING: horse code set
2015-09-30 08:10:23 [root] WARNING: 51
2015-09-30 08:10:23 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:23 [root] WARNING: horse code set
2015-09-30 08:10:23 [root] WARNING: 52
2015-09-30 08:10:23 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:23 [root] WARNING: horse code set
2015-09-30 08:10:23 [root] WARNING: 53
2015-09-30 08:10:23 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:23 [root] WARNING: horse code set
2015-09-30 08:10:23 [root] WARNING: 54
2015-09-30 08:10:24 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:10:24 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:24 [root] WARNING: horse code set
2015-09-30 08:10:24 [root] WARNING: 55
2015-09-30 08:10:24 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:24 [root] WARNING: horse code set
2015-09-30 08:10:24 [root] WARNING: 56
2015-09-30 08:10:24 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:24 [root] WARNING: horse code set
2015-09-30 08:10:24 [root] WARNING: 57
2015-09-30 08:10:24 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:24 [root] WARNING: horse code set
2015-09-30 08:10:24 [root] WARNING: 58
2015-09-30 08:10:24 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:24 [root] WARNING: horse code set
2015-09-30 08:10:24 [root] WARNING: 59
2015-09-30 08:10:24 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:24 [root] WARNING: horse code set
2015-09-30 08:10:24 [root] WARNING: 60
2015-09-30 08:10:24 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:24 [root] WARNING: horse code set
2015-09-30 08:10:24 [root] WARNING: 61
2015-09-30 08:10:24 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:24 [root] WARNING: horse code set
2015-09-30 08:10:24 [root] WARNING: 62
2015-09-30 08:10:24 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:24 [root] WARNING: horse code set
2015-09-30 08:10:24 [root] WARNING: 63
2015-09-30 08:10:24 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:24 [root] WARNING: horse code set
2015-09-30 08:10:24 [root] WARNING: 64
2015-09-30 08:10:24 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:24 [root] WARNING: horse code set
2015-09-30 08:10:24 [root] WARNING: 65
2015-09-30 08:10:24 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:24 [root] WARNING: horse code set
2015-09-30 08:10:24 [root] WARNING: 66
2015-09-30 08:10:24 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:24 [root] WARNING: horse code set
2015-09-30 08:10:24 [root] WARNING: 67
2015-09-30 08:10:24 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:24 [root] WARNING: horse code set
2015-09-30 08:10:24 [root] WARNING: 68
2015-09-30 08:10:25 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:10:25 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:25 [root] WARNING: horse code set
2015-09-30 08:10:25 [root] WARNING: 69
2015-09-30 08:10:25 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:25 [root] WARNING: horse code set
2015-09-30 08:10:25 [root] WARNING: 70
2015-09-30 08:10:25 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:25 [root] WARNING: horse code set
2015-09-30 08:10:25 [root] WARNING: 71
2015-09-30 08:10:25 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:25 [root] WARNING: horse code set
2015-09-30 08:10:25 [root] WARNING: 72
2015-09-30 08:10:25 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:25 [root] WARNING: horse code set
2015-09-30 08:10:25 [root] WARNING: 73
2015-09-30 08:10:25 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:25 [root] WARNING: horse code set
2015-09-30 08:10:25 [root] WARNING: 74
2015-09-30 08:10:25 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:25 [root] WARNING: horse code set
2015-09-30 08:10:25 [root] WARNING: 75
2015-09-30 08:10:25 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:25 [root] WARNING: horse code set
2015-09-30 08:10:25 [root] WARNING: 76
2015-09-30 08:10:25 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:25 [root] WARNING: horse code set
2015-09-30 08:10:25 [root] WARNING: 77
2015-09-30 08:10:25 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:25 [root] WARNING: horse code set
2015-09-30 08:10:25 [root] WARNING: 78
2015-09-30 08:10:25 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:25 [root] WARNING: horse code set
2015-09-30 08:10:25 [root] WARNING: 79
2015-09-30 08:10:25 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:25 [root] WARNING: horse code set
2015-09-30 08:10:25 [root] WARNING: 80
2015-09-30 08:10:25 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:25 [root] WARNING: horse code set
2015-09-30 08:10:25 [root] WARNING: 81
2015-09-30 08:10:25 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:25 [root] WARNING: horse code set
2015-09-30 08:10:25 [root] WARNING: 82
2015-09-30 08:10:25 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:10:26 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:26 [root] WARNING: horse code set
2015-09-30 08:10:26 [root] WARNING: 83
2015-09-30 08:10:26 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:26 [root] WARNING: horse code set
2015-09-30 08:10:26 [root] WARNING: 84
2015-09-30 08:10:26 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:26 [root] WARNING: horse code set
2015-09-30 08:10:26 [root] WARNING: 85
2015-09-30 08:10:26 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:26 [root] WARNING: horse code set
2015-09-30 08:10:26 [root] WARNING: 86
2015-09-30 08:10:26 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:26 [root] WARNING: horse code set
2015-09-30 08:10:26 [root] WARNING: 87
2015-09-30 08:10:26 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:26 [root] WARNING: horse code set
2015-09-30 08:10:26 [root] WARNING: 88
2015-09-30 08:10:26 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:26 [root] WARNING: horse code set
2015-09-30 08:10:26 [root] WARNING: 89
2015-09-30 08:10:26 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:26 [root] WARNING: horse code set
2015-09-30 08:10:26 [root] WARNING: 90
2015-09-30 08:10:26 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:26 [root] WARNING: horse code set
2015-09-30 08:10:26 [root] WARNING: 91
2015-09-30 08:10:26 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:26 [root] WARNING: horse code set
2015-09-30 08:10:26 [root] WARNING: 92
2015-09-30 08:10:26 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:26 [root] WARNING: horse code set
2015-09-30 08:10:26 [root] WARNING: 93
2015-09-30 08:10:26 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:10:26 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:26 [root] WARNING: horse code set
2015-09-30 08:10:26 [root] WARNING: 94
2015-09-30 08:10:26 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:26 [root] WARNING: horse code set
2015-09-30 08:10:26 [root] WARNING: 95
2015-09-30 08:10:26 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:26 [root] WARNING: horse code set
2015-09-30 08:10:26 [root] WARNING: 96
2015-09-30 08:10:26 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:26 [root] WARNING: horse code set
2015-09-30 08:10:26 [root] WARNING: 97
2015-09-30 08:10:26 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:26 [root] WARNING: horse code set
2015-09-30 08:10:26 [root] WARNING: 98
2015-09-30 08:10:26 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:26 [root] WARNING: horse code set
2015-09-30 08:10:26 [root] WARNING: 99
2015-09-30 08:10:26 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:26 [root] WARNING: horse code set
2015-09-30 08:10:26 [root] WARNING: 100
2015-09-30 08:10:26 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:26 [root] WARNING: horse code set
2015-09-30 08:10:26 [root] WARNING: 101
2015-09-30 08:10:26 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:26 [root] WARNING: horse code set
2015-09-30 08:10:26 [root] WARNING: 102
2015-09-30 08:10:26 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:26 [root] WARNING: horse code set
2015-09-30 08:10:26 [root] WARNING: 103
2015-09-30 08:10:26 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:26 [root] WARNING: horse code set
2015-09-30 08:10:26 [root] WARNING: 104
2015-09-30 08:10:26 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:26 [root] WARNING: horse code set
2015-09-30 08:10:26 [root] WARNING: 105
2015-09-30 08:10:26 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:26 [root] WARNING: horse code set
2015-09-30 08:10:26 [root] WARNING: 106
2015-09-30 08:10:26 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:26 [root] WARNING: horse code set
2015-09-30 08:10:26 [root] WARNING: 107
2015-09-30 08:10:26 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:10:26 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:26 [root] WARNING: horse code set
2015-09-30 08:10:26 [root] WARNING: 108
2015-09-30 08:10:26 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:26 [root] WARNING: horse code set
2015-09-30 08:10:26 [root] WARNING: 109
2015-09-30 08:10:26 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:26 [root] WARNING: horse code set
2015-09-30 08:10:26 [root] WARNING: 110
2015-09-30 08:10:26 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:26 [root] WARNING: horse code set
2015-09-30 08:10:26 [root] WARNING: 111
2015-09-30 08:10:26 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:26 [root] WARNING: horse code set
2015-09-30 08:10:26 [root] WARNING: 112
2015-09-30 08:10:26 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:26 [root] WARNING: horse code set
2015-09-30 08:10:26 [root] WARNING: 113
2015-09-30 08:10:26 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:26 [root] WARNING: horse code set
2015-09-30 08:10:26 [root] WARNING: 114
2015-09-30 08:10:26 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:26 [root] WARNING: horse code set
2015-09-30 08:10:26 [root] WARNING: 115
2015-09-30 08:10:26 [root] WARNING: -------------------------------------------------
2015-09-30 08:10:26 [root] WARNING: horse code set
2015-09-30 08:10:26 [root] WARNING: 116
2015-09-30 08:10:34 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T238&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:10:34 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:10:34 [root] WARNING: 1
2015-09-30 08:10:34 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T238&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    pastraces[k].append( (_horsecode,p ))  #master dictionary to get an idea of key races
NameError: global name 'pastraces' is not defined
2015-09-30 08:10:34 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T009&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:10:34 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:10:34 [root] WARNING: 2
2015-09-30 08:10:34 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T009&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    pastraces[k].append( (_horsecode,p ))  #master dictionary to get an idea of key races
NameError: global name 'pastraces' is not defined
2015-09-30 08:10:39 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P372&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:10:39 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:10:39 [root] WARNING: 3
2015-09-30 08:10:39 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P372&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    pastraces[k].append( (_horsecode,p ))  #master dictionary to get an idea of key races
NameError: global name 'pastraces' is not defined
2015-09-30 08:10:40 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T200&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:10:40 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:10:40 [root] WARNING: 4
2015-09-30 08:10:40 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T200&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    pastraces[k].append( (_horsecode,p ))  #master dictionary to get an idea of key races
NameError: global name 'pastraces' is not defined
2015-09-30 08:10:43 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:10:43 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:10:43 [root] WARNING: 5
2015-09-30 08:10:43 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    pastraces[k].append( (_horsecode,p ))  #master dictionary to get an idea of key races
NameError: global name 'pastraces' is not defined
2015-09-30 08:10:45 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T288&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:10:45 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:10:45 [root] WARNING: 6
2015-09-30 08:10:45 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T288&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    pastraces[k].append( (_horsecode,p ))  #master dictionary to get an idea of key races
NameError: global name 'pastraces' is not defined
2015-09-30 08:10:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S022&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:10:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:10:46 [root] WARNING: 7
2015-09-30 08:10:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S022&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:10:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P103&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:10:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:10:47 [root] WARNING: 8
2015-09-30 08:10:48 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P103&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    pastraces[k].append( (_horsecode,p ))  #master dictionary to get an idea of key races
NameError: global name 'pastraces' is not defined
2015-09-30 08:10:50 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P222&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:10:50 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:10:50 [root] WARNING: 9
2015-09-30 08:10:50 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P222&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    pastraces[k].append( (_horsecode,p ))  #master dictionary to get an idea of key races
NameError: global name 'pastraces' is not defined
2015-09-30 08:10:52 [scrapy] INFO: Crawled 22 pages (at 22 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 08:10:54 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T135&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:10:54 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:10:54 [root] WARNING: 10
2015-09-30 08:10:54 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T135&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    pastraces[k].append( (_horsecode,p ))  #master dictionary to get an idea of key races
NameError: global name 'pastraces' is not defined
2015-09-30 08:10:55 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N033&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:10:55 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:10:55 [root] WARNING: 11
2015-09-30 08:10:55 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N033&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:10:56 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S305&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:10:56 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P158&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:10:56 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:10:56 [root] WARNING: 12
2015-09-30 08:10:56 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S305&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    pastraces[k].append( (_horsecode,p ))  #master dictionary to get an idea of key races
NameError: global name 'pastraces' is not defined
2015-09-30 08:10:56 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:10:56 [root] WARNING: 13
2015-09-30 08:10:57 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P158&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:10:59 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P031&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:10:59 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:10:59 [root] WARNING: 14
2015-09-30 08:10:59 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P031&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    pastraces[k].append( (_horsecode,p ))  #master dictionary to get an idea of key races
NameError: global name 'pastraces' is not defined
2015-09-30 08:11:01 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S346&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:11:01 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:11:01 [root] WARNING: 15
2015-09-30 08:11:01 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S346&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    pastraces[k].append( (_horsecode,p ))  #master dictionary to get an idea of key races
NameError: global name 'pastraces' is not defined
2015-09-30 08:11:05 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:11:05 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:11:05 [root] WARNING: 16
2015-09-30 08:11:05 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    pastraces[k].append( (_horsecode,p ))  #master dictionary to get an idea of key races
NameError: global name 'pastraces' is not defined
2015-09-30 08:11:10 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P358&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:11:10 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:11:10 [root] WARNING: 17
2015-09-30 08:11:10 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P358&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    pastraces[k].append( (_horsecode,p ))  #master dictionary to get an idea of key races
NameError: global name 'pastraces' is not defined
2015-09-30 08:11:10 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S076&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:11:10 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:11:10 [root] WARNING: 18
2015-09-30 08:11:10 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S076&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    pastraces[k].append( (_horsecode,p ))  #master dictionary to get an idea of key races
NameError: global name 'pastraces' is not defined
2015-09-30 08:11:22 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S100&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:11:23 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:11:23 [root] WARNING: 19
2015-09-30 08:11:23 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S100&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    pastraces[k].append( (_horsecode,p ))  #master dictionary to get an idea of key races
NameError: global name 'pastraces' is not defined
2015-09-30 08:11:25 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S332&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:11:25 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:11:25 [root] WARNING: 20
2015-09-30 08:11:25 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S332&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    pastraces[k].append( (_horsecode,p ))  #master dictionary to get an idea of key races
NameError: global name 'pastraces' is not defined
2015-09-30 08:11:26 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T080&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:11:26 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:11:26 [root] WARNING: 21
2015-09-30 08:11:26 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T080&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    pastraces[k].append( (_horsecode,p ))  #master dictionary to get an idea of key races
NameError: global name 'pastraces' is not defined
2015-09-30 08:11:28 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:11:28 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:11:28 [root] WARNING: 22
2015-09-30 08:11:28 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    pastraces[k].append( (_horsecode,p ))  #master dictionary to get an idea of key races
NameError: global name 'pastraces' is not defined
2015-09-30 08:11:29 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P151&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:11:29 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:11:29 [root] WARNING: 23
2015-09-30 08:11:30 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P151&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:11:36 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V061&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:11:36 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:11:36 [root] WARNING: 24
2015-09-30 08:11:36 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V061&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 780, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:11:36 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T005&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:11:36 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:11:36 [root] WARNING: 25
2015-09-30 08:11:36 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T005&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    pastraces[k].append( (_horsecode,p ))  #master dictionary to get an idea of key races
NameError: global name 'pastraces' is not defined
2015-09-30 08:11:38 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N234&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:11:38 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:11:38 [root] WARNING: 26
2015-09-30 08:11:38 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N234&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:11:38 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P044&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:11:38 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:11:38 [root] WARNING: 27
2015-09-30 08:11:39 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P044&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    pastraces[k].append( (_horsecode,p ))  #master dictionary to get an idea of key races
NameError: global name 'pastraces' is not defined
2015-09-30 08:11:42 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T342&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:11:42 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:11:42 [root] WARNING: 28
2015-09-30 08:11:42 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T342&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    pastraces[k].append( (_horsecode,p ))  #master dictionary to get an idea of key races
NameError: global name 'pastraces' is not defined
2015-09-30 08:11:42 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T205&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:11:42 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:11:42 [root] WARNING: 29
2015-09-30 08:11:42 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T205&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    pastraces[k].append( (_horsecode,p ))  #master dictionary to get an idea of key races
NameError: global name 'pastraces' is not defined
2015-09-30 08:11:43 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V039&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:11:43 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:11:43 [root] WARNING: 30
2015-09-30 08:11:43 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V039&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 780, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:11:44 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S023&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:11:44 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:11:44 [root] WARNING: 31
2015-09-30 08:11:44 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S023&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    pastraces[k].append( (_horsecode,p ))  #master dictionary to get an idea of key races
NameError: global name 'pastraces' is not defined
2015-09-30 08:11:45 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N330&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:11:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:11:46 [root] WARNING: 32
2015-09-30 08:11:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N330&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:11:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:11:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:11:47 [root] WARNING: 33
2015-09-30 08:11:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    pastraces[k].append( (_horsecode,p ))  #master dictionary to get an idea of key races
NameError: global name 'pastraces' is not defined
2015-09-30 08:11:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T333&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:11:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:11:47 [root] WARNING: 34
2015-09-30 08:11:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T333&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    pastraces[k].append( (_horsecode,p ))  #master dictionary to get an idea of key races
NameError: global name 'pastraces' is not defined
2015-09-30 08:11:52 [scrapy] INFO: Crawled 47 pages (at 25 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 08:11:53 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T340&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:11:53 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:11:53 [root] WARNING: 35
2015-09-30 08:11:53 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T340&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 780, in parse_horse
    print ("DISTANCE: {}, wins {}, places: {}, f4s: {}, avgftimes {} max, min, mean {}".\
IndexError: tuple index out of range
2015-09-30 08:11:55 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S397&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:11:55 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:11:55 [root] WARNING: 36
2015-09-30 08:11:55 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S397&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:11:55 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N226&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:11:56 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:11:56 [root] WARNING: 37
2015-09-30 08:11:56 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N226&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:11:59 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T168&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:11:59 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:11:59 [root] WARNING: 38
2015-09-30 08:11:59 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T168&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:11:59 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P097&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:11:59 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:11:59 [root] WARNING: 39
2015-09-30 08:11:59 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P097&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:12:01 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S209&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:12:01 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:12:01 [root] WARNING: 40
2015-09-30 08:12:01 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S209&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:12:06 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S300&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:12:06 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:12:06 [root] WARNING: 41
2015-09-30 08:12:06 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S300&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:12:08 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T002&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:12:08 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:12:08 [root] WARNING: 42
2015-09-30 08:12:08 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T002&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:12:09 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:12:09 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:12:09 [root] WARNING: 43
2015-09-30 08:12:09 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:12:17 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N220&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:12:17 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:12:17 [root] WARNING: 44
2015-09-30 08:12:17 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N220&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:12:19 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S375&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:12:19 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:12:19 [root] WARNING: 45
2015-09-30 08:12:19 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S375&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:12:24 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P316&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:12:24 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:12:24 [root] WARNING: 46
2015-09-30 08:12:24 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P316&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:12:24 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T111&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:12:24 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:12:24 [root] WARNING: 47
2015-09-30 08:12:24 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T111&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:12:27 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S225&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:12:27 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:12:27 [root] WARNING: 48
2015-09-30 08:12:27 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S225&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:12:29 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S165&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:12:29 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:12:29 [root] WARNING: 49
2015-09-30 08:12:29 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S165&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:12:30 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S415&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:12:30 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:12:30 [root] WARNING: 50
2015-09-30 08:12:30 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S415&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:12:33 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:12:33 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:12:33 [root] WARNING: 51
2015-09-30 08:12:33 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 780, in parse_horse
    print ("DISTANCE: {}, wins {}, places: {}, f4s: {}, avgftimes {} max, min, mean {}".\
IndexError: tuple index out of range
2015-09-30 08:12:35 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:12:35 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:12:35 [root] WARNING: 52
2015-09-30 08:12:35 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:12:36 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T289&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:12:36 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:12:36 [root] WARNING: 53
2015-09-30 08:12:36 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T289&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:12:37 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:12:37 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:12:37 [root] WARNING: 54
2015-09-30 08:12:38 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:12:38 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T379&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:12:38 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:12:38 [root] WARNING: 55
2015-09-30 08:12:38 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T379&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:12:42 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T265&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:12:42 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:12:42 [root] WARNING: 56
2015-09-30 08:12:42 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T265&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:12:42 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M227&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:12:42 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:12:42 [root] WARNING: 57
2015-09-30 08:12:43 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M227&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:12:43 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S394&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:12:43 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:12:43 [root] WARNING: 58
2015-09-30 08:12:43 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S394&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:12:43 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T050&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:12:43 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:12:43 [root] WARNING: 59
2015-09-30 08:12:43 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T050&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:12:44 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T129&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:12:44 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:12:44 [root] WARNING: 60
2015-09-30 08:12:44 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T129&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:12:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N419&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:12:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:12:46 [root] WARNING: 61
2015-09-30 08:12:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N419&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:12:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S275&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:12:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:12:46 [root] WARNING: 62
2015-09-30 08:12:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S275&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:12:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S421&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:12:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:12:47 [root] WARNING: 63
2015-09-30 08:12:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S421&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:12:48 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:12:48 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:12:48 [root] WARNING: 64
2015-09-30 08:12:48 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:12:49 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T004&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:12:50 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:12:50 [root] WARNING: 65
2015-09-30 08:12:50 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T004&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:12:50 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T404&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:12:50 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:12:50 [root] WARNING: 66
2015-09-30 08:12:50 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T404&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 780, in parse_horse
    print ("DISTANCE: {}, wins {}, places: {}, f4s: {}, avgftimes {} max, min, mean {}".\
IndexError: tuple index out of range
2015-09-30 08:12:52 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T215&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:12:52 [scrapy] INFO: Crawled 80 pages (at 33 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 08:12:52 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:12:52 [root] WARNING: 67
2015-09-30 08:12:52 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T215&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:12:58 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N432&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:12:59 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:12:59 [root] WARNING: 68
2015-09-30 08:12:59 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N432&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:13:03 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:13:03 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:13:03 [root] WARNING: 69
2015-09-30 08:13:03 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:13:07 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S349&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:13:07 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:13:07 [root] WARNING: 70
2015-09-30 08:13:07 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S349&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:13:10 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P173&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:13:10 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:13:10 [root] WARNING: 71
2015-09-30 08:13:10 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P173&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:13:11 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:13:11 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:13:11 [root] WARNING: 72
2015-09-30 08:13:11 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:13:12 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N386&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:13:12 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T235&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:13:12 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:13:12 [root] WARNING: 73
2015-09-30 08:13:12 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N386&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:13:12 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:13:12 [root] WARNING: 74
2015-09-30 08:13:12 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T235&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:13:15 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:13:15 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:13:15 [root] WARNING: 75
2015-09-30 08:13:15 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:13:15 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:13:16 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:13:16 [root] WARNING: 76
2015-09-30 08:13:16 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:13:16 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:13:16 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:13:16 [root] WARNING: 77
2015-09-30 08:13:17 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:13:23 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P195&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:13:23 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:13:23 [root] WARNING: 78
2015-09-30 08:13:23 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P195&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:13:29 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N297&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:13:30 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:13:30 [root] WARNING: 79
2015-09-30 08:13:30 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N297&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:13:30 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:13:31 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:13:31 [root] WARNING: 80
2015-09-30 08:13:31 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:13:31 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N171&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:13:31 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:13:31 [root] WARNING: 81
2015-09-30 08:13:32 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N171&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:13:32 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:13:33 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:13:33 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:13:33 [root] WARNING: 82
2015-09-30 08:13:33 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:13:33 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:13:33 [root] WARNING: 83
2015-09-30 08:13:33 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:13:35 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N236&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:13:35 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:13:35 [root] WARNING: 84
2015-09-30 08:13:35 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N236&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:13:38 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:13:38 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:13:38 [root] WARNING: 85
2015-09-30 08:13:38 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:13:38 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T257&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:13:38 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:13:38 [root] WARNING: 86
2015-09-30 08:13:38 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T257&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:13:39 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N434&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:13:39 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:13:39 [root] WARNING: 87
2015-09-30 08:13:39 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N434&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:13:40 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T256&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:13:40 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:13:40 [root] WARNING: 88
2015-09-30 08:13:40 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T256&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:13:43 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P180&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:13:44 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:13:44 [root] WARNING: 89
2015-09-30 08:13:44 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P180&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:13:44 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T093&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:13:44 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:13:44 [root] WARNING: 90
2015-09-30 08:13:44 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T093&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:13:49 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P111&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:13:49 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:13:49 [root] WARNING: 91
2015-09-30 08:13:49 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P111&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:13:50 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S278&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:13:50 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:13:50 [root] WARNING: 92
2015-09-30 08:13:50 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S278&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:13:51 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S420&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:13:51 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:13:51 [root] WARNING: 93
2015-09-30 08:13:51 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S420&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:13:51 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T170&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:13:52 [scrapy] INFO: Crawled 107 pages (at 27 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 08:13:52 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:13:52 [root] WARNING: 94
2015-09-30 08:13:52 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T170&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:13:53 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S296&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:13:53 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:13:53 [root] WARNING: 95
2015-09-30 08:13:53 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S296&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:13:55 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S282&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:13:56 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:13:56 [root] WARNING: 96
2015-09-30 08:13:56 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S282&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:13:56 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T112&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:13:56 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:13:56 [root] WARNING: 97
2015-09-30 08:13:56 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T112&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:13:56 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T148&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:13:56 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:13:56 [root] WARNING: 98
2015-09-30 08:13:56 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T148&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:14:06 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S391&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:14:06 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:14:06 [root] WARNING: 99
2015-09-30 08:14:06 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S391&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:14:08 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S109&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:14:08 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:14:08 [root] WARNING: 100
2015-09-30 08:14:08 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S109&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:14:08 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P366&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:14:08 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:14:08 [root] WARNING: 101
2015-09-30 08:14:09 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P366&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:14:11 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P191&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:14:11 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:14:11 [root] WARNING: 102
2015-09-30 08:14:11 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P191&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:14:11 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M199&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:14:11 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:14:11 [root] WARNING: 103
2015-09-30 08:14:12 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M199&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:14:12 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S145&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:14:12 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:14:12 [root] WARNING: 104
2015-09-30 08:14:12 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S145&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:14:20 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S117&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:14:21 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:14:21 [root] WARNING: 105
2015-09-30 08:14:21 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S117&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:14:21 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N394&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:14:21 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:14:21 [root] WARNING: 106
2015-09-30 08:14:21 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N394&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:14:22 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T096&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:14:22 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:14:22 [root] WARNING: 107
2015-09-30 08:14:22 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T096&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:14:26 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:14:26 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:14:26 [root] WARNING: 108
2015-09-30 08:14:26 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:14:26 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N169&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:14:27 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:14:27 [root] WARNING: 109
2015-09-30 08:14:27 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N169&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:14:27 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S110&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:14:27 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:14:27 [root] WARNING: 110
2015-09-30 08:14:27 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S110&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:14:28 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P118&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:14:28 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:14:28 [root] WARNING: 111
2015-09-30 08:14:28 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P118&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:14:29 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S010&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:14:29 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:14:29 [root] WARNING: 112
2015-09-30 08:14:29 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S010&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:14:30 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T398&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:14:30 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:14:30 [root] WARNING: 113
2015-09-30 08:14:30 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T398&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 780, in parse_horse
    print ("DISTANCE: {}, wins {}, places: {}, f4s: {}, avgftimes {} max, min, mean {}".\
IndexError: tuple index out of range
2015-09-30 08:14:30 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N195&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:14:31 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:14:31 [root] WARNING: 114
2015-09-30 08:14:31 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N195&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 628, in parse_horse
    
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:14:31 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S439&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:14:31 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:14:31 [root] WARNING: 115
2015-09-30 08:14:31 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S439&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:14:31 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S398&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:14:31 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:14:31 [root] WARNING: 116
2015-09-30 08:14:31 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S398&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 735, in parse_horse
    for k, p in zip(pastraces_keys, weights_performances):
NameError: global name 'pastraces' is not defined
2015-09-30 08:14:31 [scrapy] INFO: Closing spider (finished)
2015-09-30 08:14:31 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 65520,
 'downloader/request_count': 130,
 'downloader/request_method_count/GET': 129,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 10042511,
 'downloader/response_count': 130,
 'downloader/response_status_count/200': 129,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 8, 14, 31, 834182),
 'log_count/DEBUG': 132,
 'log_count/ERROR': 116,
 'log_count/INFO': 11,
 'log_count/WARNING': 580,
 'request_depth_max': 5,
 'response_received_count': 129,
 'scheduler/dequeued': 130,
 'scheduler/dequeued/memory': 130,
 'scheduler/enqueued': 130,
 'scheduler/enqueued/memory': 130,
 'spider_exceptions/IndexError': 6,
 'spider_exceptions/NameError': 81,
 'spider_exceptions/ValueError': 29,
 'start_time': datetime.datetime(2015, 9, 30, 8, 9, 52, 6481)}
2015-09-30 08:14:31 [scrapy] INFO: Spider closed (finished)
2015-09-30 08:16:22 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 08:16:22 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 08:16:22 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 08:16:22 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 08:16:22 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 08:16:22 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 08:16:22 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 08:16:22 [scrapy] INFO: Spider opened
2015-09-30 08:16:22 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 08:16:22 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 08:16:24 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 08:16:29 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 08:16:35 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 08:16:39 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 08:16:40 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 08:16:40 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 08:16:44 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:16:45 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:45 [root] WARNING: horse code set
2015-09-30 08:16:45 [root] WARNING: 1
2015-09-30 08:16:45 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:45 [root] WARNING: horse code set
2015-09-30 08:16:45 [root] WARNING: 2
2015-09-30 08:16:45 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:45 [root] WARNING: horse code set
2015-09-30 08:16:45 [root] WARNING: 3
2015-09-30 08:16:45 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:45 [root] WARNING: horse code set
2015-09-30 08:16:45 [root] WARNING: 4
2015-09-30 08:16:45 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:45 [root] WARNING: horse code set
2015-09-30 08:16:45 [root] WARNING: 5
2015-09-30 08:16:45 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:45 [root] WARNING: horse code set
2015-09-30 08:16:45 [root] WARNING: 6
2015-09-30 08:16:45 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:45 [root] WARNING: horse code set
2015-09-30 08:16:45 [root] WARNING: 7
2015-09-30 08:16:45 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:45 [root] WARNING: horse code set
2015-09-30 08:16:45 [root] WARNING: 8
2015-09-30 08:16:45 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:45 [root] WARNING: horse code set
2015-09-30 08:16:45 [root] WARNING: 9
2015-09-30 08:16:45 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:45 [root] WARNING: horse code set
2015-09-30 08:16:45 [root] WARNING: 10
2015-09-30 08:16:45 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:45 [root] WARNING: horse code set
2015-09-30 08:16:45 [root] WARNING: 11
2015-09-30 08:16:45 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:45 [root] WARNING: horse code set
2015-09-30 08:16:45 [root] WARNING: 12
2015-09-30 08:16:45 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:45 [root] WARNING: horse code set
2015-09-30 08:16:45 [root] WARNING: 13
2015-09-30 08:16:45 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:45 [root] WARNING: horse code set
2015-09-30 08:16:45 [root] WARNING: 14
2015-09-30 08:16:49 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:16:49 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:49 [root] WARNING: horse code set
2015-09-30 08:16:49 [root] WARNING: 15
2015-09-30 08:16:49 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:49 [root] WARNING: horse code set
2015-09-30 08:16:49 [root] WARNING: 16
2015-09-30 08:16:49 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:49 [root] WARNING: horse code set
2015-09-30 08:16:49 [root] WARNING: 17
2015-09-30 08:16:49 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:49 [root] WARNING: horse code set
2015-09-30 08:16:49 [root] WARNING: 18
2015-09-30 08:16:49 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:49 [root] WARNING: horse code set
2015-09-30 08:16:49 [root] WARNING: 19
2015-09-30 08:16:49 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:49 [root] WARNING: horse code set
2015-09-30 08:16:49 [root] WARNING: 20
2015-09-30 08:16:49 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:49 [root] WARNING: horse code set
2015-09-30 08:16:49 [root] WARNING: 21
2015-09-30 08:16:49 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:49 [root] WARNING: horse code set
2015-09-30 08:16:49 [root] WARNING: 22
2015-09-30 08:16:49 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:49 [root] WARNING: horse code set
2015-09-30 08:16:49 [root] WARNING: 23
2015-09-30 08:16:49 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:49 [root] WARNING: horse code set
2015-09-30 08:16:49 [root] WARNING: 24
2015-09-30 08:16:49 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:49 [root] WARNING: horse code set
2015-09-30 08:16:49 [root] WARNING: 25
2015-09-30 08:16:49 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:49 [root] WARNING: horse code set
2015-09-30 08:16:49 [root] WARNING: 26
2015-09-30 08:16:49 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:49 [root] WARNING: horse code set
2015-09-30 08:16:49 [root] WARNING: 27
2015-09-30 08:16:49 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:49 [root] WARNING: horse code set
2015-09-30 08:16:49 [root] WARNING: 28
2015-09-30 08:16:50 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:16:50 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:50 [root] WARNING: horse code set
2015-09-30 08:16:50 [root] WARNING: 29
2015-09-30 08:16:50 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:50 [root] WARNING: horse code set
2015-09-30 08:16:50 [root] WARNING: 30
2015-09-30 08:16:50 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:50 [root] WARNING: horse code set
2015-09-30 08:16:50 [root] WARNING: 31
2015-09-30 08:16:50 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:50 [root] WARNING: horse code set
2015-09-30 08:16:50 [root] WARNING: 32
2015-09-30 08:16:50 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:50 [root] WARNING: horse code set
2015-09-30 08:16:50 [root] WARNING: 33
2015-09-30 08:16:50 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:50 [root] WARNING: horse code set
2015-09-30 08:16:50 [root] WARNING: 34
2015-09-30 08:16:50 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:50 [root] WARNING: horse code set
2015-09-30 08:16:50 [root] WARNING: 35
2015-09-30 08:16:50 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:50 [root] WARNING: horse code set
2015-09-30 08:16:50 [root] WARNING: 36
2015-09-30 08:16:50 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:50 [root] WARNING: horse code set
2015-09-30 08:16:50 [root] WARNING: 37
2015-09-30 08:16:50 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:50 [root] WARNING: horse code set
2015-09-30 08:16:50 [root] WARNING: 38
2015-09-30 08:16:50 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:50 [root] WARNING: horse code set
2015-09-30 08:16:50 [root] WARNING: 39
2015-09-30 08:16:50 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:50 [root] WARNING: horse code set
2015-09-30 08:16:50 [root] WARNING: 40
2015-09-30 08:16:50 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:50 [root] WARNING: horse code set
2015-09-30 08:16:50 [root] WARNING: 41
2015-09-30 08:16:50 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:50 [root] WARNING: horse code set
2015-09-30 08:16:50 [root] WARNING: 42
2015-09-30 08:16:52 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:16:52 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:52 [root] WARNING: horse code set
2015-09-30 08:16:52 [root] WARNING: 43
2015-09-30 08:16:52 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:52 [root] WARNING: horse code set
2015-09-30 08:16:52 [root] WARNING: 44
2015-09-30 08:16:52 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:52 [root] WARNING: horse code set
2015-09-30 08:16:52 [root] WARNING: 45
2015-09-30 08:16:52 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:52 [root] WARNING: horse code set
2015-09-30 08:16:52 [root] WARNING: 46
2015-09-30 08:16:52 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:52 [root] WARNING: horse code set
2015-09-30 08:16:52 [root] WARNING: 47
2015-09-30 08:16:52 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:52 [root] WARNING: horse code set
2015-09-30 08:16:52 [root] WARNING: 48
2015-09-30 08:16:52 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:52 [root] WARNING: horse code set
2015-09-30 08:16:52 [root] WARNING: 49
2015-09-30 08:16:52 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:52 [root] WARNING: horse code set
2015-09-30 08:16:52 [root] WARNING: 50
2015-09-30 08:16:52 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:52 [root] WARNING: horse code set
2015-09-30 08:16:52 [root] WARNING: 51
2015-09-30 08:16:52 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:52 [root] WARNING: horse code set
2015-09-30 08:16:52 [root] WARNING: 52
2015-09-30 08:16:52 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:52 [root] WARNING: horse code set
2015-09-30 08:16:52 [root] WARNING: 53
2015-09-30 08:16:52 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:52 [root] WARNING: horse code set
2015-09-30 08:16:52 [root] WARNING: 54
2015-09-30 08:16:52 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:16:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:53 [root] WARNING: horse code set
2015-09-30 08:16:53 [root] WARNING: 55
2015-09-30 08:16:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:53 [root] WARNING: horse code set
2015-09-30 08:16:53 [root] WARNING: 56
2015-09-30 08:16:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:53 [root] WARNING: horse code set
2015-09-30 08:16:53 [root] WARNING: 57
2015-09-30 08:16:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:53 [root] WARNING: horse code set
2015-09-30 08:16:53 [root] WARNING: 58
2015-09-30 08:16:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:53 [root] WARNING: horse code set
2015-09-30 08:16:53 [root] WARNING: 59
2015-09-30 08:16:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:53 [root] WARNING: horse code set
2015-09-30 08:16:53 [root] WARNING: 60
2015-09-30 08:16:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:53 [root] WARNING: horse code set
2015-09-30 08:16:53 [root] WARNING: 61
2015-09-30 08:16:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:53 [root] WARNING: horse code set
2015-09-30 08:16:53 [root] WARNING: 62
2015-09-30 08:16:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:53 [root] WARNING: horse code set
2015-09-30 08:16:53 [root] WARNING: 63
2015-09-30 08:16:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:53 [root] WARNING: horse code set
2015-09-30 08:16:53 [root] WARNING: 64
2015-09-30 08:16:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:53 [root] WARNING: horse code set
2015-09-30 08:16:53 [root] WARNING: 65
2015-09-30 08:16:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:53 [root] WARNING: horse code set
2015-09-30 08:16:53 [root] WARNING: 66
2015-09-30 08:16:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:53 [root] WARNING: horse code set
2015-09-30 08:16:53 [root] WARNING: 67
2015-09-30 08:16:53 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:53 [root] WARNING: horse code set
2015-09-30 08:16:53 [root] WARNING: 68
2015-09-30 08:16:54 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:16:54 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:16:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:54 [root] WARNING: horse code set
2015-09-30 08:16:54 [root] WARNING: 69
2015-09-30 08:16:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:54 [root] WARNING: horse code set
2015-09-30 08:16:54 [root] WARNING: 70
2015-09-30 08:16:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:54 [root] WARNING: horse code set
2015-09-30 08:16:54 [root] WARNING: 71
2015-09-30 08:16:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:54 [root] WARNING: horse code set
2015-09-30 08:16:54 [root] WARNING: 72
2015-09-30 08:16:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:54 [root] WARNING: horse code set
2015-09-30 08:16:54 [root] WARNING: 73
2015-09-30 08:16:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:54 [root] WARNING: horse code set
2015-09-30 08:16:54 [root] WARNING: 74
2015-09-30 08:16:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:54 [root] WARNING: horse code set
2015-09-30 08:16:54 [root] WARNING: 75
2015-09-30 08:16:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:54 [root] WARNING: horse code set
2015-09-30 08:16:54 [root] WARNING: 76
2015-09-30 08:16:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:54 [root] WARNING: horse code set
2015-09-30 08:16:54 [root] WARNING: 77
2015-09-30 08:16:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:54 [root] WARNING: horse code set
2015-09-30 08:16:54 [root] WARNING: 78
2015-09-30 08:16:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:54 [root] WARNING: horse code set
2015-09-30 08:16:54 [root] WARNING: 79
2015-09-30 08:16:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:54 [root] WARNING: horse code set
2015-09-30 08:16:54 [root] WARNING: 80
2015-09-30 08:16:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:54 [root] WARNING: horse code set
2015-09-30 08:16:54 [root] WARNING: 81
2015-09-30 08:16:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:54 [root] WARNING: horse code set
2015-09-30 08:16:54 [root] WARNING: 82
2015-09-30 08:16:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:54 [root] WARNING: horse code set
2015-09-30 08:16:54 [root] WARNING: 83
2015-09-30 08:16:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:54 [root] WARNING: horse code set
2015-09-30 08:16:54 [root] WARNING: 84
2015-09-30 08:16:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:54 [root] WARNING: horse code set
2015-09-30 08:16:54 [root] WARNING: 85
2015-09-30 08:16:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:54 [root] WARNING: horse code set
2015-09-30 08:16:54 [root] WARNING: 86
2015-09-30 08:16:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:54 [root] WARNING: horse code set
2015-09-30 08:16:54 [root] WARNING: 87
2015-09-30 08:16:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:54 [root] WARNING: horse code set
2015-09-30 08:16:54 [root] WARNING: 88
2015-09-30 08:16:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:54 [root] WARNING: horse code set
2015-09-30 08:16:54 [root] WARNING: 89
2015-09-30 08:16:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:54 [root] WARNING: horse code set
2015-09-30 08:16:54 [root] WARNING: 90
2015-09-30 08:16:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:54 [root] WARNING: horse code set
2015-09-30 08:16:54 [root] WARNING: 91
2015-09-30 08:16:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:54 [root] WARNING: horse code set
2015-09-30 08:16:54 [root] WARNING: 92
2015-09-30 08:16:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:54 [root] WARNING: horse code set
2015-09-30 08:16:54 [root] WARNING: 93
2015-09-30 08:16:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:54 [root] WARNING: horse code set
2015-09-30 08:16:54 [root] WARNING: 94
2015-09-30 08:16:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:54 [root] WARNING: horse code set
2015-09-30 08:16:54 [root] WARNING: 95
2015-09-30 08:16:54 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:54 [root] WARNING: horse code set
2015-09-30 08:16:54 [root] WARNING: 96
2015-09-30 08:16:55 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:16:55 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:55 [root] WARNING: horse code set
2015-09-30 08:16:55 [root] WARNING: 97
2015-09-30 08:16:55 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:55 [root] WARNING: horse code set
2015-09-30 08:16:55 [root] WARNING: 98
2015-09-30 08:16:55 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:55 [root] WARNING: horse code set
2015-09-30 08:16:55 [root] WARNING: 99
2015-09-30 08:16:55 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:55 [root] WARNING: horse code set
2015-09-30 08:16:55 [root] WARNING: 100
2015-09-30 08:16:55 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:55 [root] WARNING: horse code set
2015-09-30 08:16:55 [root] WARNING: 101
2015-09-30 08:16:55 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:55 [root] WARNING: horse code set
2015-09-30 08:16:55 [root] WARNING: 102
2015-09-30 08:16:55 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:55 [root] WARNING: horse code set
2015-09-30 08:16:55 [root] WARNING: 103
2015-09-30 08:16:55 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:55 [root] WARNING: horse code set
2015-09-30 08:16:55 [root] WARNING: 104
2015-09-30 08:16:55 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:55 [root] WARNING: horse code set
2015-09-30 08:16:55 [root] WARNING: 105
2015-09-30 08:16:55 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:55 [root] WARNING: horse code set
2015-09-30 08:16:55 [root] WARNING: 106
2015-09-30 08:16:55 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:55 [root] WARNING: horse code set
2015-09-30 08:16:55 [root] WARNING: 107
2015-09-30 08:16:56 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:16:56 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:56 [root] WARNING: horse code set
2015-09-30 08:16:56 [root] WARNING: 108
2015-09-30 08:16:56 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:56 [root] WARNING: horse code set
2015-09-30 08:16:56 [root] WARNING: 109
2015-09-30 08:16:56 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:56 [root] WARNING: horse code set
2015-09-30 08:16:56 [root] WARNING: 110
2015-09-30 08:16:56 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:56 [root] WARNING: horse code set
2015-09-30 08:16:56 [root] WARNING: 111
2015-09-30 08:16:56 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:56 [root] WARNING: horse code set
2015-09-30 08:16:56 [root] WARNING: 112
2015-09-30 08:16:56 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:56 [root] WARNING: horse code set
2015-09-30 08:16:56 [root] WARNING: 113
2015-09-30 08:16:56 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:56 [root] WARNING: horse code set
2015-09-30 08:16:56 [root] WARNING: 114
2015-09-30 08:16:56 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:56 [root] WARNING: horse code set
2015-09-30 08:16:56 [root] WARNING: 115
2015-09-30 08:16:56 [root] WARNING: -------------------------------------------------
2015-09-30 08:16:56 [root] WARNING: horse code set
2015-09-30 08:16:56 [root] WARNING: 116
2015-09-30 08:16:59 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:16:59 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:16:59 [root] WARNING: 1
2015-09-30 08:16:59 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:17:01 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T200&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:17:01 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:01 [root] WARNING: 2
2015-09-30 08:17:01 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T200&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:17:02 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T398&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:17:02 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:02 [root] WARNING: 3
2015-09-30 08:17:02 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T398&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:17:02 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T238&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:17:03 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:03 [root] WARNING: 4
2015-09-30 08:17:03 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T238&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:17:04 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S022&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:17:04 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:04 [root] WARNING: 5
2015-09-30 08:17:04 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S022&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:17:06 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T009&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:17:06 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:06 [root] WARNING: 6
2015-09-30 08:17:06 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T009&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:17:07 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T288&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:17:07 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:07 [root] WARNING: 7
2015-09-30 08:17:07 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T288&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:17:09 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P372&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:17:09 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:09 [root] WARNING: 8
2015-09-30 08:17:09 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P372&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:17:09 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P222&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:17:09 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:09 [root] WARNING: 9
2015-09-30 08:17:09 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P222&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:17:11 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P158&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:17:11 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:11 [root] WARNING: 10
2015-09-30 08:17:11 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P158&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:17:11 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N033&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:17:11 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:11 [root] WARNING: 11
2015-09-30 08:17:12 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N033&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:17:13 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T135&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:17:13 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:13 [root] WARNING: 12
2015-09-30 08:17:13 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T135&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:17:14 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S305&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:17:14 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:14 [root] WARNING: 13
2015-09-30 08:17:14 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S305&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:17:14 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:17:14 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:14 [root] WARNING: 14
2015-09-30 08:17:14 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:17:16 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S346&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:17:17 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:17 [root] WARNING: 15
2015-09-30 08:17:17 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S346&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:17:17 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P031&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:17:17 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:17 [root] WARNING: 16
2015-09-30 08:17:17 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P031&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:17:18 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P358&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:17:18 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:18 [root] WARNING: 17
2015-09-30 08:17:18 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P358&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:17:21 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:17:21 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:21 [root] WARNING: 18
2015-09-30 08:17:21 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:17:22 [scrapy] INFO: Crawled 31 pages (at 31 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 08:17:27 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S076&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:17:27 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:27 [root] WARNING: 19
2015-09-30 08:17:27 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S076&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:17:28 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:17:28 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:28 [root] WARNING: 20
2015-09-30 08:17:28 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:17:28 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S332&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:17:28 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:28 [root] WARNING: 21
2015-09-30 08:17:28 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S332&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:17:28 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S100&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:17:28 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:28 [root] WARNING: 22
2015-09-30 08:17:28 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S100&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:17:30 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T168&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:17:31 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:31 [root] WARNING: 23
2015-09-30 08:17:31 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T168&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:17:31 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P151&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:17:31 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:31 [root] WARNING: 24
2015-09-30 08:17:31 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P151&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:17:33 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S023&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:17:33 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:33 [root] WARNING: 25
2015-09-30 08:17:33 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S023&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:17:33 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P044&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:17:33 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:33 [root] WARNING: 26
2015-09-30 08:17:34 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P044&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:17:35 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S300&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:17:35 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:35 [root] WARNING: 27
2015-09-30 08:17:35 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S300&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:17:36 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S209&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:17:36 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:36 [root] WARNING: 28
2015-09-30 08:17:36 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S209&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:17:39 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T002&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:17:39 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:39 [root] WARNING: 29
2015-09-30 08:17:39 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T002&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:17:44 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:17:44 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:44 [root] WARNING: 30
2015-09-30 08:17:44 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:17:45 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N220&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:17:45 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:45 [root] WARNING: 31
2015-09-30 08:17:45 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N220&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:17:45 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:17:45 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T265&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:17:45 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:45 [root] WARNING: 32
2015-09-30 08:17:45 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:17:45 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:45 [root] WARNING: 33
2015-09-30 08:17:45 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T265&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:17:45 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S375&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:17:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:46 [root] WARNING: 34
2015-09-30 08:17:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S375&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:17:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P316&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:17:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:47 [root] WARNING: 35
2015-09-30 08:17:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P316&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:17:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S421&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:17:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:47 [root] WARNING: 36
2015-09-30 08:17:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S421&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:17:50 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T004&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:17:51 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:51 [root] WARNING: 37
2015-09-30 08:17:51 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T004&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:17:55 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T404&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:17:55 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:55 [root] WARNING: 38
2015-09-30 08:17:55 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T404&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:17:58 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T215&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:17:59 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:17:59 [root] WARNING: 39
2015-09-30 08:17:59 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T215&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:18:01 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M227&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:18:01 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:01 [root] WARNING: 40
2015-09-30 08:18:01 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M227&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:18:03 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N432&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:18:03 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:18:03 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:03 [root] WARNING: 41
2015-09-30 08:18:03 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N432&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:18:03 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:03 [root] WARNING: 42
2015-09-30 08:18:03 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:18:05 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S349&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:18:05 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:05 [root] WARNING: 43
2015-09-30 08:18:05 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S349&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:18:05 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N386&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:18:05 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:05 [root] WARNING: 44
2015-09-30 08:18:05 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N386&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:18:06 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:18:06 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:06 [root] WARNING: 45
2015-09-30 08:18:06 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:18:07 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:18:07 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:07 [root] WARNING: 46
2015-09-30 08:18:07 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:18:07 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P173&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:18:08 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:08 [root] WARNING: 47
2015-09-30 08:18:08 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P173&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:18:14 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T080&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:18:14 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:14 [root] WARNING: 48
2015-09-30 08:18:14 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T080&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:18:17 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T005&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:18:17 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:17 [root] WARNING: 49
2015-09-30 08:18:17 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T005&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:18:18 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T205&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:18:18 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:18 [root] WARNING: 50
2015-09-30 08:18:18 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T205&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:18:19 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V061&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:18:19 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:19 [root] WARNING: 51
2015-09-30 08:18:19 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V061&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:18:19 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:18:19 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:19 [root] WARNING: 52
2015-09-30 08:18:19 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:18:22 [scrapy] INFO: Crawled 65 pages (at 34 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 08:18:22 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V039&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:18:22 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:22 [root] WARNING: 53
2015-09-30 08:18:22 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V039&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:18:23 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T342&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:18:23 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:23 [root] WARNING: 54
2015-09-30 08:18:23 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T342&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:18:25 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N330&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:18:25 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:25 [root] WARNING: 55
2015-09-30 08:18:25 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N330&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:18:25 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N234&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:18:25 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:25 [root] WARNING: 56
2015-09-30 08:18:25 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N234&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:18:26 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:18:26 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:26 [root] WARNING: 57
2015-09-30 08:18:26 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:18:27 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T340&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:18:27 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:27 [root] WARNING: 58
2015-09-30 08:18:27 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T340&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:18:27 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T333&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:18:27 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:27 [root] WARNING: 59
2015-09-30 08:18:27 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T333&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:18:32 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N226&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:18:33 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:33 [root] WARNING: 60
2015-09-30 08:18:33 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N226&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:18:34 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P097&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:18:34 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:34 [root] WARNING: 61
2015-09-30 08:18:34 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P097&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:18:35 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S165&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:18:35 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:35 [root] WARNING: 62
2015-09-30 08:18:35 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S165&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:18:37 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S397&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:18:37 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T111&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:18:37 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:37 [root] WARNING: 63
2015-09-30 08:18:37 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S397&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:18:37 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:37 [root] WARNING: 64
2015-09-30 08:18:37 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T111&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:18:37 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:18:37 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:37 [root] WARNING: 65
2015-09-30 08:18:37 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:18:40 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T379&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:18:40 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:40 [root] WARNING: 66
2015-09-30 08:18:40 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T379&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:18:40 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T289&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:18:40 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:40 [root] WARNING: 67
2015-09-30 08:18:40 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T289&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:18:41 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S225&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:18:41 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:41 [root] WARNING: 68
2015-09-30 08:18:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S225&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:18:42 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S415&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:18:42 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:42 [root] WARNING: 69
2015-09-30 08:18:42 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S415&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:18:42 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N419&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:18:42 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:42 [root] WARNING: 70
2015-09-30 08:18:42 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N419&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:18:45 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T050&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:18:45 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:45 [root] WARNING: 71
2015-09-30 08:18:45 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T050&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:18:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T129&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:18:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:46 [root] WARNING: 72
2015-09-30 08:18:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T129&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:18:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:18:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:47 [root] WARNING: 73
2015-09-30 08:18:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:18:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S394&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:18:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:47 [root] WARNING: 74
2015-09-30 08:18:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S394&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:18:48 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S275&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:18:48 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:48 [root] WARNING: 75
2015-09-30 08:18:48 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S275&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:18:49 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:18:49 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:49 [root] WARNING: 76
2015-09-30 08:18:49 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:18:49 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T235&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:18:49 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:49 [root] WARNING: 77
2015-09-30 08:18:49 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T235&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:18:59 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N171&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:18:59 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:59 [root] WARNING: 78
2015-09-30 08:18:59 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N171&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:18:59 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P195&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:18:59 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:18:59 [root] WARNING: 79
2015-09-30 08:18:59 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P195&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:19:00 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N236&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:19:00 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:19:00 [root] WARNING: 80
2015-09-30 08:19:00 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N236&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:19:00 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:19:00 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:19:00 [root] WARNING: 81
2015-09-30 08:19:00 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:19:02 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P180&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:19:02 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:19:02 [root] WARNING: 82
2015-09-30 08:19:02 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P180&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:19:02 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:19:03 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:19:03 [root] WARNING: 83
2015-09-30 08:19:03 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:19:05 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N297&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:19:05 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:19:05 [root] WARNING: 84
2015-09-30 08:19:05 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N297&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:19:08 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:19:08 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:19:08 [root] WARNING: 85
2015-09-30 08:19:08 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:19:09 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:19:10 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:19:10 [root] WARNING: 86
2015-09-30 08:19:10 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:19:10 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T257&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:19:10 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:19:10 [root] WARNING: 87
2015-09-30 08:19:10 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T257&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:19:10 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N434&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:19:10 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:19:10 [root] WARNING: 88
2015-09-30 08:19:10 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N434&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:19:15 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T256&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:19:15 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:19:15 [root] WARNING: 89
2015-09-30 08:19:15 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T256&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:19:15 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M199&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:19:15 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:19:15 [root] WARNING: 90
2015-09-30 08:19:16 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M199&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:19:17 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T093&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:19:17 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:19:17 [root] WARNING: 91
2015-09-30 08:19:17 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T093&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:19:19 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S296&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:19:20 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:19:20 [root] WARNING: 92
2015-09-30 08:19:20 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S296&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:19:22 [scrapy] INFO: Crawled 105 pages (at 40 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 08:19:22 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S420&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:19:22 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:19:22 [root] WARNING: 93
2015-09-30 08:19:22 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S420&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:19:23 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P111&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:19:24 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:19:24 [root] WARNING: 94
2015-09-30 08:19:24 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P111&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:19:25 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S278&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:19:25 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:19:25 [root] WARNING: 95
2015-09-30 08:19:25 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S278&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:19:25 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T170&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:19:25 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:19:25 [root] WARNING: 96
2015-09-30 08:19:25 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T170&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:19:28 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T112&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:19:29 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:19:29 [root] WARNING: 97
2015-09-30 08:19:29 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T112&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:19:30 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T148&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:19:30 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:19:30 [root] WARNING: 98
2015-09-30 08:19:30 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T148&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:19:34 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S282&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:19:34 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:19:34 [root] WARNING: 99
2015-09-30 08:19:34 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S282&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:19:37 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S391&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:19:38 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:19:38 [root] WARNING: 100
2015-09-30 08:19:38 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S391&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:19:40 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N394&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:19:40 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:19:40 [root] WARNING: 101
2015-09-30 08:19:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N394&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:19:41 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S109&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:19:41 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:19:41 [root] WARNING: 102
2015-09-30 08:19:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S109&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:19:41 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S145&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:19:42 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:19:42 [root] WARNING: 103
2015-09-30 08:19:42 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S145&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:19:44 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P118&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:19:44 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:19:44 [root] WARNING: 104
2015-09-30 08:19:45 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P118&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:19:48 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P366&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:19:48 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:19:48 [root] WARNING: 105
2015-09-30 08:19:48 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P366&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:19:49 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N169&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:19:49 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:19:49 [root] WARNING: 106
2015-09-30 08:19:49 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N169&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:19:49 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P191&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:19:49 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:19:49 [root] WARNING: 107
2015-09-30 08:19:49 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P191&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:19:49 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S110&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:19:50 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:19:50 [root] WARNING: 108
2015-09-30 08:19:50 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S110&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:19:51 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:19:51 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:19:51 [root] WARNING: 109
2015-09-30 08:19:51 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:19:51 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S117&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:19:51 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:19:51 [root] WARNING: 110
2015-09-30 08:19:51 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S117&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:19:53 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T096&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:19:53 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:19:53 [root] WARNING: 111
2015-09-30 08:19:53 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T096&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:19:55 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S010&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:19:55 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:19:55 [root] WARNING: 112
2015-09-30 08:19:55 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S010&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:19:56 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S439&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:19:56 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:19:56 [root] WARNING: 113
2015-09-30 08:19:56 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S439&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:19:56 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N195&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:19:56 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:19:56 [root] WARNING: 114
2015-09-30 08:19:56 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N195&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:19:56 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S398&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:19:56 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:19:56 [root] WARNING: 115
2015-09-30 08:19:56 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S398&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:20:05 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P103&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:20:06 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:20:06 [root] WARNING: 116
2015-09-30 08:20:06 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P103&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 783, in parse_horse
    format(len(d_ind), len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), min_max_mean(prev_avg_spds_d) )
IndexError: tuple index out of range
2015-09-30 08:20:06 [scrapy] INFO: Closing spider (finished)
2015-09-30 08:20:06 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 65598,
 'downloader/request_count': 130,
 'downloader/request_method_count/GET': 129,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 10041663,
 'downloader/response_count': 130,
 'downloader/response_status_count/200': 129,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 8, 20, 6, 255429),
 'log_count/DEBUG': 132,
 'log_count/ERROR': 116,
 'log_count/INFO': 10,
 'log_count/WARNING': 580,
 'request_depth_max': 5,
 'response_received_count': 129,
 'scheduler/dequeued': 130,
 'scheduler/dequeued/memory': 130,
 'scheduler/enqueued': 130,
 'scheduler/enqueued/memory': 130,
 'spider_exceptions/IndexError': 87,
 'spider_exceptions/ValueError': 29,
 'start_time': datetime.datetime(2015, 9, 30, 8, 16, 22, 502580)}
2015-09-30 08:20:06 [scrapy] INFO: Spider closed (finished)
2015-09-30 08:32:23 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 08:32:23 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 08:32:23 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 08:32:23 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 08:32:23 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 08:32:23 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 08:32:23 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 08:32:23 [scrapy] INFO: Spider opened
2015-09-30 08:32:23 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 08:32:23 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 08:33:06 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 08:33:06 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 08:33:23 [scrapy] INFO: Crawled 1 pages (at 1 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 08:34:23 [scrapy] INFO: Crawled 1 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 08:35:23 [scrapy] INFO: Crawled 1 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 08:36:13 [scrapy] DEBUG: Retrying <GET http://racing.scmp.com/index.asp> (failed 1 times): User timeout caused connection failure: Getting http://racing.scmp.com/index.asp took longer than 180.0 seconds..
2015-09-30 08:36:23 [scrapy] INFO: Crawled 1 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 08:37:23 [scrapy] INFO: Crawled 1 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 08:37:27 [scrapy] INFO: Received SIGINT, shutting down gracefully. Send again to force 
2015-09-30 08:37:27 [scrapy] INFO: Closing spider (shutdown)
2015-09-30 08:37:28 [scrapy] INFO: Received SIGINT twice, forcing unclean shutdown
2015-09-30 08:37:28 [scrapy] DEBUG: Retrying <GET http://racing.scmp.com/index.asp> (failed 2 times): [<twisted.python.failure.Failure <class 'twisted.internet.error.ConnectionLost'>>]
2015-09-30 08:37:28 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/exception_count': 2,
 'downloader/exception_type_count/twisted.internet.error.TimeoutError': 1,
 'downloader/exception_type_count/twisted.web._newclient.ResponseNeverReceived': 1,
 'downloader/request_bytes': 1507,
 'downloader/request_count': 4,
 'downloader/request_method_count/GET': 3,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 36847,
 'downloader/response_count': 2,
 'downloader/response_status_count/200': 1,
 'downloader/response_status_count/302': 1,
 'finish_reason': 'shutdown',
 'finish_time': datetime.datetime(2015, 9, 30, 8, 37, 28, 501618),
 'log_count/DEBUG': 5,
 'log_count/INFO': 14,
 'request_depth_max': 1,
 'response_received_count': 1,
 'scheduler/dequeued': 4,
 'scheduler/dequeued/memory': 4,
 'scheduler/enqueued': 5,
 'scheduler/enqueued/memory': 5,
 'start_time': datetime.datetime(2015, 9, 30, 8, 32, 23, 604114)}
2015-09-30 08:37:28 [scrapy] INFO: Spider closed (shutdown)
2015-09-30 08:37:30 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 08:37:30 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 08:37:30 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 08:37:30 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 08:37:30 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 08:37:30 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 08:37:30 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 08:37:30 [scrapy] INFO: Spider opened
2015-09-30 08:37:30 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 08:37:30 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 08:38:30 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 08:38:55 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 08:38:55 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 08:39:08 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 08:39:17 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 08:39:20 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 08:39:20 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 08:39:27 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:39:27 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:27 [root] WARNING: horse code set
2015-09-30 08:39:27 [root] WARNING: 1
2015-09-30 08:39:27 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:27 [root] WARNING: horse code set
2015-09-30 08:39:27 [root] WARNING: 2
2015-09-30 08:39:27 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:27 [root] WARNING: horse code set
2015-09-30 08:39:27 [root] WARNING: 3
2015-09-30 08:39:27 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:27 [root] WARNING: horse code set
2015-09-30 08:39:27 [root] WARNING: 4
2015-09-30 08:39:27 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:27 [root] WARNING: horse code set
2015-09-30 08:39:27 [root] WARNING: 5
2015-09-30 08:39:27 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:27 [root] WARNING: horse code set
2015-09-30 08:39:27 [root] WARNING: 6
2015-09-30 08:39:27 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:27 [root] WARNING: horse code set
2015-09-30 08:39:27 [root] WARNING: 7
2015-09-30 08:39:27 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:27 [root] WARNING: horse code set
2015-09-30 08:39:27 [root] WARNING: 8
2015-09-30 08:39:27 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:27 [root] WARNING: horse code set
2015-09-30 08:39:27 [root] WARNING: 9
2015-09-30 08:39:27 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:27 [root] WARNING: horse code set
2015-09-30 08:39:27 [root] WARNING: 10
2015-09-30 08:39:27 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:27 [root] WARNING: horse code set
2015-09-30 08:39:27 [root] WARNING: 11
2015-09-30 08:39:27 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:27 [root] WARNING: horse code set
2015-09-30 08:39:27 [root] WARNING: 12
2015-09-30 08:39:27 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:27 [root] WARNING: horse code set
2015-09-30 08:39:27 [root] WARNING: 13
2015-09-30 08:39:27 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:27 [root] WARNING: horse code set
2015-09-30 08:39:27 [root] WARNING: 14
2015-09-30 08:39:29 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:39:29 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:29 [root] WARNING: horse code set
2015-09-30 08:39:29 [root] WARNING: 15
2015-09-30 08:39:29 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:29 [root] WARNING: horse code set
2015-09-30 08:39:29 [root] WARNING: 16
2015-09-30 08:39:29 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:29 [root] WARNING: horse code set
2015-09-30 08:39:29 [root] WARNING: 17
2015-09-30 08:39:29 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:29 [root] WARNING: horse code set
2015-09-30 08:39:29 [root] WARNING: 18
2015-09-30 08:39:29 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:29 [root] WARNING: horse code set
2015-09-30 08:39:29 [root] WARNING: 19
2015-09-30 08:39:29 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:29 [root] WARNING: horse code set
2015-09-30 08:39:29 [root] WARNING: 20
2015-09-30 08:39:29 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:29 [root] WARNING: horse code set
2015-09-30 08:39:29 [root] WARNING: 21
2015-09-30 08:39:29 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:29 [root] WARNING: horse code set
2015-09-30 08:39:29 [root] WARNING: 22
2015-09-30 08:39:30 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:30 [root] WARNING: horse code set
2015-09-30 08:39:30 [root] WARNING: 23
2015-09-30 08:39:30 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:30 [root] WARNING: horse code set
2015-09-30 08:39:30 [root] WARNING: 24
2015-09-30 08:39:30 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:30 [root] WARNING: horse code set
2015-09-30 08:39:30 [root] WARNING: 25
2015-09-30 08:39:30 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:30 [root] WARNING: horse code set
2015-09-30 08:39:30 [root] WARNING: 26
2015-09-30 08:39:30 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:30 [root] WARNING: horse code set
2015-09-30 08:39:30 [root] WARNING: 27
2015-09-30 08:39:30 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:30 [root] WARNING: horse code set
2015-09-30 08:39:30 [root] WARNING: 28
2015-09-30 08:39:30 [scrapy] INFO: Crawled 6 pages (at 6 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 08:39:32 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:39:32 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:32 [root] WARNING: horse code set
2015-09-30 08:39:32 [root] WARNING: 29
2015-09-30 08:39:32 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:32 [root] WARNING: horse code set
2015-09-30 08:39:32 [root] WARNING: 30
2015-09-30 08:39:32 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:32 [root] WARNING: horse code set
2015-09-30 08:39:32 [root] WARNING: 31
2015-09-30 08:39:32 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:32 [root] WARNING: horse code set
2015-09-30 08:39:32 [root] WARNING: 32
2015-09-30 08:39:32 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:32 [root] WARNING: horse code set
2015-09-30 08:39:32 [root] WARNING: 33
2015-09-30 08:39:32 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:32 [root] WARNING: horse code set
2015-09-30 08:39:32 [root] WARNING: 34
2015-09-30 08:39:32 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:32 [root] WARNING: horse code set
2015-09-30 08:39:32 [root] WARNING: 35
2015-09-30 08:39:32 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:32 [root] WARNING: horse code set
2015-09-30 08:39:32 [root] WARNING: 36
2015-09-30 08:39:32 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:32 [root] WARNING: horse code set
2015-09-30 08:39:32 [root] WARNING: 37
2015-09-30 08:39:32 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:32 [root] WARNING: horse code set
2015-09-30 08:39:32 [root] WARNING: 38
2015-09-30 08:39:32 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:32 [root] WARNING: horse code set
2015-09-30 08:39:32 [root] WARNING: 39
2015-09-30 08:39:32 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:32 [root] WARNING: horse code set
2015-09-30 08:39:32 [root] WARNING: 40
2015-09-30 08:39:32 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:32 [root] WARNING: horse code set
2015-09-30 08:39:32 [root] WARNING: 41
2015-09-30 08:39:32 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:32 [root] WARNING: horse code set
2015-09-30 08:39:32 [root] WARNING: 42
2015-09-30 08:39:33 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:39:33 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:33 [root] WARNING: horse code set
2015-09-30 08:39:33 [root] WARNING: 43
2015-09-30 08:39:33 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:33 [root] WARNING: horse code set
2015-09-30 08:39:33 [root] WARNING: 44
2015-09-30 08:39:33 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:33 [root] WARNING: horse code set
2015-09-30 08:39:33 [root] WARNING: 45
2015-09-30 08:39:33 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:33 [root] WARNING: horse code set
2015-09-30 08:39:33 [root] WARNING: 46
2015-09-30 08:39:33 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:33 [root] WARNING: horse code set
2015-09-30 08:39:33 [root] WARNING: 47
2015-09-30 08:39:33 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:33 [root] WARNING: horse code set
2015-09-30 08:39:33 [root] WARNING: 48
2015-09-30 08:39:33 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:33 [root] WARNING: horse code set
2015-09-30 08:39:33 [root] WARNING: 49
2015-09-30 08:39:33 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:33 [root] WARNING: horse code set
2015-09-30 08:39:33 [root] WARNING: 50
2015-09-30 08:39:33 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:33 [root] WARNING: horse code set
2015-09-30 08:39:33 [root] WARNING: 51
2015-09-30 08:39:33 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:33 [root] WARNING: horse code set
2015-09-30 08:39:33 [root] WARNING: 52
2015-09-30 08:39:33 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:33 [root] WARNING: horse code set
2015-09-30 08:39:33 [root] WARNING: 53
2015-09-30 08:39:33 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:33 [root] WARNING: horse code set
2015-09-30 08:39:33 [root] WARNING: 54
2015-09-30 08:39:35 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:39:35 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:35 [root] WARNING: horse code set
2015-09-30 08:39:35 [root] WARNING: 55
2015-09-30 08:39:35 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:35 [root] WARNING: horse code set
2015-09-30 08:39:35 [root] WARNING: 56
2015-09-30 08:39:35 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:35 [root] WARNING: horse code set
2015-09-30 08:39:35 [root] WARNING: 57
2015-09-30 08:39:35 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:35 [root] WARNING: horse code set
2015-09-30 08:39:35 [root] WARNING: 58
2015-09-30 08:39:35 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:35 [root] WARNING: horse code set
2015-09-30 08:39:35 [root] WARNING: 59
2015-09-30 08:39:35 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:35 [root] WARNING: horse code set
2015-09-30 08:39:35 [root] WARNING: 60
2015-09-30 08:39:35 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:35 [root] WARNING: horse code set
2015-09-30 08:39:35 [root] WARNING: 61
2015-09-30 08:39:35 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:35 [root] WARNING: horse code set
2015-09-30 08:39:35 [root] WARNING: 62
2015-09-30 08:39:35 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:35 [root] WARNING: horse code set
2015-09-30 08:39:35 [root] WARNING: 63
2015-09-30 08:39:35 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:35 [root] WARNING: horse code set
2015-09-30 08:39:35 [root] WARNING: 64
2015-09-30 08:39:35 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:35 [root] WARNING: horse code set
2015-09-30 08:39:35 [root] WARNING: 65
2015-09-30 08:39:35 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:35 [root] WARNING: horse code set
2015-09-30 08:39:35 [root] WARNING: 66
2015-09-30 08:39:35 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:35 [root] WARNING: horse code set
2015-09-30 08:39:35 [root] WARNING: 67
2015-09-30 08:39:35 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:35 [root] WARNING: horse code set
2015-09-30 08:39:35 [root] WARNING: 68
2015-09-30 08:39:36 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:39:36 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:36 [root] WARNING: horse code set
2015-09-30 08:39:36 [root] WARNING: 69
2015-09-30 08:39:36 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:36 [root] WARNING: horse code set
2015-09-30 08:39:36 [root] WARNING: 70
2015-09-30 08:39:36 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:36 [root] WARNING: horse code set
2015-09-30 08:39:36 [root] WARNING: 71
2015-09-30 08:39:36 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:36 [root] WARNING: horse code set
2015-09-30 08:39:36 [root] WARNING: 72
2015-09-30 08:39:36 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:36 [root] WARNING: horse code set
2015-09-30 08:39:36 [root] WARNING: 73
2015-09-30 08:39:36 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:37 [root] WARNING: horse code set
2015-09-30 08:39:37 [root] WARNING: 74
2015-09-30 08:39:37 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:37 [root] WARNING: horse code set
2015-09-30 08:39:37 [root] WARNING: 75
2015-09-30 08:39:37 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:37 [root] WARNING: horse code set
2015-09-30 08:39:37 [root] WARNING: 76
2015-09-30 08:39:37 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:37 [root] WARNING: horse code set
2015-09-30 08:39:37 [root] WARNING: 77
2015-09-30 08:39:37 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:37 [root] WARNING: horse code set
2015-09-30 08:39:37 [root] WARNING: 78
2015-09-30 08:39:37 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:37 [root] WARNING: horse code set
2015-09-30 08:39:37 [root] WARNING: 79
2015-09-30 08:39:37 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:37 [root] WARNING: horse code set
2015-09-30 08:39:37 [root] WARNING: 80
2015-09-30 08:39:37 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:37 [root] WARNING: horse code set
2015-09-30 08:39:37 [root] WARNING: 81
2015-09-30 08:39:37 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:37 [root] WARNING: horse code set
2015-09-30 08:39:37 [root] WARNING: 82
2015-09-30 08:39:37 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:39:37 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:37 [root] WARNING: horse code set
2015-09-30 08:39:37 [root] WARNING: 83
2015-09-30 08:39:37 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:37 [root] WARNING: horse code set
2015-09-30 08:39:37 [root] WARNING: 84
2015-09-30 08:39:37 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:37 [root] WARNING: horse code set
2015-09-30 08:39:37 [root] WARNING: 85
2015-09-30 08:39:37 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:37 [root] WARNING: horse code set
2015-09-30 08:39:37 [root] WARNING: 86
2015-09-30 08:39:37 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:37 [root] WARNING: horse code set
2015-09-30 08:39:37 [root] WARNING: 87
2015-09-30 08:39:37 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:37 [root] WARNING: horse code set
2015-09-30 08:39:37 [root] WARNING: 88
2015-09-30 08:39:37 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:37 [root] WARNING: horse code set
2015-09-30 08:39:37 [root] WARNING: 89
2015-09-30 08:39:37 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:37 [root] WARNING: horse code set
2015-09-30 08:39:37 [root] WARNING: 90
2015-09-30 08:39:37 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:37 [root] WARNING: horse code set
2015-09-30 08:39:37 [root] WARNING: 91
2015-09-30 08:39:37 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:37 [root] WARNING: horse code set
2015-09-30 08:39:37 [root] WARNING: 92
2015-09-30 08:39:37 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:37 [root] WARNING: horse code set
2015-09-30 08:39:37 [root] WARNING: 93
2015-09-30 08:39:38 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:39:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:38 [root] WARNING: horse code set
2015-09-30 08:39:38 [root] WARNING: 94
2015-09-30 08:39:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:38 [root] WARNING: horse code set
2015-09-30 08:39:38 [root] WARNING: 95
2015-09-30 08:39:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:38 [root] WARNING: horse code set
2015-09-30 08:39:38 [root] WARNING: 96
2015-09-30 08:39:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:38 [root] WARNING: horse code set
2015-09-30 08:39:38 [root] WARNING: 97
2015-09-30 08:39:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:38 [root] WARNING: horse code set
2015-09-30 08:39:38 [root] WARNING: 98
2015-09-30 08:39:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:38 [root] WARNING: horse code set
2015-09-30 08:39:38 [root] WARNING: 99
2015-09-30 08:39:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:38 [root] WARNING: horse code set
2015-09-30 08:39:38 [root] WARNING: 100
2015-09-30 08:39:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:38 [root] WARNING: horse code set
2015-09-30 08:39:38 [root] WARNING: 101
2015-09-30 08:39:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:38 [root] WARNING: horse code set
2015-09-30 08:39:38 [root] WARNING: 102
2015-09-30 08:39:39 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:39:39 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:39 [root] WARNING: horse code set
2015-09-30 08:39:39 [root] WARNING: 103
2015-09-30 08:39:39 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:39 [root] WARNING: horse code set
2015-09-30 08:39:39 [root] WARNING: 104
2015-09-30 08:39:39 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:39 [root] WARNING: horse code set
2015-09-30 08:39:39 [root] WARNING: 105
2015-09-30 08:39:39 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:39 [root] WARNING: horse code set
2015-09-30 08:39:39 [root] WARNING: 106
2015-09-30 08:39:39 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:39 [root] WARNING: horse code set
2015-09-30 08:39:39 [root] WARNING: 107
2015-09-30 08:39:39 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:39 [root] WARNING: horse code set
2015-09-30 08:39:39 [root] WARNING: 108
2015-09-30 08:39:39 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:39 [root] WARNING: horse code set
2015-09-30 08:39:39 [root] WARNING: 109
2015-09-30 08:39:39 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:39 [root] WARNING: horse code set
2015-09-30 08:39:39 [root] WARNING: 110
2015-09-30 08:39:39 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:39 [root] WARNING: horse code set
2015-09-30 08:39:39 [root] WARNING: 111
2015-09-30 08:39:39 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:39 [root] WARNING: horse code set
2015-09-30 08:39:39 [root] WARNING: 112
2015-09-30 08:39:39 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:39 [root] WARNING: horse code set
2015-09-30 08:39:39 [root] WARNING: 113
2015-09-30 08:39:39 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:39 [root] WARNING: horse code set
2015-09-30 08:39:39 [root] WARNING: 114
2015-09-30 08:39:39 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:39 [root] WARNING: horse code set
2015-09-30 08:39:39 [root] WARNING: 115
2015-09-30 08:39:39 [root] WARNING: -------------------------------------------------
2015-09-30 08:39:39 [root] WARNING: horse code set
2015-09-30 08:39:39 [root] WARNING: 116
2015-09-30 08:39:42 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:39:42 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:39:42 [root] WARNING: 1
2015-09-30 08:39:42 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:39:43 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T200&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:39:44 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:39:44 [root] WARNING: 2
2015-09-30 08:39:44 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T200&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:39:44 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P372&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:39:44 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:39:44 [root] WARNING: 3
2015-09-30 08:39:44 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P372&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:39:45 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T238&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:39:45 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:39:45 [root] WARNING: 4
2015-09-30 08:39:45 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T238&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:39:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T009&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:39:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S022&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:39:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:39:46 [root] WARNING: 5
2015-09-30 08:39:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T009&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:39:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:39:46 [root] WARNING: 6
2015-09-30 08:39:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S022&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:39:49 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N033&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:39:49 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:39:49 [root] WARNING: 7
2015-09-30 08:39:49 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N033&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:39:49 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P103&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:39:49 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:39:49 [root] WARNING: 8
2015-09-30 08:39:50 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P103&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:39:50 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P158&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:39:50 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:39:50 [root] WARNING: 9
2015-09-30 08:39:50 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P158&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:39:52 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P222&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:39:52 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:39:52 [root] WARNING: 10
2015-09-30 08:39:52 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P222&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:39:52 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T288&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:39:52 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:39:52 [root] WARNING: 11
2015-09-30 08:39:52 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T288&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:39:57 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T135&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:39:57 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:39:57 [root] WARNING: 12
2015-09-30 08:39:57 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T135&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:39:59 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S305&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:39:59 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:39:59 [root] WARNING: 13
2015-09-30 08:39:59 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S305&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:00 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T080&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:40:01 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:01 [root] WARNING: 14
2015-09-30 08:40:01 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T080&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:01 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P031&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:40:01 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:01 [root] WARNING: 15
2015-09-30 08:40:01 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P031&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:02 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S346&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:40:02 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:02 [root] WARNING: 16
2015-09-30 08:40:02 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S346&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:02 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T205&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:40:02 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P358&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:40:03 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:03 [root] WARNING: 17
2015-09-30 08:40:03 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T205&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:03 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:03 [root] WARNING: 18
2015-09-30 08:40:03 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P358&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:03 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T005&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:40:03 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:03 [root] WARNING: 19
2015-09-30 08:40:03 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T005&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:03 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V061&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:40:03 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:03 [root] WARNING: 20
2015-09-30 08:40:03 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V061&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:06 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T342&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:40:06 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:06 [root] WARNING: 21
2015-09-30 08:40:06 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T342&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:07 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N234&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:40:07 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:07 [root] WARNING: 22
2015-09-30 08:40:07 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N234&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:40:07 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T333&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:40:07 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V039&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:40:07 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:07 [root] WARNING: 23
2015-09-30 08:40:07 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T333&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:07 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N330&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:40:07 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:07 [root] WARNING: 24
2015-09-30 08:40:07 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V039&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:07 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:07 [root] WARNING: 25
2015-09-30 08:40:08 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N330&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:40:08 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T340&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:40:08 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:08 [root] WARNING: 26
2015-09-30 08:40:08 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T340&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:09 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:40:09 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:09 [root] WARNING: 27
2015-09-30 08:40:09 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:11 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N226&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:40:11 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:11 [root] WARNING: 28
2015-09-30 08:40:11 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N226&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:14 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P097&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:40:14 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:14 [root] WARNING: 29
2015-09-30 08:40:14 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P097&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:40:15 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S397&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:40:15 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:15 [root] WARNING: 30
2015-09-30 08:40:15 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S397&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:15 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:40:15 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:15 [root] WARNING: 31
2015-09-30 08:40:15 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:17 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S076&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:40:17 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:17 [root] WARNING: 32
2015-09-30 08:40:17 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S076&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:19 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P151&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:40:20 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:20 [root] WARNING: 33
2015-09-30 08:40:20 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P151&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:40:20 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S332&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:40:21 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:21 [root] WARNING: 34
2015-09-30 08:40:21 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S332&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:24 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S100&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:40:24 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:24 [root] WARNING: 35
2015-09-30 08:40:24 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S100&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:24 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:40:25 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:25 [root] WARNING: 36
2015-09-30 08:40:25 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:27 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S023&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:40:27 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:27 [root] WARNING: 37
2015-09-30 08:40:27 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S023&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:27 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P044&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:40:27 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:27 [root] WARNING: 38
2015-09-30 08:40:27 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P044&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:28 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T168&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:40:28 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:28 [root] WARNING: 39
2015-09-30 08:40:28 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T168&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:28 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S209&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:40:28 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:28 [root] WARNING: 40
2015-09-30 08:40:28 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S209&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:29 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S300&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:40:30 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:30 [root] WARNING: 41
2015-09-30 08:40:30 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S300&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:40:30 [scrapy] INFO: Crawled 54 pages (at 48 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 08:40:31 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T002&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:40:31 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:31 [root] WARNING: 42
2015-09-30 08:40:31 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T002&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:32 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:40:32 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:32 [root] WARNING: 43
2015-09-30 08:40:33 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:35 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S375&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:40:35 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:35 [root] WARNING: 44
2015-09-30 08:40:35 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S375&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:36 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P316&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:40:36 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N220&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:40:36 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:36 [root] WARNING: 45
2015-09-30 08:40:36 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P316&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:36 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:36 [root] WARNING: 46
2015-09-30 08:40:36 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N220&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:38 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T111&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:40:38 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:38 [root] WARNING: 47
2015-09-30 08:40:38 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T111&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:39 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S165&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:40:39 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:39 [root] WARNING: 48
2015-09-30 08:40:39 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S165&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:39 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S225&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:40:40 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:40 [root] WARNING: 49
2015-09-30 08:40:40 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S225&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:41 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:40:41 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:40:41 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:41 [root] WARNING: 50
2015-09-30 08:40:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:40:41 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:41 [root] WARNING: 51
2015-09-30 08:40:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:43 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S415&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:40:43 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:43 [root] WARNING: 52
2015-09-30 08:40:43 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S415&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:44 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:40:45 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:45 [root] WARNING: 53
2015-09-30 08:40:45 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:45 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M227&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:40:45 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:45 [root] WARNING: 54
2015-09-30 08:40:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M227&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N419&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:40:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T289&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:40:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:47 [root] WARNING: 55
2015-09-30 08:40:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N419&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:40:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T379&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:40:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:47 [root] WARNING: 56
2015-09-30 08:40:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T289&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:47 [root] WARNING: 57
2015-09-30 08:40:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T379&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:48 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T050&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:40:49 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:49 [root] WARNING: 58
2015-09-30 08:40:49 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T050&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:51 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T129&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:40:51 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:51 [root] WARNING: 59
2015-09-30 08:40:51 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T129&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:53 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S394&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:40:53 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:53 [root] WARNING: 60
2015-09-30 08:40:53 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S394&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:54 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T265&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:40:54 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:54 [root] WARNING: 61
2015-09-30 08:40:54 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T265&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:54 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S275&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:40:54 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:54 [root] WARNING: 62
2015-09-30 08:40:54 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S275&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:54 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:40:54 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:54 [root] WARNING: 63
2015-09-30 08:40:54 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:55 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T004&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:40:55 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:55 [root] WARNING: 64
2015-09-30 08:40:55 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T004&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:40:55 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S421&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:40:56 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:56 [root] WARNING: 65
2015-09-30 08:40:56 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S421&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:56 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T404&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:40:56 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:56 [root] WARNING: 66
2015-09-30 08:40:56 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T404&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:40:57 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T215&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:40:57 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:40:57 [root] WARNING: 67
2015-09-30 08:40:57 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T215&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:41:00 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:41:00 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:00 [root] WARNING: 68
2015-09-30 08:41:00 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:41:04 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N432&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:41:04 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:04 [root] WARNING: 69
2015-09-30 08:41:05 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N432&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:41:05 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:41:05 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:05 [root] WARNING: 70
2015-09-30 08:41:05 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:41:06 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:41:06 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:06 [root] WARNING: 71
2015-09-30 08:41:06 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:41:06 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N386&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:41:06 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:06 [root] WARNING: 72
2015-09-30 08:41:06 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N386&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:41:06 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:41:06 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S349&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:41:07 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:07 [root] WARNING: 73
2015-09-30 08:41:07 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:41:07 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:07 [root] WARNING: 74
2015-09-30 08:41:07 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S349&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:41:07 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P173&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:41:07 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:07 [root] WARNING: 75
2015-09-30 08:41:07 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P173&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:41:09 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T235&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:41:09 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:09 [root] WARNING: 76
2015-09-30 08:41:09 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T235&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:41:10 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:41:10 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:10 [root] WARNING: 77
2015-09-30 08:41:10 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:41:12 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:41:12 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:12 [root] WARNING: 78
2015-09-30 08:41:12 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:41:13 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N297&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:41:13 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:13 [root] WARNING: 79
2015-09-30 08:41:14 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N297&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:41:16 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P195&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:41:16 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:16 [root] WARNING: 80
2015-09-30 08:41:16 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P195&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:41:17 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N236&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:41:17 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:17 [root] WARNING: 81
2015-09-30 08:41:17 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N236&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:41:19 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P180&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:41:19 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:19 [root] WARNING: 82
2015-09-30 08:41:19 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P180&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:41:22 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:41:22 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:22 [root] WARNING: 83
2015-09-30 08:41:22 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:41:23 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N171&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:41:23 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:23 [root] WARNING: 84
2015-09-30 08:41:23 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N171&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:41:24 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:41:24 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:24 [root] WARNING: 85
2015-09-30 08:41:24 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:41:24 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N434&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:41:24 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:24 [root] WARNING: 86
2015-09-30 08:41:25 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N434&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:41:26 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:41:26 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T257&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:41:26 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:26 [root] WARNING: 87
2015-09-30 08:41:26 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:41:26 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:26 [root] WARNING: 88
2015-09-30 08:41:26 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T257&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:41:27 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T256&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:41:27 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:27 [root] WARNING: 89
2015-09-30 08:41:27 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T256&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:41:30 [scrapy] INFO: Crawled 102 pages (at 48 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 08:41:32 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T093&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:41:32 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:32 [root] WARNING: 90
2015-09-30 08:41:32 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T093&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:41:33 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S278&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:41:33 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S296&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:41:33 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M199&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:41:33 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:33 [root] WARNING: 91
2015-09-30 08:41:33 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S278&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:41:33 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:33 [root] WARNING: 92
2015-09-30 08:41:33 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S296&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:41:33 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:33 [root] WARNING: 93
2015-09-30 08:41:34 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M199&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:41:34 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T170&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:41:34 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S420&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:41:34 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:34 [root] WARNING: 94
2015-09-30 08:41:34 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T170&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:41:34 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:34 [root] WARNING: 95
2015-09-30 08:41:34 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S420&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:41:36 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T112&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:41:36 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:36 [root] WARNING: 96
2015-09-30 08:41:36 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T112&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:41:37 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T148&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:41:37 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:37 [root] WARNING: 97
2015-09-30 08:41:37 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T148&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:41:37 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P111&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:41:37 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:37 [root] WARNING: 98
2015-09-30 08:41:37 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P111&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:41:38 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S282&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:41:38 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:38 [root] WARNING: 99
2015-09-30 08:41:38 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S282&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:41:41 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S391&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:41:41 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:41 [root] WARNING: 100
2015-09-30 08:41:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S391&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:41:42 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P191&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:41:42 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S109&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:41:42 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:42 [root] WARNING: 101
2015-09-30 08:41:42 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P191&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:41:42 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:42 [root] WARNING: 102
2015-09-30 08:41:42 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S109&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:41:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S145&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:41:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:46 [root] WARNING: 103
2015-09-30 08:41:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S145&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:41:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P366&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:41:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:46 [root] WARNING: 104
2015-09-30 08:41:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P366&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:41:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P118&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:41:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:47 [root] WARNING: 105
2015-09-30 08:41:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P118&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:41:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N394&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:41:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:47 [root] WARNING: 106
2015-09-30 08:41:48 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N394&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:41:49 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N169&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:41:49 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:49 [root] WARNING: 107
2015-09-30 08:41:49 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N169&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:41:50 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S110&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:41:50 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:50 [root] WARNING: 108
2015-09-30 08:41:50 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S110&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:41:50 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S117&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:41:50 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:50 [root] WARNING: 109
2015-09-30 08:41:50 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S117&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:41:51 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:41:51 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T096&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:41:51 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:51 [root] WARNING: 110
2015-09-30 08:41:51 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:41:51 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:51 [root] WARNING: 111
2015-09-30 08:41:51 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T096&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:41:55 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S010&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:41:55 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:55 [root] WARNING: 112
2015-09-30 08:41:55 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S010&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:41:56 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N195&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:41:56 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S439&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:41:56 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:56 [root] WARNING: 113
2015-09-30 08:41:56 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N195&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prevrps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:41:56 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:56 [root] WARNING: 114
2015-09-30 08:41:57 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S439&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:41:57 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S398&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:41:57 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:57 [root] WARNING: 115
2015-09-30 08:41:57 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S398&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:41:58 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T398&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:41:58 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:41:58 [root] WARNING: 116
2015-09-30 08:41:58 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T398&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    wins_surf_ind = [i for i in surf_ind if i in winning_indexes]
UnboundLocalError: local variable 'surf_ind' referenced before assignment
2015-09-30 08:41:58 [scrapy] INFO: Closing spider (finished)
2015-09-30 08:41:58 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 70408,
 'downloader/request_count': 130,
 'downloader/request_method_count/GET': 129,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 10042904,
 'downloader/response_count': 130,
 'downloader/response_status_count/200': 129,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 8, 41, 58, 983968),
 'log_count/DEBUG': 132,
 'log_count/ERROR': 116,
 'log_count/INFO': 11,
 'log_count/WARNING': 580,
 'request_depth_max': 5,
 'response_received_count': 129,
 'scheduler/dequeued': 130,
 'scheduler/dequeued/memory': 130,
 'scheduler/enqueued': 130,
 'scheduler/enqueued/memory': 130,
 'spider_exceptions/UnboundLocalError': 87,
 'spider_exceptions/ValueError': 29,
 'start_time': datetime.datetime(2015, 9, 30, 8, 37, 30, 949128)}
2015-09-30 08:41:58 [scrapy] INFO: Spider closed (finished)
2015-09-30 08:54:09 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 08:54:09 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 08:54:09 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 08:54:09 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 08:54:09 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 08:54:09 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 08:54:09 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 08:54:09 [scrapy] INFO: Spider opened
2015-09-30 08:54:09 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 08:54:09 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 08:54:11 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 08:54:14 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 08:54:19 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 08:54:23 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 08:54:26 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 08:54:26 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 08:54:31 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:54:31 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:31 [root] WARNING: horse code set
2015-09-30 08:54:31 [root] WARNING: 1
2015-09-30 08:54:31 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:31 [root] WARNING: horse code set
2015-09-30 08:54:31 [root] WARNING: 2
2015-09-30 08:54:31 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:31 [root] WARNING: horse code set
2015-09-30 08:54:31 [root] WARNING: 3
2015-09-30 08:54:31 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:31 [root] WARNING: horse code set
2015-09-30 08:54:31 [root] WARNING: 4
2015-09-30 08:54:31 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:31 [root] WARNING: horse code set
2015-09-30 08:54:31 [root] WARNING: 5
2015-09-30 08:54:31 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:31 [root] WARNING: horse code set
2015-09-30 08:54:31 [root] WARNING: 6
2015-09-30 08:54:31 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:31 [root] WARNING: horse code set
2015-09-30 08:54:31 [root] WARNING: 7
2015-09-30 08:54:31 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:31 [root] WARNING: horse code set
2015-09-30 08:54:31 [root] WARNING: 8
2015-09-30 08:54:31 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:31 [root] WARNING: horse code set
2015-09-30 08:54:31 [root] WARNING: 9
2015-09-30 08:54:31 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:31 [root] WARNING: horse code set
2015-09-30 08:54:31 [root] WARNING: 10
2015-09-30 08:54:31 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:31 [root] WARNING: horse code set
2015-09-30 08:54:31 [root] WARNING: 11
2015-09-30 08:54:31 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:31 [root] WARNING: horse code set
2015-09-30 08:54:31 [root] WARNING: 12
2015-09-30 08:54:31 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:31 [root] WARNING: horse code set
2015-09-30 08:54:31 [root] WARNING: 13
2015-09-30 08:54:31 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:31 [root] WARNING: horse code set
2015-09-30 08:54:31 [root] WARNING: 14
2015-09-30 08:54:33 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:54:33 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:33 [root] WARNING: horse code set
2015-09-30 08:54:33 [root] WARNING: 15
2015-09-30 08:54:33 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:33 [root] WARNING: horse code set
2015-09-30 08:54:33 [root] WARNING: 16
2015-09-30 08:54:33 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:33 [root] WARNING: horse code set
2015-09-30 08:54:33 [root] WARNING: 17
2015-09-30 08:54:33 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:33 [root] WARNING: horse code set
2015-09-30 08:54:33 [root] WARNING: 18
2015-09-30 08:54:33 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:33 [root] WARNING: horse code set
2015-09-30 08:54:33 [root] WARNING: 19
2015-09-30 08:54:33 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:33 [root] WARNING: horse code set
2015-09-30 08:54:33 [root] WARNING: 20
2015-09-30 08:54:33 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:33 [root] WARNING: horse code set
2015-09-30 08:54:33 [root] WARNING: 21
2015-09-30 08:54:33 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:33 [root] WARNING: horse code set
2015-09-30 08:54:33 [root] WARNING: 22
2015-09-30 08:54:33 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:33 [root] WARNING: horse code set
2015-09-30 08:54:33 [root] WARNING: 23
2015-09-30 08:54:33 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:33 [root] WARNING: horse code set
2015-09-30 08:54:33 [root] WARNING: 24
2015-09-30 08:54:33 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:33 [root] WARNING: horse code set
2015-09-30 08:54:33 [root] WARNING: 25
2015-09-30 08:54:33 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:33 [root] WARNING: horse code set
2015-09-30 08:54:33 [root] WARNING: 26
2015-09-30 08:54:33 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:33 [root] WARNING: horse code set
2015-09-30 08:54:33 [root] WARNING: 27
2015-09-30 08:54:33 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:33 [root] WARNING: horse code set
2015-09-30 08:54:33 [root] WARNING: 28
2015-09-30 08:54:35 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:54:35 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:35 [root] WARNING: horse code set
2015-09-30 08:54:35 [root] WARNING: 29
2015-09-30 08:54:35 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:35 [root] WARNING: horse code set
2015-09-30 08:54:35 [root] WARNING: 30
2015-09-30 08:54:35 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:35 [root] WARNING: horse code set
2015-09-30 08:54:35 [root] WARNING: 31
2015-09-30 08:54:35 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:35 [root] WARNING: horse code set
2015-09-30 08:54:35 [root] WARNING: 32
2015-09-30 08:54:35 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:35 [root] WARNING: horse code set
2015-09-30 08:54:35 [root] WARNING: 33
2015-09-30 08:54:35 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:35 [root] WARNING: horse code set
2015-09-30 08:54:35 [root] WARNING: 34
2015-09-30 08:54:35 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:35 [root] WARNING: horse code set
2015-09-30 08:54:35 [root] WARNING: 35
2015-09-30 08:54:35 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:35 [root] WARNING: horse code set
2015-09-30 08:54:35 [root] WARNING: 36
2015-09-30 08:54:35 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:35 [root] WARNING: horse code set
2015-09-30 08:54:35 [root] WARNING: 37
2015-09-30 08:54:35 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:35 [root] WARNING: horse code set
2015-09-30 08:54:35 [root] WARNING: 38
2015-09-30 08:54:35 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:35 [root] WARNING: horse code set
2015-09-30 08:54:35 [root] WARNING: 39
2015-09-30 08:54:35 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:35 [root] WARNING: horse code set
2015-09-30 08:54:35 [root] WARNING: 40
2015-09-30 08:54:35 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:35 [root] WARNING: horse code set
2015-09-30 08:54:35 [root] WARNING: 41
2015-09-30 08:54:35 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:35 [root] WARNING: horse code set
2015-09-30 08:54:35 [root] WARNING: 42
2015-09-30 08:54:36 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:54:36 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:36 [root] WARNING: horse code set
2015-09-30 08:54:36 [root] WARNING: 43
2015-09-30 08:54:36 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:36 [root] WARNING: horse code set
2015-09-30 08:54:36 [root] WARNING: 44
2015-09-30 08:54:36 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:36 [root] WARNING: horse code set
2015-09-30 08:54:36 [root] WARNING: 45
2015-09-30 08:54:36 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:36 [root] WARNING: horse code set
2015-09-30 08:54:36 [root] WARNING: 46
2015-09-30 08:54:36 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:36 [root] WARNING: horse code set
2015-09-30 08:54:36 [root] WARNING: 47
2015-09-30 08:54:36 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:36 [root] WARNING: horse code set
2015-09-30 08:54:36 [root] WARNING: 48
2015-09-30 08:54:36 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:36 [root] WARNING: horse code set
2015-09-30 08:54:36 [root] WARNING: 49
2015-09-30 08:54:36 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:36 [root] WARNING: horse code set
2015-09-30 08:54:36 [root] WARNING: 50
2015-09-30 08:54:36 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:36 [root] WARNING: horse code set
2015-09-30 08:54:36 [root] WARNING: 51
2015-09-30 08:54:36 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:36 [root] WARNING: horse code set
2015-09-30 08:54:36 [root] WARNING: 52
2015-09-30 08:54:37 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:37 [root] WARNING: horse code set
2015-09-30 08:54:37 [root] WARNING: 53
2015-09-30 08:54:37 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:37 [root] WARNING: horse code set
2015-09-30 08:54:37 [root] WARNING: 54
2015-09-30 08:54:38 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:54:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:38 [root] WARNING: horse code set
2015-09-30 08:54:38 [root] WARNING: 55
2015-09-30 08:54:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:38 [root] WARNING: horse code set
2015-09-30 08:54:38 [root] WARNING: 56
2015-09-30 08:54:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:38 [root] WARNING: horse code set
2015-09-30 08:54:38 [root] WARNING: 57
2015-09-30 08:54:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:38 [root] WARNING: horse code set
2015-09-30 08:54:38 [root] WARNING: 58
2015-09-30 08:54:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:38 [root] WARNING: horse code set
2015-09-30 08:54:38 [root] WARNING: 59
2015-09-30 08:54:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:38 [root] WARNING: horse code set
2015-09-30 08:54:38 [root] WARNING: 60
2015-09-30 08:54:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:38 [root] WARNING: horse code set
2015-09-30 08:54:38 [root] WARNING: 61
2015-09-30 08:54:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:38 [root] WARNING: horse code set
2015-09-30 08:54:38 [root] WARNING: 62
2015-09-30 08:54:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:38 [root] WARNING: horse code set
2015-09-30 08:54:38 [root] WARNING: 63
2015-09-30 08:54:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:38 [root] WARNING: horse code set
2015-09-30 08:54:38 [root] WARNING: 64
2015-09-30 08:54:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:38 [root] WARNING: horse code set
2015-09-30 08:54:38 [root] WARNING: 65
2015-09-30 08:54:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:38 [root] WARNING: horse code set
2015-09-30 08:54:38 [root] WARNING: 66
2015-09-30 08:54:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:38 [root] WARNING: horse code set
2015-09-30 08:54:38 [root] WARNING: 67
2015-09-30 08:54:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:38 [root] WARNING: horse code set
2015-09-30 08:54:38 [root] WARNING: 68
2015-09-30 08:54:38 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:54:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:38 [root] WARNING: horse code set
2015-09-30 08:54:38 [root] WARNING: 69
2015-09-30 08:54:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:38 [root] WARNING: horse code set
2015-09-30 08:54:38 [root] WARNING: 70
2015-09-30 08:54:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:38 [root] WARNING: horse code set
2015-09-30 08:54:38 [root] WARNING: 71
2015-09-30 08:54:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:38 [root] WARNING: horse code set
2015-09-30 08:54:38 [root] WARNING: 72
2015-09-30 08:54:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:38 [root] WARNING: horse code set
2015-09-30 08:54:38 [root] WARNING: 73
2015-09-30 08:54:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:38 [root] WARNING: horse code set
2015-09-30 08:54:38 [root] WARNING: 74
2015-09-30 08:54:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:38 [root] WARNING: horse code set
2015-09-30 08:54:38 [root] WARNING: 75
2015-09-30 08:54:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:38 [root] WARNING: horse code set
2015-09-30 08:54:38 [root] WARNING: 76
2015-09-30 08:54:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:38 [root] WARNING: horse code set
2015-09-30 08:54:38 [root] WARNING: 77
2015-09-30 08:54:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:38 [root] WARNING: horse code set
2015-09-30 08:54:38 [root] WARNING: 78
2015-09-30 08:54:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:38 [root] WARNING: horse code set
2015-09-30 08:54:38 [root] WARNING: 79
2015-09-30 08:54:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:38 [root] WARNING: horse code set
2015-09-30 08:54:38 [root] WARNING: 80
2015-09-30 08:54:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:38 [root] WARNING: horse code set
2015-09-30 08:54:38 [root] WARNING: 81
2015-09-30 08:54:38 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:38 [root] WARNING: horse code set
2015-09-30 08:54:38 [root] WARNING: 82
2015-09-30 08:54:40 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:54:40 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:40 [root] WARNING: horse code set
2015-09-30 08:54:40 [root] WARNING: 83
2015-09-30 08:54:40 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:40 [root] WARNING: horse code set
2015-09-30 08:54:40 [root] WARNING: 84
2015-09-30 08:54:40 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:40 [root] WARNING: horse code set
2015-09-30 08:54:40 [root] WARNING: 85
2015-09-30 08:54:40 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:40 [root] WARNING: horse code set
2015-09-30 08:54:40 [root] WARNING: 86
2015-09-30 08:54:40 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:40 [root] WARNING: horse code set
2015-09-30 08:54:40 [root] WARNING: 87
2015-09-30 08:54:40 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:40 [root] WARNING: horse code set
2015-09-30 08:54:40 [root] WARNING: 88
2015-09-30 08:54:40 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:40 [root] WARNING: horse code set
2015-09-30 08:54:40 [root] WARNING: 89
2015-09-30 08:54:40 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:40 [root] WARNING: horse code set
2015-09-30 08:54:40 [root] WARNING: 90
2015-09-30 08:54:40 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:40 [root] WARNING: horse code set
2015-09-30 08:54:40 [root] WARNING: 91
2015-09-30 08:54:40 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:40 [root] WARNING: horse code set
2015-09-30 08:54:40 [root] WARNING: 92
2015-09-30 08:54:40 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:40 [root] WARNING: horse code set
2015-09-30 08:54:40 [root] WARNING: 93
2015-09-30 08:54:41 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:54:41 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:41 [root] WARNING: horse code set
2015-09-30 08:54:41 [root] WARNING: 94
2015-09-30 08:54:41 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:41 [root] WARNING: horse code set
2015-09-30 08:54:41 [root] WARNING: 95
2015-09-30 08:54:41 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:41 [root] WARNING: horse code set
2015-09-30 08:54:41 [root] WARNING: 96
2015-09-30 08:54:41 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:41 [root] WARNING: horse code set
2015-09-30 08:54:41 [root] WARNING: 97
2015-09-30 08:54:41 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:41 [root] WARNING: horse code set
2015-09-30 08:54:41 [root] WARNING: 98
2015-09-30 08:54:41 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:41 [root] WARNING: horse code set
2015-09-30 08:54:41 [root] WARNING: 99
2015-09-30 08:54:41 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:41 [root] WARNING: horse code set
2015-09-30 08:54:41 [root] WARNING: 100
2015-09-30 08:54:41 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:41 [root] WARNING: horse code set
2015-09-30 08:54:41 [root] WARNING: 101
2015-09-30 08:54:41 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:41 [root] WARNING: horse code set
2015-09-30 08:54:41 [root] WARNING: 102
2015-09-30 08:54:41 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T200&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:54:41 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:54:41 [root] WARNING: 1
2015-09-30 08:54:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T200&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:54:42 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P372&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:54:42 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:54:42 [root] WARNING: 2
2015-09-30 08:54:42 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P372&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 755, in parse_horse
    total_winodds = sum([x for x in enumerate(prev_winodds) if i in winning_indexes])
TypeError: unsupported operand type(s) for +: 'int' and 'tuple'
2015-09-30 08:54:43 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:54:43 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:54:43 [root] WARNING: 3
2015-09-30 08:54:43 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:54:45 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 08:54:45 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:45 [root] WARNING: horse code set
2015-09-30 08:54:45 [root] WARNING: 103
2015-09-30 08:54:45 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:45 [root] WARNING: horse code set
2015-09-30 08:54:45 [root] WARNING: 104
2015-09-30 08:54:45 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:45 [root] WARNING: horse code set
2015-09-30 08:54:45 [root] WARNING: 105
2015-09-30 08:54:45 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:45 [root] WARNING: horse code set
2015-09-30 08:54:45 [root] WARNING: 106
2015-09-30 08:54:45 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:45 [root] WARNING: horse code set
2015-09-30 08:54:45 [root] WARNING: 107
2015-09-30 08:54:45 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:45 [root] WARNING: horse code set
2015-09-30 08:54:45 [root] WARNING: 108
2015-09-30 08:54:45 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:45 [root] WARNING: horse code set
2015-09-30 08:54:45 [root] WARNING: 109
2015-09-30 08:54:45 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:45 [root] WARNING: horse code set
2015-09-30 08:54:45 [root] WARNING: 110
2015-09-30 08:54:45 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:45 [root] WARNING: horse code set
2015-09-30 08:54:45 [root] WARNING: 111
2015-09-30 08:54:45 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:45 [root] WARNING: horse code set
2015-09-30 08:54:45 [root] WARNING: 112
2015-09-30 08:54:45 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:45 [root] WARNING: horse code set
2015-09-30 08:54:45 [root] WARNING: 113
2015-09-30 08:54:45 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:45 [root] WARNING: horse code set
2015-09-30 08:54:45 [root] WARNING: 114
2015-09-30 08:54:45 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:45 [root] WARNING: horse code set
2015-09-30 08:54:45 [root] WARNING: 115
2015-09-30 08:54:45 [root] WARNING: -------------------------------------------------
2015-09-30 08:54:45 [root] WARNING: horse code set
2015-09-30 08:54:45 [root] WARNING: 116
2015-09-30 08:54:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T009&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:54:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:54:46 [root] WARNING: 4
2015-09-30 08:54:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T009&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:54:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T238&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:54:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:54:46 [root] WARNING: 5
2015-09-30 08:54:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T238&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:54:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S022&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:54:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:54:47 [root] WARNING: 6
2015-09-30 08:54:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S022&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:54:50 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P158&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:54:50 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T288&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:54:50 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:54:50 [root] WARNING: 7
2015-09-30 08:54:50 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P158&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:54:50 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:54:50 [root] WARNING: 8
2015-09-30 08:54:50 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T288&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:54:53 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N033&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:54:53 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:54:53 [root] WARNING: 9
2015-09-30 08:54:53 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N033&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:54:53 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P222&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:54:53 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:54:53 [root] WARNING: 10
2015-09-30 08:54:53 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P222&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:54:54 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P103&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:54:54 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:54:54 [root] WARNING: 11
2015-09-30 08:54:54 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P103&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:54:54 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T135&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:54:55 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:54:55 [root] WARNING: 12
2015-09-30 08:54:55 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T135&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:54:55 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S305&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:54:55 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:54:55 [root] WARNING: 13
2015-09-30 08:54:55 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S305&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:54:55 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P031&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:54:55 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:54:55 [root] WARNING: 14
2015-09-30 08:54:55 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P031&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:54:57 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S346&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:54:57 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:54:57 [root] WARNING: 15
2015-09-30 08:54:57 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S346&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:02 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:55:02 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P358&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:55:02 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:02 [root] WARNING: 16
2015-09-30 08:55:02 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:02 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:02 [root] WARNING: 17
2015-09-30 08:55:02 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P358&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:04 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T080&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:55:04 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:04 [root] WARNING: 18
2015-09-30 08:55:04 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T080&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:05 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S076&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:55:05 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:05 [root] WARNING: 19
2015-09-30 08:55:05 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S076&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:06 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T205&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:55:06 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P151&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:55:06 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:06 [root] WARNING: 20
2015-09-30 08:55:06 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T205&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:06 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:06 [root] WARNING: 21
2015-09-30 08:55:06 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P151&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:55:06 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T005&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:55:06 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V061&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:55:06 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:06 [root] WARNING: 22
2015-09-30 08:55:06 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T005&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:06 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:06 [root] WARNING: 23
2015-09-30 08:55:06 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V061&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 757, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 08:55:08 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N234&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:55:08 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:08 [root] WARNING: 24
2015-09-30 08:55:08 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N234&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:55:09 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T342&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:55:09 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:09 [root] WARNING: 25
2015-09-30 08:55:09 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T342&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:09 [scrapy] INFO: Crawled 38 pages (at 38 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 08:55:10 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V039&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:55:10 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N330&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:55:10 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:10 [root] WARNING: 26
2015-09-30 08:55:10 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V039&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 757, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 08:55:10 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:10 [root] WARNING: 27
2015-09-30 08:55:10 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N330&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:55:12 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T333&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:55:12 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:12 [root] WARNING: 28
2015-09-30 08:55:12 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T333&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:12 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:55:13 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:13 [root] WARNING: 29
2015-09-30 08:55:13 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:14 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T340&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:55:14 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:14 [root] WARNING: 30
2015-09-30 08:55:14 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T340&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 757, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 08:55:17 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S397&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:55:17 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:17 [root] WARNING: 31
2015-09-30 08:55:17 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S397&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:18 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P097&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:55:18 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:18 [root] WARNING: 32
2015-09-30 08:55:19 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P097&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:55:19 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S332&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:55:19 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:19 [root] WARNING: 33
2015-09-30 08:55:19 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S332&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 755, in parse_horse
    total_winodds = sum([x for x in enumerate(prev_winodds) if i in winning_indexes])
TypeError: unsupported operand type(s) for +: 'int' and 'tuple'
2015-09-30 08:55:21 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:55:21 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:21 [root] WARNING: 34
2015-09-30 08:55:21 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:21 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S023&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:55:21 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:21 [root] WARNING: 35
2015-09-30 08:55:21 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S023&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:24 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S100&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:55:24 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T168&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:55:24 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:24 [root] WARNING: 36
2015-09-30 08:55:24 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S100&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:24 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:24 [root] WARNING: 37
2015-09-30 08:55:24 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T168&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:24 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N226&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 08:55:24 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:24 [root] WARNING: 38
2015-09-30 08:55:25 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N226&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:25 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S300&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:55:25 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S209&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:55:25 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:25 [root] WARNING: 39
2015-09-30 08:55:25 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S300&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:55:25 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:25 [root] WARNING: 40
2015-09-30 08:55:25 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S209&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:27 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T002&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:55:27 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:27 [root] WARNING: 41
2015-09-30 08:55:27 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T002&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:28 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:55:28 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:28 [root] WARNING: 42
2015-09-30 08:55:28 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:28 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P044&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 08:55:29 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:29 [root] WARNING: 43
2015-09-30 08:55:29 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P044&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:29 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N220&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:55:29 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:29 [root] WARNING: 44
2015-09-30 08:55:29 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N220&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:34 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P316&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:55:34 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T265&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:55:34 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T004&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:55:34 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:34 [root] WARNING: 45
2015-09-30 08:55:34 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P316&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:34 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:34 [root] WARNING: 46
2015-09-30 08:55:34 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T265&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:34 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:34 [root] WARNING: 47
2015-09-30 08:55:34 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T004&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:55:34 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S375&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:55:34 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:55:34 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:34 [root] WARNING: 48
2015-09-30 08:55:35 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S375&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:35 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:35 [root] WARNING: 49
2015-09-30 08:55:35 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:36 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S421&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:55:36 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:36 [root] WARNING: 50
2015-09-30 08:55:36 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S421&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:38 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:55:38 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T404&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:55:38 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:38 [root] WARNING: 51
2015-09-30 08:55:39 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:39 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:39 [root] WARNING: 52
2015-09-30 08:55:39 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T404&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 757, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 08:55:40 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T215&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:55:40 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:40 [root] WARNING: 53
2015-09-30 08:55:40 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T215&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:40 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M227&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 08:55:40 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:40 [root] WARNING: 54
2015-09-30 08:55:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M227&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:44 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P173&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:55:44 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:44 [root] WARNING: 55
2015-09-30 08:55:44 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P173&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:55:45 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S349&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:55:45 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:45 [root] WARNING: 56
2015-09-30 08:55:45 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S349&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:45 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N432&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:55:45 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:45 [root] WARNING: 57
2015-09-30 08:55:45 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N432&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:55:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:55:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:55:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:46 [root] WARNING: 58
2015-09-30 08:55:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:46 [root] WARNING: 59
2015-09-30 08:55:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T111&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:55:48 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:48 [root] WARNING: 60
2015-09-30 08:55:48 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T111&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:49 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N386&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:55:49 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:49 [root] WARNING: 61
2015-09-30 08:55:49 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N386&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:55:50 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:55:50 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:50 [root] WARNING: 62
2015-09-30 08:55:50 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 757, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 08:55:51 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S225&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:55:51 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:51 [root] WARNING: 63
2015-09-30 08:55:51 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S225&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:51 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S165&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:55:51 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:51 [root] WARNING: 64
2015-09-30 08:55:52 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S165&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:52 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:55:52 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:52 [root] WARNING: 65
2015-09-30 08:55:52 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:55:52 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T289&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:55:52 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:52 [root] WARNING: 66
2015-09-30 08:55:52 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T289&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:53 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T379&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:55:53 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:53 [root] WARNING: 67
2015-09-30 08:55:53 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T379&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:53 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S415&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:55:53 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:53 [root] WARNING: 68
2015-09-30 08:55:53 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S415&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:54 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 08:55:54 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:54 [root] WARNING: 69
2015-09-30 08:55:54 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:54 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T050&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:55:54 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:54 [root] WARNING: 70
2015-09-30 08:55:54 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T050&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:55:55 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N419&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:55:55 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:55 [root] WARNING: 71
2015-09-30 08:55:55 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N419&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:55:58 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T129&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:55:58 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:55:58 [root] WARNING: 72
2015-09-30 08:55:58 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T129&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:56:01 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S275&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:56:01 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:01 [root] WARNING: 73
2015-09-30 08:56:01 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S275&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:56:02 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S394&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 08:56:02 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:02 [root] WARNING: 74
2015-09-30 08:56:02 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S394&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:56:05 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:56:05 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T235&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:56:06 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:06 [root] WARNING: 75
2015-09-30 08:56:06 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:56:06 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:06 [root] WARNING: 76
2015-09-30 08:56:06 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T235&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:56:09 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:56:09 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:09 [root] WARNING: 77
2015-09-30 08:56:09 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:56:09 [scrapy] INFO: Crawled 90 pages (at 52 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 08:56:10 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:56:10 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:10 [root] WARNING: 78
2015-09-30 08:56:10 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:56:12 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P195&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:56:12 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:12 [root] WARNING: 79
2015-09-30 08:56:12 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P195&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:56:13 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N236&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:56:13 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:13 [root] WARNING: 80
2015-09-30 08:56:13 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N236&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:56:14 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:56:15 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:56:15 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:15 [root] WARNING: 81
2015-09-30 08:56:15 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:56:15 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:15 [root] WARNING: 82
2015-09-30 08:56:15 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:56:15 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P180&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:56:16 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:16 [root] WARNING: 83
2015-09-30 08:56:16 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P180&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:56:16 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N171&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:56:16 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:16 [root] WARNING: 84
2015-09-30 08:56:16 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N171&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:56:16 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N297&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 08:56:16 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:16 [root] WARNING: 85
2015-09-30 08:56:17 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N297&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:56:20 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:56:20 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N434&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:56:20 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:20 [root] WARNING: 86
2015-09-30 08:56:20 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:56:20 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T257&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:56:20 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:20 [root] WARNING: 87
2015-09-30 08:56:20 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N434&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:56:20 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:20 [root] WARNING: 88
2015-09-30 08:56:20 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T257&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:56:21 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T093&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:56:21 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:21 [root] WARNING: 89
2015-09-30 08:56:21 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T093&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:56:22 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T256&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:56:22 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:22 [root] WARNING: 90
2015-09-30 08:56:22 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T256&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:56:25 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S296&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:56:25 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:25 [root] WARNING: 91
2015-09-30 08:56:25 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S296&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:56:27 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S420&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:56:27 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:27 [root] WARNING: 92
2015-09-30 08:56:27 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S420&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 755, in parse_horse
    total_winodds = sum([x for x in enumerate(prev_winodds) if i in winning_indexes])
TypeError: unsupported operand type(s) for +: 'int' and 'tuple'
2015-09-30 08:56:27 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T170&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:56:27 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:27 [root] WARNING: 93
2015-09-30 08:56:27 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T170&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:56:29 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P111&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:56:29 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:29 [root] WARNING: 94
2015-09-30 08:56:29 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P111&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:56:30 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T112&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:56:30 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:30 [root] WARNING: 95
2015-09-30 08:56:30 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T112&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:56:30 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S278&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:56:30 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:30 [root] WARNING: 96
2015-09-30 08:56:31 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S278&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 755, in parse_horse
    total_winodds = sum([x for x in enumerate(prev_winodds) if i in winning_indexes])
TypeError: unsupported operand type(s) for +: 'int' and 'tuple'
2015-09-30 08:56:31 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S282&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:56:31 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:31 [root] WARNING: 97
2015-09-30 08:56:31 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S282&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 755, in parse_horse
    total_winodds = sum([x for x in enumerate(prev_winodds) if i in winning_indexes])
TypeError: unsupported operand type(s) for +: 'int' and 'tuple'
2015-09-30 08:56:32 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T148&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:56:32 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:32 [root] WARNING: 98
2015-09-30 08:56:32 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T148&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:56:32 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M199&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:56:32 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:32 [root] WARNING: 99
2015-09-30 08:56:33 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M199&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:56:33 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N394&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 08:56:33 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S391&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:56:33 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:33 [root] WARNING: 100
2015-09-30 08:56:34 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N394&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:56:34 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:34 [root] WARNING: 101
2015-09-30 08:56:34 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S391&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 755, in parse_horse
    total_winodds = sum([x for x in enumerate(prev_winodds) if i in winning_indexes])
TypeError: unsupported operand type(s) for +: 'int' and 'tuple'
2015-09-30 08:56:36 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S109&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:56:36 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:36 [root] WARNING: 102
2015-09-30 08:56:36 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S109&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:56:37 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P118&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:56:38 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:38 [root] WARNING: 103
2015-09-30 08:56:38 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P118&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:56:38 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S145&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:56:39 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P191&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:56:39 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:39 [root] WARNING: 104
2015-09-30 08:56:39 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S145&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 755, in parse_horse
    total_winodds = sum([x for x in enumerate(prev_winodds) if i in winning_indexes])
TypeError: unsupported operand type(s) for +: 'int' and 'tuple'
2015-09-30 08:56:39 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:39 [root] WARNING: 105
2015-09-30 08:56:39 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P191&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:56:39 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P366&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:56:39 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:39 [root] WARNING: 106
2015-09-30 08:56:39 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P366&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    len(wins_d_ind),len(placed_indexes_d), len(f4_indexes_d),prev_avg_spds_d), tuple(min_max_mean(prev_avg_spds_d)) )
IndexError: tuple index out of range
2015-09-30 08:56:42 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N169&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:56:43 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:43 [root] WARNING: 107
2015-09-30 08:56:43 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N169&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:56:43 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:56:43 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:43 [root] WARNING: 108
2015-09-30 08:56:43 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:56:44 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S117&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:56:44 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:44 [root] WARNING: 109
2015-09-30 08:56:44 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S117&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 755, in parse_horse
    total_winodds = sum([x for x in enumerate(prev_winodds) if i in winning_indexes])
TypeError: unsupported operand type(s) for +: 'int' and 'tuple'
2015-09-30 08:56:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S110&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:56:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:46 [root] WARNING: 110
2015-09-30 08:56:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S110&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    print ("DISTANCE: {}, wins {}, places: {}, f4s: {}, avgftimes {} max, min, mean {}".format(len(d_ind),\
IndexError: tuple index out of range
2015-09-30 08:56:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T096&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:56:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:47 [root] WARNING: 111
2015-09-30 08:56:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T096&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    print ("DISTANCE: {}, wins {}, places: {}, f4s: {}, avgftimes {} max, min, mean {}".format(len(d_ind),\
IndexError: tuple index out of range
2015-09-30 08:56:50 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T398&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:56:50 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:50 [root] WARNING: 112
2015-09-30 08:56:50 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T398&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 757, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 08:56:50 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S439&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:56:50 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:50 [root] WARNING: 113
2015-09-30 08:56:50 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S439&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    print ("DISTANCE: {}, wins {}, places: {}, f4s: {}, avgftimes {} max, min, mean {}".format(len(d_ind),\
IndexError: tuple index out of range
2015-09-30 08:56:50 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S010&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:56:50 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:50 [root] WARNING: 114
2015-09-30 08:56:50 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S010&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 796, in parse_horse
    print ("DISTANCE: {}, wins {}, places: {}, f4s: {}, avgftimes {} max, min, mean {}".format(len(d_ind),\
IndexError: tuple index out of range
2015-09-30 08:56:51 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N195&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 08:56:51 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:51 [root] WARNING: 115
2015-09-30 08:56:51 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N195&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 631, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 08:56:51 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S398&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 08:56:51 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 08:56:51 [root] WARNING: 116
2015-09-30 08:56:51 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S398&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 755, in parse_horse
    total_winodds = sum([x for x in enumerate(prev_winodds) if i in winning_indexes])
TypeError: unsupported operand type(s) for +: 'int' and 'tuple'
2015-09-30 08:56:51 [scrapy] INFO: Closing spider (finished)
2015-09-30 08:56:51 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 65590,
 'downloader/request_count': 130,
 'downloader/request_method_count/GET': 129,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 10043019,
 'downloader/response_count': 130,
 'downloader/response_status_count/200': 129,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 8, 56, 51, 517662),
 'log_count/DEBUG': 132,
 'log_count/ERROR': 116,
 'log_count/INFO': 9,
 'log_count/WARNING': 580,
 'request_depth_max': 5,
 'response_received_count': 129,
 'scheduler/dequeued': 130,
 'scheduler/dequeued/memory': 130,
 'scheduler/enqueued': 130,
 'scheduler/enqueued/memory': 130,
 'spider_exceptions/IndexError': 72,
 'spider_exceptions/TypeError': 9,
 'spider_exceptions/ValueError': 29,
 'spider_exceptions/ZeroDivisionError': 6,
 'start_time': datetime.datetime(2015, 9, 30, 8, 54, 9, 666342)}
2015-09-30 08:56:51 [scrapy] INFO: Spider closed (finished)
2015-09-30 09:09:11 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 09:09:11 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 09:09:11 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 09:09:11 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 09:09:11 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 09:09:11 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 09:09:11 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 09:09:11 [scrapy] INFO: Spider opened
2015-09-30 09:09:11 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 09:09:11 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 09:09:14 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 09:09:18 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 09:10:11 [scrapy] INFO: Crawled 1 pages (at 1 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 09:10:49 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 09:11:11 [scrapy] INFO: Crawled 2 pages (at 1 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 09:12:11 [scrapy] INFO: Crawled 2 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 09:13:11 [scrapy] INFO: Crawled 2 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 09:13:49 [scrapy] DEBUG: Retrying <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (failed 1 times): User timeout caused connection failure: Getting http://racing.scmp.com/racecardpro/racecardpro.asp took longer than 180.0 seconds..
2015-09-30 09:13:51 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 09:13:55 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 09:13:55 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 09:13:58 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 09:13:58 [root] WARNING: -------------------------------------------------
2015-09-30 09:13:58 [root] WARNING: horse code set
2015-09-30 09:13:58 [root] WARNING: 1
2015-09-30 09:13:58 [root] WARNING: -------------------------------------------------
2015-09-30 09:13:58 [root] WARNING: horse code set
2015-09-30 09:13:58 [root] WARNING: 2
2015-09-30 09:13:58 [root] WARNING: -------------------------------------------------
2015-09-30 09:13:58 [root] WARNING: horse code set
2015-09-30 09:13:58 [root] WARNING: 3
2015-09-30 09:13:58 [root] WARNING: -------------------------------------------------
2015-09-30 09:13:58 [root] WARNING: horse code set
2015-09-30 09:13:58 [root] WARNING: 4
2015-09-30 09:13:58 [root] WARNING: -------------------------------------------------
2015-09-30 09:13:58 [root] WARNING: horse code set
2015-09-30 09:13:58 [root] WARNING: 5
2015-09-30 09:13:58 [root] WARNING: -------------------------------------------------
2015-09-30 09:13:58 [root] WARNING: horse code set
2015-09-30 09:13:58 [root] WARNING: 6
2015-09-30 09:13:58 [root] WARNING: -------------------------------------------------
2015-09-30 09:13:58 [root] WARNING: horse code set
2015-09-30 09:13:58 [root] WARNING: 7
2015-09-30 09:13:59 [root] WARNING: -------------------------------------------------
2015-09-30 09:13:59 [root] WARNING: horse code set
2015-09-30 09:13:59 [root] WARNING: 8
2015-09-30 09:13:59 [root] WARNING: -------------------------------------------------
2015-09-30 09:13:59 [root] WARNING: horse code set
2015-09-30 09:13:59 [root] WARNING: 9
2015-09-30 09:13:59 [root] WARNING: -------------------------------------------------
2015-09-30 09:13:59 [root] WARNING: horse code set
2015-09-30 09:13:59 [root] WARNING: 10
2015-09-30 09:13:59 [root] WARNING: -------------------------------------------------
2015-09-30 09:13:59 [root] WARNING: horse code set
2015-09-30 09:13:59 [root] WARNING: 11
2015-09-30 09:13:59 [root] WARNING: -------------------------------------------------
2015-09-30 09:13:59 [root] WARNING: horse code set
2015-09-30 09:13:59 [root] WARNING: 12
2015-09-30 09:13:59 [root] WARNING: -------------------------------------------------
2015-09-30 09:13:59 [root] WARNING: horse code set
2015-09-30 09:13:59 [root] WARNING: 13
2015-09-30 09:13:59 [root] WARNING: -------------------------------------------------
2015-09-30 09:13:59 [root] WARNING: horse code set
2015-09-30 09:13:59 [root] WARNING: 14
2015-09-30 09:14:01 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 09:14:01 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:01 [root] WARNING: horse code set
2015-09-30 09:14:01 [root] WARNING: 15
2015-09-30 09:14:01 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:01 [root] WARNING: horse code set
2015-09-30 09:14:01 [root] WARNING: 16
2015-09-30 09:14:01 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:01 [root] WARNING: horse code set
2015-09-30 09:14:01 [root] WARNING: 17
2015-09-30 09:14:01 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:01 [root] WARNING: horse code set
2015-09-30 09:14:01 [root] WARNING: 18
2015-09-30 09:14:01 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:01 [root] WARNING: horse code set
2015-09-30 09:14:01 [root] WARNING: 19
2015-09-30 09:14:01 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:01 [root] WARNING: horse code set
2015-09-30 09:14:01 [root] WARNING: 20
2015-09-30 09:14:01 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:01 [root] WARNING: horse code set
2015-09-30 09:14:01 [root] WARNING: 21
2015-09-30 09:14:01 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:01 [root] WARNING: horse code set
2015-09-30 09:14:01 [root] WARNING: 22
2015-09-30 09:14:01 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:01 [root] WARNING: horse code set
2015-09-30 09:14:01 [root] WARNING: 23
2015-09-30 09:14:01 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:01 [root] WARNING: horse code set
2015-09-30 09:14:01 [root] WARNING: 24
2015-09-30 09:14:01 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:01 [root] WARNING: horse code set
2015-09-30 09:14:01 [root] WARNING: 25
2015-09-30 09:14:01 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:01 [root] WARNING: horse code set
2015-09-30 09:14:01 [root] WARNING: 26
2015-09-30 09:14:01 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:01 [root] WARNING: horse code set
2015-09-30 09:14:01 [root] WARNING: 27
2015-09-30 09:14:01 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:01 [root] WARNING: horse code set
2015-09-30 09:14:01 [root] WARNING: 28
2015-09-30 09:14:02 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 09:14:02 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:02 [root] WARNING: horse code set
2015-09-30 09:14:02 [root] WARNING: 29
2015-09-30 09:14:02 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:02 [root] WARNING: horse code set
2015-09-30 09:14:02 [root] WARNING: 30
2015-09-30 09:14:02 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:02 [root] WARNING: horse code set
2015-09-30 09:14:02 [root] WARNING: 31
2015-09-30 09:14:02 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:02 [root] WARNING: horse code set
2015-09-30 09:14:02 [root] WARNING: 32
2015-09-30 09:14:02 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:02 [root] WARNING: horse code set
2015-09-30 09:14:02 [root] WARNING: 33
2015-09-30 09:14:02 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:02 [root] WARNING: horse code set
2015-09-30 09:14:02 [root] WARNING: 34
2015-09-30 09:14:02 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:02 [root] WARNING: horse code set
2015-09-30 09:14:02 [root] WARNING: 35
2015-09-30 09:14:02 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:02 [root] WARNING: horse code set
2015-09-30 09:14:02 [root] WARNING: 36
2015-09-30 09:14:02 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:02 [root] WARNING: horse code set
2015-09-30 09:14:02 [root] WARNING: 37
2015-09-30 09:14:02 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:02 [root] WARNING: horse code set
2015-09-30 09:14:02 [root] WARNING: 38
2015-09-30 09:14:02 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:02 [root] WARNING: horse code set
2015-09-30 09:14:02 [root] WARNING: 39
2015-09-30 09:14:02 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:02 [root] WARNING: horse code set
2015-09-30 09:14:02 [root] WARNING: 40
2015-09-30 09:14:02 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:02 [root] WARNING: horse code set
2015-09-30 09:14:02 [root] WARNING: 41
2015-09-30 09:14:02 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:02 [root] WARNING: horse code set
2015-09-30 09:14:02 [root] WARNING: 42
2015-09-30 09:14:04 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 09:14:04 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:04 [root] WARNING: horse code set
2015-09-30 09:14:04 [root] WARNING: 43
2015-09-30 09:14:04 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:04 [root] WARNING: horse code set
2015-09-30 09:14:04 [root] WARNING: 44
2015-09-30 09:14:04 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:04 [root] WARNING: horse code set
2015-09-30 09:14:04 [root] WARNING: 45
2015-09-30 09:14:04 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:04 [root] WARNING: horse code set
2015-09-30 09:14:04 [root] WARNING: 46
2015-09-30 09:14:04 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:04 [root] WARNING: horse code set
2015-09-30 09:14:04 [root] WARNING: 47
2015-09-30 09:14:04 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:04 [root] WARNING: horse code set
2015-09-30 09:14:04 [root] WARNING: 48
2015-09-30 09:14:04 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:04 [root] WARNING: horse code set
2015-09-30 09:14:04 [root] WARNING: 49
2015-09-30 09:14:04 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:04 [root] WARNING: horse code set
2015-09-30 09:14:04 [root] WARNING: 50
2015-09-30 09:14:04 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:04 [root] WARNING: horse code set
2015-09-30 09:14:04 [root] WARNING: 51
2015-09-30 09:14:04 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:04 [root] WARNING: horse code set
2015-09-30 09:14:04 [root] WARNING: 52
2015-09-30 09:14:04 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:04 [root] WARNING: horse code set
2015-09-30 09:14:04 [root] WARNING: 53
2015-09-30 09:14:04 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:04 [root] WARNING: horse code set
2015-09-30 09:14:04 [root] WARNING: 54
2015-09-30 09:14:05 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 09:14:05 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:05 [root] WARNING: horse code set
2015-09-30 09:14:05 [root] WARNING: 55
2015-09-30 09:14:05 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:05 [root] WARNING: horse code set
2015-09-30 09:14:05 [root] WARNING: 56
2015-09-30 09:14:05 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:05 [root] WARNING: horse code set
2015-09-30 09:14:05 [root] WARNING: 57
2015-09-30 09:14:05 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:05 [root] WARNING: horse code set
2015-09-30 09:14:05 [root] WARNING: 58
2015-09-30 09:14:05 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:05 [root] WARNING: horse code set
2015-09-30 09:14:05 [root] WARNING: 59
2015-09-30 09:14:05 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:05 [root] WARNING: horse code set
2015-09-30 09:14:05 [root] WARNING: 60
2015-09-30 09:14:05 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:05 [root] WARNING: horse code set
2015-09-30 09:14:05 [root] WARNING: 61
2015-09-30 09:14:05 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:05 [root] WARNING: horse code set
2015-09-30 09:14:05 [root] WARNING: 62
2015-09-30 09:14:05 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:05 [root] WARNING: horse code set
2015-09-30 09:14:05 [root] WARNING: 63
2015-09-30 09:14:05 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:05 [root] WARNING: horse code set
2015-09-30 09:14:05 [root] WARNING: 64
2015-09-30 09:14:05 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:05 [root] WARNING: horse code set
2015-09-30 09:14:05 [root] WARNING: 65
2015-09-30 09:14:05 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:05 [root] WARNING: horse code set
2015-09-30 09:14:05 [root] WARNING: 66
2015-09-30 09:14:05 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:05 [root] WARNING: horse code set
2015-09-30 09:14:05 [root] WARNING: 67
2015-09-30 09:14:05 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:05 [root] WARNING: horse code set
2015-09-30 09:14:05 [root] WARNING: 68
2015-09-30 09:14:06 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 09:14:06 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:06 [root] WARNING: horse code set
2015-09-30 09:14:06 [root] WARNING: 69
2015-09-30 09:14:06 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:06 [root] WARNING: horse code set
2015-09-30 09:14:06 [root] WARNING: 70
2015-09-30 09:14:06 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:06 [root] WARNING: horse code set
2015-09-30 09:14:06 [root] WARNING: 71
2015-09-30 09:14:06 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:06 [root] WARNING: horse code set
2015-09-30 09:14:06 [root] WARNING: 72
2015-09-30 09:14:06 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:06 [root] WARNING: horse code set
2015-09-30 09:14:06 [root] WARNING: 73
2015-09-30 09:14:06 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:06 [root] WARNING: horse code set
2015-09-30 09:14:06 [root] WARNING: 74
2015-09-30 09:14:06 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:06 [root] WARNING: horse code set
2015-09-30 09:14:06 [root] WARNING: 75
2015-09-30 09:14:06 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:06 [root] WARNING: horse code set
2015-09-30 09:14:06 [root] WARNING: 76
2015-09-30 09:14:06 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:06 [root] WARNING: horse code set
2015-09-30 09:14:06 [root] WARNING: 77
2015-09-30 09:14:06 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:06 [root] WARNING: horse code set
2015-09-30 09:14:06 [root] WARNING: 78
2015-09-30 09:14:06 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:06 [root] WARNING: horse code set
2015-09-30 09:14:06 [root] WARNING: 79
2015-09-30 09:14:06 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:06 [root] WARNING: horse code set
2015-09-30 09:14:06 [root] WARNING: 80
2015-09-30 09:14:06 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:06 [root] WARNING: horse code set
2015-09-30 09:14:06 [root] WARNING: 81
2015-09-30 09:14:06 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:06 [root] WARNING: horse code set
2015-09-30 09:14:06 [root] WARNING: 82
2015-09-30 09:14:07 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 09:14:07 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:07 [root] WARNING: horse code set
2015-09-30 09:14:07 [root] WARNING: 83
2015-09-30 09:14:07 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:07 [root] WARNING: horse code set
2015-09-30 09:14:07 [root] WARNING: 84
2015-09-30 09:14:07 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:07 [root] WARNING: horse code set
2015-09-30 09:14:07 [root] WARNING: 85
2015-09-30 09:14:07 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:07 [root] WARNING: horse code set
2015-09-30 09:14:07 [root] WARNING: 86
2015-09-30 09:14:07 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:07 [root] WARNING: horse code set
2015-09-30 09:14:07 [root] WARNING: 87
2015-09-30 09:14:07 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:07 [root] WARNING: horse code set
2015-09-30 09:14:07 [root] WARNING: 88
2015-09-30 09:14:07 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:07 [root] WARNING: horse code set
2015-09-30 09:14:07 [root] WARNING: 89
2015-09-30 09:14:07 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:07 [root] WARNING: horse code set
2015-09-30 09:14:07 [root] WARNING: 90
2015-09-30 09:14:07 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:07 [root] WARNING: horse code set
2015-09-30 09:14:07 [root] WARNING: 91
2015-09-30 09:14:07 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:07 [root] WARNING: horse code set
2015-09-30 09:14:07 [root] WARNING: 92
2015-09-30 09:14:07 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:07 [root] WARNING: horse code set
2015-09-30 09:14:07 [root] WARNING: 93
2015-09-30 09:14:08 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 09:14:08 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:08 [root] WARNING: horse code set
2015-09-30 09:14:08 [root] WARNING: 94
2015-09-30 09:14:08 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:08 [root] WARNING: horse code set
2015-09-30 09:14:08 [root] WARNING: 95
2015-09-30 09:14:08 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:08 [root] WARNING: horse code set
2015-09-30 09:14:08 [root] WARNING: 96
2015-09-30 09:14:08 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:08 [root] WARNING: horse code set
2015-09-30 09:14:08 [root] WARNING: 97
2015-09-30 09:14:08 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:08 [root] WARNING: horse code set
2015-09-30 09:14:08 [root] WARNING: 98
2015-09-30 09:14:08 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:08 [root] WARNING: horse code set
2015-09-30 09:14:08 [root] WARNING: 99
2015-09-30 09:14:08 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:08 [root] WARNING: horse code set
2015-09-30 09:14:08 [root] WARNING: 100
2015-09-30 09:14:08 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:08 [root] WARNING: horse code set
2015-09-30 09:14:08 [root] WARNING: 101
2015-09-30 09:14:08 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:08 [root] WARNING: horse code set
2015-09-30 09:14:08 [root] WARNING: 102
2015-09-30 09:14:09 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/1)
2015-09-30 09:14:09 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:09 [root] WARNING: horse code set
2015-09-30 09:14:09 [root] WARNING: 103
2015-09-30 09:14:09 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:09 [root] WARNING: horse code set
2015-09-30 09:14:09 [root] WARNING: 104
2015-09-30 09:14:09 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:09 [root] WARNING: horse code set
2015-09-30 09:14:09 [root] WARNING: 105
2015-09-30 09:14:09 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:09 [root] WARNING: horse code set
2015-09-30 09:14:09 [root] WARNING: 106
2015-09-30 09:14:09 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:09 [root] WARNING: horse code set
2015-09-30 09:14:09 [root] WARNING: 107
2015-09-30 09:14:09 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:09 [root] WARNING: horse code set
2015-09-30 09:14:09 [root] WARNING: 108
2015-09-30 09:14:09 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:09 [root] WARNING: horse code set
2015-09-30 09:14:09 [root] WARNING: 109
2015-09-30 09:14:09 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:09 [root] WARNING: horse code set
2015-09-30 09:14:09 [root] WARNING: 110
2015-09-30 09:14:09 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:09 [root] WARNING: horse code set
2015-09-30 09:14:09 [root] WARNING: 111
2015-09-30 09:14:09 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:09 [root] WARNING: horse code set
2015-09-30 09:14:09 [root] WARNING: 112
2015-09-30 09:14:09 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:09 [root] WARNING: horse code set
2015-09-30 09:14:09 [root] WARNING: 113
2015-09-30 09:14:09 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:09 [root] WARNING: horse code set
2015-09-30 09:14:09 [root] WARNING: 114
2015-09-30 09:14:09 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:09 [root] WARNING: horse code set
2015-09-30 09:14:09 [root] WARNING: 115
2015-09-30 09:14:09 [root] WARNING: -------------------------------------------------
2015-09-30 09:14:09 [root] WARNING: horse code set
2015-09-30 09:14:09 [root] WARNING: 116
2015-09-30 09:14:10 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T200&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 09:14:10 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:14:10 [root] WARNING: 1
2015-09-30 09:14:10 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T200&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:14:11 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P372&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 09:14:11 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:14:11 [root] WARNING: 2
2015-09-30 09:14:11 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P372&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:14:11 [scrapy] INFO: Crawled 15 pages (at 13 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 09:14:12 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T238&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 09:14:12 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:14:12 [root] WARNING: 3
2015-09-30 09:14:12 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T238&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:14:15 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T009&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 09:14:15 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:14:15 [root] WARNING: 4
2015-09-30 09:14:15 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T009&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:14:19 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 09:14:19 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:14:19 [root] WARNING: 5
2015-09-30 09:14:19 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:14:21 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P103&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 09:14:21 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:14:21 [root] WARNING: 6
2015-09-30 09:14:21 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P103&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:14:22 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T288&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 09:14:22 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:14:22 [root] WARNING: 7
2015-09-30 09:14:22 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T288&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:14:23 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S022&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 09:14:23 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:14:23 [root] WARNING: 8
2015-09-30 09:14:23 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S022&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 624, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 09:14:24 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N033&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 09:14:25 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:14:25 [root] WARNING: 9
2015-09-30 09:14:25 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N033&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 624, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 09:14:25 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P222&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 09:14:25 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:14:25 [root] WARNING: 10
2015-09-30 09:14:25 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P222&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:14:27 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S305&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 09:14:27 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:14:27 [root] WARNING: 11
2015-09-30 09:14:27 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S305&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:14:27 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T135&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 09:14:28 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S346&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 09:14:28 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:14:28 [root] WARNING: 12
2015-09-30 09:14:28 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T135&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:14:28 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:14:28 [root] WARNING: 13
2015-09-30 09:14:28 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S346&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:14:28 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P158&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 09:14:28 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:14:28 [root] WARNING: 14
2015-09-30 09:14:29 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P158&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 624, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 09:14:31 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P031&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 09:14:31 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:14:31 [root] WARNING: 15
2015-09-30 09:14:31 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P031&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:14:35 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T080&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 09:14:35 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:14:35 [root] WARNING: 16
2015-09-30 09:14:35 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T080&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:14:36 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V061&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 09:14:36 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:14:36 [root] WARNING: 17
2015-09-30 09:14:36 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V061&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 750, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 09:14:36 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T005&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 09:14:36 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:14:36 [root] WARNING: 18
2015-09-30 09:14:36 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T005&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:14:38 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T205&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 09:14:38 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:14:38 [root] WARNING: 19
2015-09-30 09:14:38 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T205&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:14:38 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V039&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 09:14:39 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:14:39 [root] WARNING: 20
2015-09-30 09:14:39 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=V039&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 750, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 09:14:39 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P358&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 09:14:39 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 09:14:39 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:14:39 [root] WARNING: 21
2015-09-30 09:14:40 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P358&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:14:40 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:14:40 [root] WARNING: 22
2015-09-30 09:14:40 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:14:40 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T342&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 09:14:40 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:14:40 [root] WARNING: 23
2015-09-30 09:14:40 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T342&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:14:41 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N234&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 09:14:41 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:14:41 [root] WARNING: 24
2015-09-30 09:14:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N234&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 624, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 09:14:41 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T333&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 09:14:42 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:14:42 [root] WARNING: 25
2015-09-30 09:14:42 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T333&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:14:42 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T340&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 09:14:42 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:14:42 [root] WARNING: 26
2015-09-30 09:14:42 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T340&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 750, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 09:14:45 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N330&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 09:14:45 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:14:45 [root] WARNING: 27
2015-09-30 09:14:45 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N330&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 624, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 09:14:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S397&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 09:14:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:14:47 [root] WARNING: 28
2015-09-30 09:14:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S397&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:14:51 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S076&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 09:14:51 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:14:51 [root] WARNING: 29
2015-09-30 09:14:51 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S076&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:14:52 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P097&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 09:14:52 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:14:52 [root] WARNING: 30
2015-09-30 09:14:52 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P097&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 624, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 09:14:53 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S332&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 09:14:54 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:14:54 [root] WARNING: 31
2015-09-30 09:14:54 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S332&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:14:56 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 09:14:56 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:14:56 [root] WARNING: 32
2015-09-30 09:14:56 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S188&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:14:57 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 09:14:57 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:14:57 [root] WARNING: 33
2015-09-30 09:14:57 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:14:58 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P151&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 09:14:59 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:14:59 [root] WARNING: 34
2015-09-30 09:14:59 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P151&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 624, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 09:14:59 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S100&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 09:14:59 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S023&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 09:14:59 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:14:59 [root] WARNING: 35
2015-09-30 09:14:59 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S100&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:14:59 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:14:59 [root] WARNING: 36
2015-09-30 09:14:59 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S023&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:15:01 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N226&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
2015-09-30 09:15:01 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:01 [root] WARNING: 37
2015-09-30 09:15:01 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N226&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:15:02 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T168&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 09:15:02 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:02 [root] WARNING: 38
2015-09-30 09:15:02 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T168&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:15:04 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P044&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
2015-09-30 09:15:04 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:04 [root] WARNING: 39
2015-09-30 09:15:04 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P044&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:15:05 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S209&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 09:15:05 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S300&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 09:15:05 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:05 [root] WARNING: 40
2015-09-30 09:15:05 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S209&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:15:05 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:05 [root] WARNING: 41
2015-09-30 09:15:05 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S300&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 624, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 09:15:09 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T002&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 09:15:09 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:09 [root] WARNING: 42
2015-09-30 09:15:09 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T002&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:15:11 [scrapy] INFO: Crawled 55 pages (at 40 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 09:15:12 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 09:15:13 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:13 [root] WARNING: 43
2015-09-30 09:15:13 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:15:15 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S375&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 09:15:15 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:15 [root] WARNING: 44
2015-09-30 09:15:15 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S375&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:15:16 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N220&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 09:15:16 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 09:15:16 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:16 [root] WARNING: 45
2015-09-30 09:15:16 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N220&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:15:16 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T265&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 09:15:16 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:16 [root] WARNING: 46
2015-09-30 09:15:16 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:15:16 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:16 [root] WARNING: 47
2015-09-30 09:15:16 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T265&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:15:18 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S421&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 09:15:18 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:18 [root] WARNING: 48
2015-09-30 09:15:18 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S421&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:15:22 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P316&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 09:15:22 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:22 [root] WARNING: 49
2015-09-30 09:15:22 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P316&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:15:23 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T004&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 09:15:23 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:23 [root] WARNING: 50
2015-09-30 09:15:23 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T004&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 624, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 09:15:25 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T404&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 09:15:26 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:26 [root] WARNING: 51
2015-09-30 09:15:26 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T404&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 750, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 09:15:29 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T215&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 09:15:29 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N432&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 09:15:30 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:30 [root] WARNING: 52
2015-09-30 09:15:30 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T215&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:15:30 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:30 [root] WARNING: 53
2015-09-30 09:15:30 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N432&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 624, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 09:15:31 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 09:15:31 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:31 [root] WARNING: 54
2015-09-30 09:15:31 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:15:33 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S349&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 09:15:33 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:33 [root] WARNING: 55
2015-09-30 09:15:33 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S349&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:15:36 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P173&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 09:15:36 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:36 [root] WARNING: 56
2015-09-30 09:15:36 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P173&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 624, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 09:15:38 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 09:15:38 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 09:15:38 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:38 [root] WARNING: 57
2015-09-30 09:15:38 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:15:38 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:38 [root] WARNING: 58
2015-09-30 09:15:38 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P295&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:15:39 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M227&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
2015-09-30 09:15:39 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:39 [root] WARNING: 59
2015-09-30 09:15:40 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M227&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:15:40 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S165&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 09:15:40 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:40 [root] WARNING: 60
2015-09-30 09:15:40 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S165&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:15:41 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T111&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 09:15:41 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:41 [root] WARNING: 61
2015-09-30 09:15:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T111&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:15:41 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N386&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 09:15:41 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:41 [root] WARNING: 62
2015-09-30 09:15:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N386&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 624, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 09:15:42 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S225&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 09:15:42 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:42 [root] WARNING: 63
2015-09-30 09:15:42 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S225&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:15:43 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
2015-09-30 09:15:43 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:43 [root] WARNING: 64
2015-09-30 09:15:43 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:15:45 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 09:15:45 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:45 [root] WARNING: 65
2015-09-30 09:15:45 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 624, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 09:15:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S415&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 09:15:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:47 [root] WARNING: 66
2015-09-30 09:15:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S415&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:15:48 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 09:15:48 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:48 [root] WARNING: 67
2015-09-30 09:15:48 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 750, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 09:15:49 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T379&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 09:15:49 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:49 [root] WARNING: 68
2015-09-30 09:15:49 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T379&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:15:50 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T289&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 09:15:50 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T050&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 09:15:50 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:50 [root] WARNING: 69
2015-09-30 09:15:50 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T289&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:15:50 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:50 [root] WARNING: 70
2015-09-30 09:15:50 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T050&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:15:53 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T129&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 09:15:53 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:53 [root] WARNING: 71
2015-09-30 09:15:53 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T129&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:15:54 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N419&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 09:15:55 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:55 [root] WARNING: 72
2015-09-30 09:15:55 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N419&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 624, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 09:15:55 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S394&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 09:15:55 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:55 [root] WARNING: 73
2015-09-30 09:15:55 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S394&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:15:56 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T235&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 09:15:56 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:56 [root] WARNING: 74
2015-09-30 09:15:56 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T235&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:15:58 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S275&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
2015-09-30 09:15:58 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:58 [root] WARNING: 75
2015-09-30 09:15:58 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S275&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:15:59 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 09:15:59 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:15:59 [root] WARNING: 76
2015-09-30 09:16:00 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P248&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:16:04 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N297&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 09:16:05 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P195&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 09:16:05 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:05 [root] WARNING: 77
2015-09-30 09:16:05 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N297&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:16:05 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 09:16:05 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:05 [root] WARNING: 78
2015-09-30 09:16:05 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P195&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 624, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 09:16:05 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:05 [root] WARNING: 79
2015-09-30 09:16:05 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P087&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:16:06 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P180&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 09:16:06 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:06 [root] WARNING: 80
2015-09-30 09:16:06 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P180&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 624, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 09:16:07 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N236&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 09:16:07 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:07 [root] WARNING: 81
2015-09-30 09:16:07 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N236&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:16:10 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 09:16:10 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:10 [root] WARNING: 82
2015-09-30 09:16:10 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N241&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 624, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 09:16:10 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 09:16:10 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:10 [root] WARNING: 83
2015-09-30 09:16:10 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N187&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 624, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 09:16:11 [scrapy] INFO: Crawled 96 pages (at 41 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 09:16:12 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 09:16:12 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:12 [root] WARNING: 84
2015-09-30 09:16:12 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S143&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 624, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 09:16:15 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N171&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
2015-09-30 09:16:15 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:15 [root] WARNING: 85
2015-09-30 09:16:15 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N171&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:16:17 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T257&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 09:16:17 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:17 [root] WARNING: 86
2015-09-30 09:16:17 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T257&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:16:17 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N434&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 09:16:17 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:17 [root] WARNING: 87
2015-09-30 09:16:17 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N434&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:16:17 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 09:16:17 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:17 [root] WARNING: 88
2015-09-30 09:16:17 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 624, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 09:16:23 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T256&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 09:16:23 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:23 [root] WARNING: 89
2015-09-30 09:16:23 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T256&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 624, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 09:16:25 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T093&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 09:16:25 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S296&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 09:16:25 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:25 [root] WARNING: 90
2015-09-30 09:16:25 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T093&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:16:25 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:25 [root] WARNING: 91
2015-09-30 09:16:25 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S296&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:16:28 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T170&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 09:16:28 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:28 [root] WARNING: 92
2015-09-30 09:16:28 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T170&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 624, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 09:16:29 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S420&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 09:16:29 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:29 [root] WARNING: 93
2015-09-30 09:16:29 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S420&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:16:31 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T112&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 09:16:31 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:31 [root] WARNING: 94
2015-09-30 09:16:31 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T112&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 624, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 09:16:31 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P111&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 09:16:31 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:31 [root] WARNING: 95
2015-09-30 09:16:31 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P111&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 624, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 09:16:32 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S278&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 09:16:32 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:32 [root] WARNING: 96
2015-09-30 09:16:32 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S278&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:16:33 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S282&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 09:16:33 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M199&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 09:16:33 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:33 [root] WARNING: 97
2015-09-30 09:16:33 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S282&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:16:33 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:33 [root] WARNING: 98
2015-09-30 09:16:33 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M199&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:16:33 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T148&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 09:16:34 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:34 [root] WARNING: 99
2015-09-30 09:16:34 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T148&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:16:40 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S391&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 09:16:41 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:41 [root] WARNING: 100
2015-09-30 09:16:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S391&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:16:42 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N394&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
2015-09-30 09:16:42 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:42 [root] WARNING: 101
2015-09-30 09:16:42 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N394&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:16:43 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S109&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 09:16:43 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:43 [root] WARNING: 102
2015-09-30 09:16:43 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S109&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:16:43 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P191&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 09:16:43 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:43 [root] WARNING: 103
2015-09-30 09:16:44 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P191&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 624, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 09:16:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P366&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 09:16:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:47 [root] WARNING: 104
2015-09-30 09:16:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P366&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:16:48 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S145&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 09:16:48 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:48 [root] WARNING: 105
2015-09-30 09:16:48 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S145&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:16:50 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 09:16:50 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:50 [root] WARNING: 106
2015-09-30 09:16:50 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 624, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 09:16:50 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T096&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 09:16:50 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:50 [root] WARNING: 107
2015-09-30 09:16:50 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T096&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:16:50 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P118&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 09:16:50 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:50 [root] WARNING: 108
2015-09-30 09:16:51 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P118&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 624, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 09:16:53 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N169&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 09:16:54 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:54 [root] WARNING: 109
2015-09-30 09:16:54 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N169&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 624, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 09:16:55 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S439&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 09:16:55 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:55 [root] WARNING: 110
2015-09-30 09:16:55 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S439&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:16:55 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S010&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 09:16:55 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:55 [root] WARNING: 111
2015-09-30 09:16:56 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S010&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:16:56 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S117&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 09:16:56 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:56 [root] WARNING: 112
2015-09-30 09:16:56 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S117&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:16:56 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S398&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 09:16:56 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:56 [root] WARNING: 113
2015-09-30 09:16:56 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S398&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:16:57 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T398&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
2015-09-30 09:16:57 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:57 [root] WARNING: 114
2015-09-30 09:16:57 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T398&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 750, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 09:16:57 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S110&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 09:16:57 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:57 [root] WARNING: 115
2015-09-30 09:16:57 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S110&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 778, in parse_horse
    print "prev places {} and dayssincelastrun_h {}".format(pre_places, dayssincelastrun_h)
NameError: global name 'pre_places' is not defined
2015-09-30 09:16:59 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N195&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
2015-09-30 09:16:59 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:16:59 [root] WARNING: 116
2015-09-30 09:16:59 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N195&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20151001/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 624, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps]
ValueError: invalid literal for int() with base 10: '--'
2015-09-30 09:16:59 [scrapy] INFO: Closing spider (finished)
2015-09-30 09:16:59 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/exception_count': 1,
 'downloader/exception_type_count/twisted.internet.error.TimeoutError': 1,
 'downloader/request_bytes': 66391,
 'downloader/request_count': 131,
 'downloader/request_method_count/GET': 130,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 10043308,
 'downloader/response_count': 130,
 'downloader/response_status_count/200': 129,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 9, 16, 59, 710380),
 'log_count/DEBUG': 133,
 'log_count/ERROR': 116,
 'log_count/INFO': 14,
 'log_count/WARNING': 580,
 'request_depth_max': 5,
 'response_received_count': 129,
 'scheduler/dequeued': 131,
 'scheduler/dequeued/memory': 131,
 'scheduler/enqueued': 131,
 'scheduler/enqueued/memory': 131,
 'spider_exceptions/NameError': 81,
 'spider_exceptions/ValueError': 29,
 'spider_exceptions/ZeroDivisionError': 6,
 'start_time': datetime.datetime(2015, 9, 30, 9, 9, 11, 836578)}
2015-09-30 09:16:59 [scrapy] INFO: Spider closed (finished)
2015-09-30 09:52:11 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 09:52:11 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 09:52:11 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 09:52:12 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 09:52:12 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 09:52:12 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 09:52:12 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 09:52:12 [scrapy] INFO: Spider opened
2015-09-30 09:52:12 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 09:52:12 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 09:53:12 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 09:54:12 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 09:55:12 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 09:55:12 [scrapy] DEBUG: Retrying <GET http://racing.scmp.com/login.asp> (failed 1 times): User timeout caused connection failure: Getting http://racing.scmp.com/login.asp took longer than 180.0 seconds..
2015-09-30 09:56:12 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 09:56:27 [scrapy] DEBUG: Retrying <GET http://racing.scmp.com/login.asp> (failed 2 times): Connection was refused by other side: 111: Connection refused.
2015-09-30 09:57:12 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 09:58:07 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 09:58:07 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 09:58:12 [scrapy] INFO: Crawled 1 pages (at 1 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 09:58:15 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 09:58:19 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 09:58:22 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 09:58:22 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 09:58:24 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 09:58:24 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:24 [root] WARNING: horse code set
2015-09-30 09:58:24 [root] WARNING: 1
2015-09-30 09:58:24 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:24 [root] WARNING: horse code set
2015-09-30 09:58:24 [root] WARNING: 2
2015-09-30 09:58:24 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:24 [root] WARNING: horse code set
2015-09-30 09:58:24 [root] WARNING: 3
2015-09-30 09:58:24 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:24 [root] WARNING: horse code set
2015-09-30 09:58:24 [root] WARNING: 4
2015-09-30 09:58:24 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:24 [root] WARNING: horse code set
2015-09-30 09:58:24 [root] WARNING: 5
2015-09-30 09:58:24 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:24 [root] WARNING: horse code set
2015-09-30 09:58:24 [root] WARNING: 6
2015-09-30 09:58:24 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:24 [root] WARNING: horse code set
2015-09-30 09:58:24 [root] WARNING: 7
2015-09-30 09:58:24 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:24 [root] WARNING: horse code set
2015-09-30 09:58:24 [root] WARNING: 8
2015-09-30 09:58:24 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:24 [root] WARNING: horse code set
2015-09-30 09:58:24 [root] WARNING: 9
2015-09-30 09:58:24 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:24 [root] WARNING: horse code set
2015-09-30 09:58:24 [root] WARNING: 10
2015-09-30 09:58:24 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:24 [root] WARNING: horse code set
2015-09-30 09:58:24 [root] WARNING: 11
2015-09-30 09:58:24 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:24 [root] WARNING: horse code set
2015-09-30 09:58:24 [root] WARNING: 12
2015-09-30 09:58:24 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:24 [root] WARNING: horse code set
2015-09-30 09:58:24 [root] WARNING: 13
2015-09-30 09:58:24 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:24 [root] WARNING: horse code set
2015-09-30 09:58:24 [root] WARNING: 14
2015-09-30 09:58:28 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 09:58:28 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:28 [root] WARNING: horse code set
2015-09-30 09:58:28 [root] WARNING: 15
2015-09-30 09:58:28 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:28 [root] WARNING: horse code set
2015-09-30 09:58:28 [root] WARNING: 16
2015-09-30 09:58:28 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:28 [root] WARNING: horse code set
2015-09-30 09:58:28 [root] WARNING: 17
2015-09-30 09:58:28 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:28 [root] WARNING: horse code set
2015-09-30 09:58:28 [root] WARNING: 18
2015-09-30 09:58:28 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:28 [root] WARNING: horse code set
2015-09-30 09:58:28 [root] WARNING: 19
2015-09-30 09:58:28 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:28 [root] WARNING: horse code set
2015-09-30 09:58:28 [root] WARNING: 20
2015-09-30 09:58:28 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:28 [root] WARNING: horse code set
2015-09-30 09:58:28 [root] WARNING: 21
2015-09-30 09:58:28 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:28 [root] WARNING: horse code set
2015-09-30 09:58:28 [root] WARNING: 22
2015-09-30 09:58:28 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:28 [root] WARNING: horse code set
2015-09-30 09:58:28 [root] WARNING: 23
2015-09-30 09:58:28 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:28 [root] WARNING: horse code set
2015-09-30 09:58:28 [root] WARNING: 24
2015-09-30 09:58:28 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:28 [root] WARNING: horse code set
2015-09-30 09:58:28 [root] WARNING: 25
2015-09-30 09:58:28 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:28 [root] WARNING: horse code set
2015-09-30 09:58:28 [root] WARNING: 26
2015-09-30 09:58:28 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:28 [root] WARNING: horse code set
2015-09-30 09:58:28 [root] WARNING: 27
2015-09-30 09:58:28 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:28 [root] WARNING: horse code set
2015-09-30 09:58:28 [root] WARNING: 28
2015-09-30 09:58:30 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 09:58:30 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:30 [root] WARNING: horse code set
2015-09-30 09:58:30 [root] WARNING: 29
2015-09-30 09:58:30 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:30 [root] WARNING: horse code set
2015-09-30 09:58:30 [root] WARNING: 30
2015-09-30 09:58:30 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:30 [root] WARNING: horse code set
2015-09-30 09:58:30 [root] WARNING: 31
2015-09-30 09:58:30 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:30 [root] WARNING: horse code set
2015-09-30 09:58:30 [root] WARNING: 32
2015-09-30 09:58:30 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:30 [root] WARNING: horse code set
2015-09-30 09:58:30 [root] WARNING: 33
2015-09-30 09:58:30 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:30 [root] WARNING: horse code set
2015-09-30 09:58:30 [root] WARNING: 34
2015-09-30 09:58:30 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:30 [root] WARNING: horse code set
2015-09-30 09:58:30 [root] WARNING: 35
2015-09-30 09:58:30 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:30 [root] WARNING: horse code set
2015-09-30 09:58:30 [root] WARNING: 36
2015-09-30 09:58:30 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:30 [root] WARNING: horse code set
2015-09-30 09:58:30 [root] WARNING: 37
2015-09-30 09:58:30 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:30 [root] WARNING: horse code set
2015-09-30 09:58:30 [root] WARNING: 38
2015-09-30 09:58:30 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:30 [root] WARNING: horse code set
2015-09-30 09:58:30 [root] WARNING: 39
2015-09-30 09:58:30 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:30 [root] WARNING: horse code set
2015-09-30 09:58:30 [root] WARNING: 40
2015-09-30 09:58:30 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:30 [root] WARNING: horse code set
2015-09-30 09:58:30 [root] WARNING: 41
2015-09-30 09:58:33 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 09:58:33 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:33 [root] WARNING: horse code set
2015-09-30 09:58:33 [root] WARNING: 42
2015-09-30 09:58:33 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:33 [root] WARNING: horse code set
2015-09-30 09:58:33 [root] WARNING: 43
2015-09-30 09:58:33 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:33 [root] WARNING: horse code set
2015-09-30 09:58:33 [root] WARNING: 44
2015-09-30 09:58:33 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:33 [root] WARNING: horse code set
2015-09-30 09:58:33 [root] WARNING: 45
2015-09-30 09:58:33 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:33 [root] WARNING: horse code set
2015-09-30 09:58:33 [root] WARNING: 46
2015-09-30 09:58:33 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:33 [root] WARNING: horse code set
2015-09-30 09:58:33 [root] WARNING: 47
2015-09-30 09:58:33 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:33 [root] WARNING: horse code set
2015-09-30 09:58:33 [root] WARNING: 48
2015-09-30 09:58:33 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:33 [root] WARNING: horse code set
2015-09-30 09:58:33 [root] WARNING: 49
2015-09-30 09:58:33 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:33 [root] WARNING: horse code set
2015-09-30 09:58:33 [root] WARNING: 50
2015-09-30 09:58:33 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:33 [root] WARNING: horse code set
2015-09-30 09:58:33 [root] WARNING: 51
2015-09-30 09:58:33 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:33 [root] WARNING: horse code set
2015-09-30 09:58:33 [root] WARNING: 52
2015-09-30 09:58:33 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:33 [root] WARNING: horse code set
2015-09-30 09:58:33 [root] WARNING: 53
2015-09-30 09:58:34 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 09:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:34 [root] WARNING: horse code set
2015-09-30 09:58:34 [root] WARNING: 54
2015-09-30 09:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:34 [root] WARNING: horse code set
2015-09-30 09:58:34 [root] WARNING: 55
2015-09-30 09:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:34 [root] WARNING: horse code set
2015-09-30 09:58:34 [root] WARNING: 56
2015-09-30 09:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:34 [root] WARNING: horse code set
2015-09-30 09:58:34 [root] WARNING: 57
2015-09-30 09:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:34 [root] WARNING: horse code set
2015-09-30 09:58:34 [root] WARNING: 58
2015-09-30 09:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:34 [root] WARNING: horse code set
2015-09-30 09:58:34 [root] WARNING: 59
2015-09-30 09:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:34 [root] WARNING: horse code set
2015-09-30 09:58:34 [root] WARNING: 60
2015-09-30 09:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:34 [root] WARNING: horse code set
2015-09-30 09:58:34 [root] WARNING: 61
2015-09-30 09:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:34 [root] WARNING: horse code set
2015-09-30 09:58:34 [root] WARNING: 62
2015-09-30 09:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:34 [root] WARNING: horse code set
2015-09-30 09:58:34 [root] WARNING: 63
2015-09-30 09:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:34 [root] WARNING: horse code set
2015-09-30 09:58:34 [root] WARNING: 64
2015-09-30 09:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:34 [root] WARNING: horse code set
2015-09-30 09:58:34 [root] WARNING: 65
2015-09-30 09:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:34 [root] WARNING: horse code set
2015-09-30 09:58:34 [root] WARNING: 66
2015-09-30 09:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:34 [root] WARNING: horse code set
2015-09-30 09:58:34 [root] WARNING: 67
2015-09-30 09:58:35 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 09:58:35 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 09:58:35 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:35 [root] WARNING: horse code set
2015-09-30 09:58:35 [root] WARNING: 68
2015-09-30 09:58:35 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:35 [root] WARNING: horse code set
2015-09-30 09:58:35 [root] WARNING: 69
2015-09-30 09:58:35 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:35 [root] WARNING: horse code set
2015-09-30 09:58:35 [root] WARNING: 70
2015-09-30 09:58:35 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:35 [root] WARNING: horse code set
2015-09-30 09:58:35 [root] WARNING: 71
2015-09-30 09:58:35 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:35 [root] WARNING: horse code set
2015-09-30 09:58:35 [root] WARNING: 72
2015-09-30 09:58:35 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:35 [root] WARNING: horse code set
2015-09-30 09:58:35 [root] WARNING: 73
2015-09-30 09:58:35 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:35 [root] WARNING: horse code set
2015-09-30 09:58:35 [root] WARNING: 74
2015-09-30 09:58:35 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:35 [root] WARNING: horse code set
2015-09-30 09:58:35 [root] WARNING: 75
2015-09-30 09:58:35 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:35 [root] WARNING: horse code set
2015-09-30 09:58:35 [root] WARNING: 76
2015-09-30 09:58:35 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:35 [root] WARNING: horse code set
2015-09-30 09:58:35 [root] WARNING: 77
2015-09-30 09:58:35 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:35 [root] WARNING: horse code set
2015-09-30 09:58:35 [root] WARNING: 78
2015-09-30 09:58:35 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:35 [root] WARNING: horse code set
2015-09-30 09:58:35 [root] WARNING: 79
2015-09-30 09:58:35 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:35 [root] WARNING: horse code set
2015-09-30 09:58:35 [root] WARNING: 80
2015-09-30 09:58:35 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:35 [root] WARNING: horse code set
2015-09-30 09:58:35 [root] WARNING: 81
2015-09-30 09:58:35 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:35 [root] WARNING: horse code set
2015-09-30 09:58:35 [root] WARNING: 82
2015-09-30 09:58:35 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:35 [root] WARNING: horse code set
2015-09-30 09:58:35 [root] WARNING: 83
2015-09-30 09:58:35 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:35 [root] WARNING: horse code set
2015-09-30 09:58:35 [root] WARNING: 84
2015-09-30 09:58:35 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:35 [root] WARNING: horse code set
2015-09-30 09:58:35 [root] WARNING: 85
2015-09-30 09:58:35 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:35 [root] WARNING: horse code set
2015-09-30 09:58:35 [root] WARNING: 86
2015-09-30 09:58:35 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:35 [root] WARNING: horse code set
2015-09-30 09:58:35 [root] WARNING: 87
2015-09-30 09:58:35 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:35 [root] WARNING: horse code set
2015-09-30 09:58:35 [root] WARNING: 88
2015-09-30 09:58:35 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:35 [root] WARNING: horse code set
2015-09-30 09:58:35 [root] WARNING: 89
2015-09-30 09:58:35 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:35 [root] WARNING: horse code set
2015-09-30 09:58:35 [root] WARNING: 90
2015-09-30 09:58:35 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:35 [root] WARNING: horse code set
2015-09-30 09:58:35 [root] WARNING: 91
2015-09-30 09:58:35 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:35 [root] WARNING: horse code set
2015-09-30 09:58:35 [root] WARNING: 92
2015-09-30 09:58:35 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:35 [root] WARNING: horse code set
2015-09-30 09:58:35 [root] WARNING: 93
2015-09-30 09:58:35 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:35 [root] WARNING: horse code set
2015-09-30 09:58:35 [root] WARNING: 94
2015-09-30 09:58:36 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 09:58:36 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:36 [root] WARNING: horse code set
2015-09-30 09:58:36 [root] WARNING: 95
2015-09-30 09:58:36 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:36 [root] WARNING: horse code set
2015-09-30 09:58:36 [root] WARNING: 96
2015-09-30 09:58:36 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:36 [root] WARNING: horse code set
2015-09-30 09:58:36 [root] WARNING: 97
2015-09-30 09:58:36 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:36 [root] WARNING: horse code set
2015-09-30 09:58:36 [root] WARNING: 98
2015-09-30 09:58:36 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:36 [root] WARNING: horse code set
2015-09-30 09:58:36 [root] WARNING: 99
2015-09-30 09:58:36 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:36 [root] WARNING: horse code set
2015-09-30 09:58:36 [root] WARNING: 100
2015-09-30 09:58:36 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:36 [root] WARNING: horse code set
2015-09-30 09:58:36 [root] WARNING: 101
2015-09-30 09:58:36 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:36 [root] WARNING: horse code set
2015-09-30 09:58:36 [root] WARNING: 102
2015-09-30 09:58:36 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:36 [root] WARNING: horse code set
2015-09-30 09:58:36 [root] WARNING: 103
2015-09-30 09:58:36 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:36 [root] WARNING: horse code set
2015-09-30 09:58:36 [root] WARNING: 104
2015-09-30 09:58:36 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:36 [root] WARNING: horse code set
2015-09-30 09:58:36 [root] WARNING: 105
2015-09-30 09:58:36 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:36 [root] WARNING: horse code set
2015-09-30 09:58:36 [root] WARNING: 106
2015-09-30 09:58:37 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 09:58:37 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:37 [root] WARNING: horse code set
2015-09-30 09:58:37 [root] WARNING: 107
2015-09-30 09:58:37 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:37 [root] WARNING: horse code set
2015-09-30 09:58:37 [root] WARNING: 108
2015-09-30 09:58:37 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:37 [root] WARNING: horse code set
2015-09-30 09:58:37 [root] WARNING: 109
2015-09-30 09:58:37 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:37 [root] WARNING: horse code set
2015-09-30 09:58:37 [root] WARNING: 110
2015-09-30 09:58:37 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:37 [root] WARNING: horse code set
2015-09-30 09:58:37 [root] WARNING: 111
2015-09-30 09:58:37 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:37 [root] WARNING: horse code set
2015-09-30 09:58:37 [root] WARNING: 112
2015-09-30 09:58:37 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:37 [root] WARNING: horse code set
2015-09-30 09:58:37 [root] WARNING: 113
2015-09-30 09:58:37 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:37 [root] WARNING: horse code set
2015-09-30 09:58:37 [root] WARNING: 114
2015-09-30 09:58:37 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:37 [root] WARNING: horse code set
2015-09-30 09:58:37 [root] WARNING: 115
2015-09-30 09:58:37 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:37 [root] WARNING: horse code set
2015-09-30 09:58:37 [root] WARNING: 116
2015-09-30 09:58:37 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:37 [root] WARNING: horse code set
2015-09-30 09:58:37 [root] WARNING: 117
2015-09-30 09:58:37 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:37 [root] WARNING: horse code set
2015-09-30 09:58:37 [root] WARNING: 118
2015-09-30 09:58:37 [root] WARNING: -------------------------------------------------
2015-09-30 09:58:37 [root] WARNING: horse code set
2015-09-30 09:58:37 [root] WARNING: 119
2015-09-30 09:58:41 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 09:58:41 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:58:41 [root] WARNING: 1
2015-09-30 09:58:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:58:42 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S194&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 09:58:42 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:58:42 [root] WARNING: 2
2015-09-30 09:58:42 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S194&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:58:44 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S266&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 09:58:44 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:58:44 [root] WARNING: 3
2015-09-30 09:58:44 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S266&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:58:45 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T117&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 09:58:45 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:58:45 [root] WARNING: 4
2015-09-30 09:58:45 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T117&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:58:45 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P446&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 09:58:45 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:58:45 [root] WARNING: 5
2015-09-30 09:58:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P446&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:58:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S298&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 09:58:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:58:46 [root] WARNING: 6
2015-09-30 09:58:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S298&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:58:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T303&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 09:58:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:58:47 [root] WARNING: 7
2015-09-30 09:58:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T303&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:58:48 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P412&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 09:58:48 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:58:48 [root] WARNING: 8
2015-09-30 09:58:48 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P412&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:58:48 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S142&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 09:58:48 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:58:48 [root] WARNING: 9
2015-09-30 09:58:48 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S142&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:58:49 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T217&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 09:58:50 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:58:50 [root] WARNING: 10
2015-09-30 09:58:50 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T217&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:58:51 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N300&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 09:58:51 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:58:51 [root] WARNING: 11
2015-09-30 09:58:51 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N300&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:58:52 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S189&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 09:58:52 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:58:52 [root] WARNING: 12
2015-09-30 09:58:52 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S189&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:58:54 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N217&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 09:58:54 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S070&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 09:58:54 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:58:54 [root] WARNING: 13
2015-09-30 09:58:54 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N217&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:58:54 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:58:54 [root] WARNING: 14
2015-09-30 09:58:54 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S070&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:59:01 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P308&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 09:59:01 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:59:01 [root] WARNING: 15
2015-09-30 09:59:01 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P308&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:59:02 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N090&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 09:59:02 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:59:02 [root] WARNING: 16
2015-09-30 09:59:02 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N090&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:59:02 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T027&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 09:59:02 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:59:02 [root] WARNING: 17
2015-09-30 09:59:02 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T027&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:59:03 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P440&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 09:59:03 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:59:03 [root] WARNING: 18
2015-09-30 09:59:03 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P440&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:59:04 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S431&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 09:59:04 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:59:04 [root] WARNING: 19
2015-09-30 09:59:04 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S431&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:59:05 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T345&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 09:59:05 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:59:05 [root] WARNING: 20
2015-09-30 09:59:05 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T345&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:59:06 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T262&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 09:59:06 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:59:06 [root] WARNING: 21
2015-09-30 09:59:06 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T262&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:59:08 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P299&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 09:59:08 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:59:08 [root] WARNING: 22
2015-09-30 09:59:08 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P299&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:59:08 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T385&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 09:59:08 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:59:08 [root] WARNING: 23
2015-09-30 09:59:09 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T385&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:59:09 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N218&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 09:59:09 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:59:09 [root] WARNING: 24
2015-09-30 09:59:10 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N218&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:59:11 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P383&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 09:59:11 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:59:11 [root] WARNING: 25
2015-09-30 09:59:11 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P383&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:59:12 [scrapy] INFO: Crawled 38 pages (at 37 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 09:59:14 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P343&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 09:59:15 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:59:15 [root] WARNING: 26
2015-09-30 09:59:15 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P343&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:59:15 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T357&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 09:59:15 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:59:15 [root] WARNING: 27
2015-09-30 09:59:15 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T357&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:59:20 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P239&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 09:59:20 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:59:20 [root] WARNING: 28
2015-09-30 09:59:20 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P239&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:59:21 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T155&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 09:59:21 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:59:21 [root] WARNING: 29
2015-09-30 09:59:21 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T155&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:59:23 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T045&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 09:59:23 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:59:23 [root] WARNING: 30
2015-09-30 09:59:23 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T045&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:59:25 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T334&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 09:59:25 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:59:25 [root] WARNING: 31
2015-09-30 09:59:25 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T334&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:59:26 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T081&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 09:59:26 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:59:26 [root] WARNING: 32
2015-09-30 09:59:26 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T081&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:59:27 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T029&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 09:59:27 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:59:27 [root] WARNING: 33
2015-09-30 09:59:27 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T029&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 09:59:27 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T023&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 09:59:27 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:59:27 [root] WARNING: 34
2015-09-30 09:59:27 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T023&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:59:28 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S356&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 09:59:28 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:59:28 [root] WARNING: 35
2015-09-30 09:59:28 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S356&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 09:59:29 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T283&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 09:59:30 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:59:30 [root] WARNING: 36
2015-09-30 09:59:30 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T283&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:59:33 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T073&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 09:59:33 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:59:33 [root] WARNING: 37
2015-09-30 09:59:33 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T073&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:59:33 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S395&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 09:59:33 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:59:33 [root] WARNING: 38
2015-09-30 09:59:33 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S395&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:59:35 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P444&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 09:59:35 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:59:35 [root] WARNING: 39
2015-09-30 09:59:35 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P444&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:59:37 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P364&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 09:59:37 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:59:37 [root] WARNING: 40
2015-09-30 09:59:37 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P364&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:59:38 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N360&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 09:59:38 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:59:38 [root] WARNING: 41
2015-09-30 09:59:38 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N360&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:59:39 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T105&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 09:59:39 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:59:39 [root] WARNING: 42
2015-09-30 09:59:39 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T105&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:59:39 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T230&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 09:59:39 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:59:39 [root] WARNING: 43
2015-09-30 09:59:39 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T230&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:59:39 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N265&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 09:59:40 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:59:40 [root] WARNING: 44
2015-09-30 09:59:40 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N265&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:59:41 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M401&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 09:59:42 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:59:42 [root] WARNING: 45
2015-09-30 09:59:42 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M401&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:59:42 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M327&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 09:59:42 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:59:42 [root] WARNING: 46
2015-09-30 09:59:42 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M327&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:59:43 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S113&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 09:59:44 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:59:44 [root] WARNING: 47
2015-09-30 09:59:44 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S113&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:59:45 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P046&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 09:59:45 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:59:45 [root] WARNING: 48
2015-09-30 09:59:45 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P046&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:59:51 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 09:59:51 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:59:51 [root] WARNING: 49
2015-09-30 09:59:52 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 09:59:56 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N416&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 09:59:56 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 09:59:56 [root] WARNING: 50
2015-09-30 09:59:57 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N416&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:00:01 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P269&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 10:00:01 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:00:01 [root] WARNING: 51
2015-09-30 10:00:01 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P269&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:00:02 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P167&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 10:00:02 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:00:02 [root] WARNING: 52
2015-09-30 10:00:02 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P167&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:00:12 [scrapy] INFO: Crawled 65 pages (at 27 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 10:00:12 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P436&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 10:00:12 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P017&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 10:00:12 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:00:12 [root] WARNING: 53
2015-09-30 10:00:12 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P436&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:00:12 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:00:12 [root] WARNING: 54
2015-09-30 10:00:12 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P017&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:00:13 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S417&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 10:00:13 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:00:13 [root] WARNING: 55
2015-09-30 10:00:13 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S417&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:00:14 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 10:00:14 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:00:14 [root] WARNING: 56
2015-09-30 10:00:15 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:00:21 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S290&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 10:00:21 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:00:21 [root] WARNING: 57
2015-09-30 10:00:21 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S290&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:00:22 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P227&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 10:00:23 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:00:23 [root] WARNING: 58
2015-09-30 10:00:23 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P227&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:00:25 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P353&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 10:00:25 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:00:25 [root] WARNING: 59
2015-09-30 10:00:25 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P353&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:00:27 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S423&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 10:00:27 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:00:27 [root] WARNING: 60
2015-09-30 10:00:27 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S423&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:00:29 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S006&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 10:00:30 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:00:30 [root] WARNING: 61
2015-09-30 10:00:30 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S006&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:00:32 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N331&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 10:00:32 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:00:32 [root] WARNING: 62
2015-09-30 10:00:32 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N331&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:00:33 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N146&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 10:00:33 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:00:33 [root] WARNING: 63
2015-09-30 10:00:33 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N146&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:00:34 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T028&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 10:00:34 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:00:34 [root] WARNING: 64
2015-09-30 10:00:34 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T028&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:00:35 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P354&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 10:00:35 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:00:35 [root] WARNING: 65
2015-09-30 10:00:35 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P354&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:00:35 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P072&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 10:00:36 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:00:36 [root] WARNING: 66
2015-09-30 10:00:36 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P072&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:00:36 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N115&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 10:00:36 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:00:36 [root] WARNING: 67
2015-09-30 10:00:36 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N115&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:00:38 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M152&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 10:00:38 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:00:38 [root] WARNING: 68
2015-09-30 10:00:39 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M152&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:00:39 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S370&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 10:00:39 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:00:39 [root] WARNING: 69
2015-09-30 10:00:39 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S370&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:00:41 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S378&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 10:00:42 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:00:42 [root] WARNING: 70
2015-09-30 10:00:42 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S378&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:00:44 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=L401&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 10:00:44 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:00:44 [root] WARNING: 71
2015-09-30 10:00:44 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=L401&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:00:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S116&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 10:00:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:00:47 [root] WARNING: 72
2015-09-30 10:00:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S116&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:00:51 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T065&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 10:00:51 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:00:51 [root] WARNING: 73
2015-09-30 10:00:51 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T065&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:00:54 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S387&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 10:00:54 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:00:54 [root] WARNING: 74
2015-09-30 10:00:54 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S387&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:00:56 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T212&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 10:00:56 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:00:56 [root] WARNING: 75
2015-09-30 10:00:56 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T212&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:00:58 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S234&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 10:00:58 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:00:58 [root] WARNING: 76
2015-09-30 10:00:58 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S234&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:00:58 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T184&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 10:00:58 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:00:58 [root] WARNING: 77
2015-09-30 10:00:58 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T184&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:01:00 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T285&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 10:01:00 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:00 [root] WARNING: 78
2015-09-30 10:01:00 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T285&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:01:01 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T213&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 10:01:01 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:01 [root] WARNING: 79
2015-09-30 10:01:01 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T213&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:01:04 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P062&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 10:01:04 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:04 [root] WARNING: 80
2015-09-30 10:01:05 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P062&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:01:05 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T293&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 10:01:05 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P214&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 10:01:05 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:05 [root] WARNING: 81
2015-09-30 10:01:05 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T293&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 10:01:05 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:05 [root] WARNING: 82
2015-09-30 10:01:05 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P214&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:01:08 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P225&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 10:01:08 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:08 [root] WARNING: 83
2015-09-30 10:01:08 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P225&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:01:08 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T365&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 10:01:08 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:08 [root] WARNING: 84
2015-09-30 10:01:08 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T365&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:01:11 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T300&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 10:01:11 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:11 [root] WARNING: 85
2015-09-30 10:01:11 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T300&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:01:11 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M325&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 10:01:11 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:11 [root] WARNING: 86
2015-09-30 10:01:11 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M325&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:01:12 [scrapy] INFO: Crawled 99 pages (at 34 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 10:01:13 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P267&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 10:01:13 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:13 [root] WARNING: 87
2015-09-30 10:01:13 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P267&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:01:15 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S191&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 10:01:15 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:15 [root] WARNING: 88
2015-09-30 10:01:15 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S191&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:01:20 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T059&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 10:01:20 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:20 [root] WARNING: 89
2015-09-30 10:01:20 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T059&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:01:25 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T271&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 10:01:25 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:25 [root] WARNING: 90
2015-09-30 10:01:25 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T271&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:01:25 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T190&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 10:01:26 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:26 [root] WARNING: 91
2015-09-30 10:01:26 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T190&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:01:26 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P351&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 10:01:26 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:26 [root] WARNING: 92
2015-09-30 10:01:26 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P351&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:01:27 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T350&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 10:01:27 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T382&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 10:01:27 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:27 [root] WARNING: 93
2015-09-30 10:01:27 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T350&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 10:01:27 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:27 [root] WARNING: 94
2015-09-30 10:01:27 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T382&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:01:28 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T373&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 10:01:28 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:28 [root] WARNING: 95
2015-09-30 10:01:28 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T373&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 10:01:28 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T158&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 10:01:28 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:28 [root] WARNING: 96
2015-09-30 10:01:28 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T158&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:01:28 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M172&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 10:01:29 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:29 [root] WARNING: 97
2015-09-30 10:01:29 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M172&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:01:29 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S014&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 10:01:29 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:29 [root] WARNING: 98
2015-09-30 10:01:29 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S014&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:01:33 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S011&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 10:01:33 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:33 [root] WARNING: 99
2015-09-30 10:01:33 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S011&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:01:33 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T284&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 10:01:33 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:33 [root] WARNING: 100
2015-09-30 10:01:33 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T284&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 10:01:37 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T245&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 10:01:37 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:37 [root] WARNING: 101
2015-09-30 10:01:37 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T245&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:01:42 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T366&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 10:01:42 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:42 [root] WARNING: 102
2015-09-30 10:01:42 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T366&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:01:43 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N375&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 10:01:43 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:43 [root] WARNING: 103
2015-09-30 10:01:44 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N375&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:01:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S449&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 10:01:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:46 [root] WARNING: 104
2015-09-30 10:01:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S449&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:01:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T199&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 10:01:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:46 [root] WARNING: 105
2015-09-30 10:01:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T199&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:01:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P053&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 10:01:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N438&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 10:01:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:47 [root] WARNING: 106
2015-09-30 10:01:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P053&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:01:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:47 [root] WARNING: 107
2015-09-30 10:01:48 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N438&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:01:51 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P281&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 10:01:51 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:51 [root] WARNING: 108
2015-09-30 10:01:51 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P281&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:01:54 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N121&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 10:01:54 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:54 [root] WARNING: 109
2015-09-30 10:01:54 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N121&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:01:55 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T236&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 10:01:55 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:55 [root] WARNING: 110
2015-09-30 10:01:55 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T236&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:01:58 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T363&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 10:01:59 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:59 [root] WARNING: 111
2015-09-30 10:01:59 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T363&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:01:59 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T375&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 10:01:59 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:59 [root] WARNING: 112
2015-09-30 10:01:59 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T375&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 10:01:59 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P428&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 10:01:59 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:59 [root] WARNING: 113
2015-09-30 10:01:59 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P428&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:01:59 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T391&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 10:01:59 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:01:59 [root] WARNING: 114
2015-09-30 10:01:59 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T391&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 752, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 10:02:01 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N209&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 10:02:01 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:02:01 [root] WARNING: 115
2015-09-30 10:02:01 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N209&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:02:02 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S263&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 10:02:02 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:02:02 [root] WARNING: 116
2015-09-30 10:02:02 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S263&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:02:02 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 10:02:02 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:02:02 [root] WARNING: 117
2015-09-30 10:02:03 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:02:03 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S362&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 10:02:03 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:02:03 [root] WARNING: 118
2015-09-30 10:02:03 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S362&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 674, in parse_horse
    _tmp,ismadeall(_tmp), islostlead(_tmp), pasthorsessecl1(_tmp), isonpace(_tmp) )
NameError: global name 'ismadeall' is not defined
2015-09-30 10:02:08 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N268&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 10:02:08 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:02:08 [root] WARNING: 119
2015-09-30 10:02:09 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N268&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 624, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps if x not in [u' ', u'', u'--', None]]
ValueError: invalid literal for int() with base 10: '1.25.60'
2015-09-30 10:02:09 [scrapy] INFO: Closing spider (finished)
2015-09-30 10:02:09 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/exception_count': 2,
 'downloader/exception_type_count/twisted.internet.error.ConnectionRefusedError': 1,
 'downloader/exception_type_count/twisted.internet.error.TimeoutError': 1,
 'downloader/request_bytes': 72078,
 'downloader/request_count': 135,
 'downloader/request_method_count/GET': 134,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 10747426,
 'downloader/response_count': 133,
 'downloader/response_status_count/200': 132,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 10, 2, 9, 151426),
 'log_count/DEBUG': 137,
 'log_count/ERROR': 119,
 'log_count/INFO': 16,
 'log_count/WARNING': 595,
 'request_depth_max': 5,
 'response_received_count': 132,
 'scheduler/dequeued': 135,
 'scheduler/dequeued/memory': 135,
 'scheduler/enqueued': 135,
 'scheduler/enqueued/memory': 135,
 'spider_exceptions/NameError': 110,
 'spider_exceptions/ValueError': 1,
 'spider_exceptions/ZeroDivisionError': 8,
 'start_time': datetime.datetime(2015, 9, 30, 9, 52, 12, 134976)}
2015-09-30 10:02:09 [scrapy] INFO: Spider closed (finished)
2015-09-30 10:12:39 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 10:12:39 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 10:12:39 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 10:12:39 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 10:12:39 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 10:12:39 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 10:12:39 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 10:12:39 [scrapy] INFO: Spider opened
2015-09-30 10:12:39 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 10:12:39 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 10:12:41 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 10:12:43 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 10:12:49 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 10:12:54 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 10:12:57 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 10:12:57 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 10:13:00 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 10:13:00 [root] WARNING: -------------------------------------------------
2015-09-30 10:13:00 [root] WARNING: horse code set
2015-09-30 10:13:00 [root] WARNING: 1
2015-09-30 10:13:00 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 518, in parse_hkjc_racecard
    print("todays draw {}").format(draw_)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 10:13:02 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 10:13:03 [root] WARNING: -------------------------------------------------
2015-09-30 10:13:03 [root] WARNING: horse code set
2015-09-30 10:13:03 [root] WARNING: 2
2015-09-30 10:13:03 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 518, in parse_hkjc_racecard
    print("todays draw {}").format(draw_)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 10:13:04 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 10:13:04 [root] WARNING: -------------------------------------------------
2015-09-30 10:13:04 [root] WARNING: horse code set
2015-09-30 10:13:04 [root] WARNING: 3
2015-09-30 10:13:04 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 518, in parse_hkjc_racecard
    print("todays draw {}").format(draw_)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 10:13:06 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 10:13:06 [root] WARNING: -------------------------------------------------
2015-09-30 10:13:06 [root] WARNING: horse code set
2015-09-30 10:13:06 [root] WARNING: 4
2015-09-30 10:13:06 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 518, in parse_hkjc_racecard
    print("todays draw {}").format(draw_)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 10:13:08 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 10:13:08 [root] WARNING: -------------------------------------------------
2015-09-30 10:13:08 [root] WARNING: horse code set
2015-09-30 10:13:08 [root] WARNING: 5
2015-09-30 10:13:08 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 518, in parse_hkjc_racecard
    print("todays draw {}").format(draw_)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 10:13:09 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 10:13:09 [root] WARNING: -------------------------------------------------
2015-09-30 10:13:09 [root] WARNING: horse code set
2015-09-30 10:13:09 [root] WARNING: 6
2015-09-30 10:13:09 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 518, in parse_hkjc_racecard
    print("todays draw {}").format(draw_)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 10:13:09 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 10:13:09 [root] WARNING: -------------------------------------------------
2015-09-30 10:13:09 [root] WARNING: horse code set
2015-09-30 10:13:09 [root] WARNING: 7
2015-09-30 10:13:09 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 518, in parse_hkjc_racecard
    print("todays draw {}").format(draw_)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 10:13:10 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 10:13:10 [root] WARNING: -------------------------------------------------
2015-09-30 10:13:10 [root] WARNING: horse code set
2015-09-30 10:13:10 [root] WARNING: 8
2015-09-30 10:13:10 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 518, in parse_hkjc_racecard
    print("todays draw {}").format(draw_)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 10:13:11 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 10:13:11 [root] WARNING: -------------------------------------------------
2015-09-30 10:13:11 [root] WARNING: horse code set
2015-09-30 10:13:11 [root] WARNING: 9
2015-09-30 10:13:11 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 518, in parse_hkjc_racecard
    print("todays draw {}").format(draw_)
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 10:13:11 [scrapy] INFO: Closing spider (finished)
2015-09-30 10:13:11 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 5227,
 'downloader/request_count': 14,
 'downloader/request_method_count/GET': 13,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 395235,
 'downloader/response_count': 14,
 'downloader/response_status_count/200': 13,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 10, 13, 11, 346304),
 'log_count/DEBUG': 16,
 'log_count/ERROR': 9,
 'log_count/INFO': 7,
 'log_count/WARNING': 27,
 'request_depth_max': 4,
 'response_received_count': 13,
 'scheduler/dequeued': 14,
 'scheduler/dequeued/memory': 14,
 'scheduler/enqueued': 14,
 'scheduler/enqueued/memory': 14,
 'spider_exceptions/UnicodeEncodeError': 9,
 'start_time': datetime.datetime(2015, 9, 30, 10, 12, 39, 301257)}
2015-09-30 10:13:11 [scrapy] INFO: Spider closed (finished)
2015-09-30 10:29:25 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 10:29:25 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 10:29:25 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 10:29:25 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 10:29:25 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 10:29:25 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 10:29:25 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 10:29:25 [scrapy] INFO: Spider opened
2015-09-30 10:29:25 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 10:29:25 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 10:29:27 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 10:29:32 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 10:29:38 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 10:29:41 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 10:29:43 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 10:29:43 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 10:29:49 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 10:29:49 [root] WARNING: -------------------------------------------------
2015-09-30 10:29:49 [root] WARNING: horse code set
2015-09-30 10:29:49 [root] WARNING: 1
2015-09-30 10:29:49 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 518, in parse_hkjc_racecard
    print("todays draw {}- {}").format(draw_, try_int(draw_))
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 10:29:54 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 10:29:54 [root] WARNING: -------------------------------------------------
2015-09-30 10:29:54 [root] WARNING: horse code set
2015-09-30 10:29:54 [root] WARNING: 2
2015-09-30 10:29:54 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 518, in parse_hkjc_racecard
    print("todays draw {}- {}").format(draw_, try_int(draw_))
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 10:29:57 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 10:29:57 [root] WARNING: -------------------------------------------------
2015-09-30 10:29:57 [root] WARNING: horse code set
2015-09-30 10:29:57 [root] WARNING: 3
2015-09-30 10:29:57 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 518, in parse_hkjc_racecard
    print("todays draw {}- {}").format(draw_, try_int(draw_))
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 10:29:58 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 10:29:58 [root] WARNING: -------------------------------------------------
2015-09-30 10:29:58 [root] WARNING: horse code set
2015-09-30 10:29:58 [root] WARNING: 4
2015-09-30 10:29:58 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 518, in parse_hkjc_racecard
    print("todays draw {}- {}").format(draw_, try_int(draw_))
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 10:29:59 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 10:29:59 [root] WARNING: -------------------------------------------------
2015-09-30 10:29:59 [root] WARNING: horse code set
2015-09-30 10:29:59 [root] WARNING: 5
2015-09-30 10:29:59 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 518, in parse_hkjc_racecard
    print("todays draw {}- {}").format(draw_, try_int(draw_))
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 10:30:00 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 10:30:00 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 10:30:01 [root] WARNING: -------------------------------------------------
2015-09-30 10:30:01 [root] WARNING: horse code set
2015-09-30 10:30:01 [root] WARNING: 6
2015-09-30 10:30:01 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 518, in parse_hkjc_racecard
    print("todays draw {}- {}").format(draw_, try_int(draw_))
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 10:30:01 [root] WARNING: -------------------------------------------------
2015-09-30 10:30:01 [root] WARNING: horse code set
2015-09-30 10:30:01 [root] WARNING: 7
2015-09-30 10:30:01 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 518, in parse_hkjc_racecard
    print("todays draw {}- {}").format(draw_, try_int(draw_))
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 10:30:02 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 10:30:02 [root] WARNING: -------------------------------------------------
2015-09-30 10:30:02 [root] WARNING: horse code set
2015-09-30 10:30:02 [root] WARNING: 8
2015-09-30 10:30:02 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 518, in parse_hkjc_racecard
    print("todays draw {}- {}").format(draw_, try_int(draw_))
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 10:30:03 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 10:30:03 [root] WARNING: -------------------------------------------------
2015-09-30 10:30:03 [root] WARNING: horse code set
2015-09-30 10:30:03 [root] WARNING: 9
2015-09-30 10:30:03 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 518, in parse_hkjc_racecard
    print("todays draw {}- {}").format(draw_, try_int(draw_))
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 10:30:03 [scrapy] INFO: Closing spider (finished)
2015-09-30 10:30:03 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 5227,
 'downloader/request_count': 14,
 'downloader/request_method_count/GET': 13,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 395324,
 'downloader/response_count': 14,
 'downloader/response_status_count/200': 13,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 10, 30, 3, 136044),
 'log_count/DEBUG': 16,
 'log_count/ERROR': 9,
 'log_count/INFO': 7,
 'log_count/WARNING': 27,
 'request_depth_max': 4,
 'response_received_count': 13,
 'scheduler/dequeued': 14,
 'scheduler/dequeued/memory': 14,
 'scheduler/enqueued': 14,
 'scheduler/enqueued/memory': 14,
 'spider_exceptions/UnicodeEncodeError': 9,
 'start_time': datetime.datetime(2015, 9, 30, 10, 29, 25, 862001)}
2015-09-30 10:30:03 [scrapy] INFO: Spider closed (finished)
2015-09-30 10:57:57 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 10:57:57 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 10:57:57 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 10:57:57 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 10:57:58 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 10:57:58 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 10:57:58 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 10:57:58 [scrapy] INFO: Spider opened
2015-09-30 10:57:58 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 10:57:58 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 10:57:59 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 10:58:02 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 10:58:07 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 10:58:12 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 10:58:14 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 10:58:14 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 10:58:20 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 10:58:20 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:20 [root] WARNING: horse code set
2015-09-30 10:58:20 [root] WARNING: 1
2015-09-30 10:58:20 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:20 [root] WARNING: horse code set
2015-09-30 10:58:20 [root] WARNING: 2
2015-09-30 10:58:20 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:20 [root] WARNING: horse code set
2015-09-30 10:58:20 [root] WARNING: 3
2015-09-30 10:58:20 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:20 [root] WARNING: horse code set
2015-09-30 10:58:20 [root] WARNING: 4
2015-09-30 10:58:20 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:20 [root] WARNING: horse code set
2015-09-30 10:58:20 [root] WARNING: 5
2015-09-30 10:58:20 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:20 [root] WARNING: horse code set
2015-09-30 10:58:20 [root] WARNING: 6
2015-09-30 10:58:20 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:20 [root] WARNING: horse code set
2015-09-30 10:58:20 [root] WARNING: 7
2015-09-30 10:58:20 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:20 [root] WARNING: horse code set
2015-09-30 10:58:20 [root] WARNING: 8
2015-09-30 10:58:20 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:20 [root] WARNING: horse code set
2015-09-30 10:58:20 [root] WARNING: 9
2015-09-30 10:58:20 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:20 [root] WARNING: horse code set
2015-09-30 10:58:20 [root] WARNING: 10
2015-09-30 10:58:20 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:20 [root] WARNING: horse code set
2015-09-30 10:58:20 [root] WARNING: 11
2015-09-30 10:58:20 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:20 [root] WARNING: horse code set
2015-09-30 10:58:20 [root] WARNING: 12
2015-09-30 10:58:20 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:20 [root] WARNING: horse code set
2015-09-30 10:58:20 [root] WARNING: 13
2015-09-30 10:58:20 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:20 [root] WARNING: horse code set
2015-09-30 10:58:20 [root] WARNING: 14
2015-09-30 10:58:25 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 10:58:26 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:26 [root] WARNING: horse code set
2015-09-30 10:58:26 [root] WARNING: 15
2015-09-30 10:58:26 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:26 [root] WARNING: horse code set
2015-09-30 10:58:26 [root] WARNING: 16
2015-09-30 10:58:26 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:26 [root] WARNING: horse code set
2015-09-30 10:58:26 [root] WARNING: 17
2015-09-30 10:58:26 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:26 [root] WARNING: horse code set
2015-09-30 10:58:26 [root] WARNING: 18
2015-09-30 10:58:26 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:26 [root] WARNING: horse code set
2015-09-30 10:58:26 [root] WARNING: 19
2015-09-30 10:58:26 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:26 [root] WARNING: horse code set
2015-09-30 10:58:26 [root] WARNING: 20
2015-09-30 10:58:26 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:26 [root] WARNING: horse code set
2015-09-30 10:58:26 [root] WARNING: 21
2015-09-30 10:58:26 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:26 [root] WARNING: horse code set
2015-09-30 10:58:26 [root] WARNING: 22
2015-09-30 10:58:26 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:26 [root] WARNING: horse code set
2015-09-30 10:58:26 [root] WARNING: 23
2015-09-30 10:58:26 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:26 [root] WARNING: horse code set
2015-09-30 10:58:26 [root] WARNING: 24
2015-09-30 10:58:26 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:26 [root] WARNING: horse code set
2015-09-30 10:58:26 [root] WARNING: 25
2015-09-30 10:58:26 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:26 [root] WARNING: horse code set
2015-09-30 10:58:26 [root] WARNING: 26
2015-09-30 10:58:26 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:26 [root] WARNING: horse code set
2015-09-30 10:58:26 [root] WARNING: 27
2015-09-30 10:58:26 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:26 [root] WARNING: horse code set
2015-09-30 10:58:26 [root] WARNING: 28
2015-09-30 10:58:27 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 10:58:27 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:27 [root] WARNING: horse code set
2015-09-30 10:58:27 [root] WARNING: 29
2015-09-30 10:58:27 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:27 [root] WARNING: horse code set
2015-09-30 10:58:27 [root] WARNING: 30
2015-09-30 10:58:27 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:27 [root] WARNING: horse code set
2015-09-30 10:58:27 [root] WARNING: 31
2015-09-30 10:58:27 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:27 [root] WARNING: horse code set
2015-09-30 10:58:27 [root] WARNING: 32
2015-09-30 10:58:27 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:27 [root] WARNING: horse code set
2015-09-30 10:58:27 [root] WARNING: 33
2015-09-30 10:58:27 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:27 [root] WARNING: horse code set
2015-09-30 10:58:27 [root] WARNING: 34
2015-09-30 10:58:27 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:27 [root] WARNING: horse code set
2015-09-30 10:58:27 [root] WARNING: 35
2015-09-30 10:58:27 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:27 [root] WARNING: horse code set
2015-09-30 10:58:27 [root] WARNING: 36
2015-09-30 10:58:27 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:27 [root] WARNING: horse code set
2015-09-30 10:58:27 [root] WARNING: 37
2015-09-30 10:58:27 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:27 [root] WARNING: horse code set
2015-09-30 10:58:27 [root] WARNING: 38
2015-09-30 10:58:27 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:27 [root] WARNING: horse code set
2015-09-30 10:58:27 [root] WARNING: 39
2015-09-30 10:58:27 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:27 [root] WARNING: horse code set
2015-09-30 10:58:27 [root] WARNING: 40
2015-09-30 10:58:27 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:27 [root] WARNING: horse code set
2015-09-30 10:58:27 [root] WARNING: 41
2015-09-30 10:58:29 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 10:58:29 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:29 [root] WARNING: horse code set
2015-09-30 10:58:29 [root] WARNING: 42
2015-09-30 10:58:29 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:29 [root] WARNING: horse code set
2015-09-30 10:58:29 [root] WARNING: 43
2015-09-30 10:58:29 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:29 [root] WARNING: horse code set
2015-09-30 10:58:29 [root] WARNING: 44
2015-09-30 10:58:29 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:29 [root] WARNING: horse code set
2015-09-30 10:58:29 [root] WARNING: 45
2015-09-30 10:58:29 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:29 [root] WARNING: horse code set
2015-09-30 10:58:29 [root] WARNING: 46
2015-09-30 10:58:29 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:29 [root] WARNING: horse code set
2015-09-30 10:58:29 [root] WARNING: 47
2015-09-30 10:58:29 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:29 [root] WARNING: horse code set
2015-09-30 10:58:29 [root] WARNING: 48
2015-09-30 10:58:29 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:29 [root] WARNING: horse code set
2015-09-30 10:58:29 [root] WARNING: 49
2015-09-30 10:58:29 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:29 [root] WARNING: horse code set
2015-09-30 10:58:29 [root] WARNING: 50
2015-09-30 10:58:29 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:29 [root] WARNING: horse code set
2015-09-30 10:58:29 [root] WARNING: 51
2015-09-30 10:58:29 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:29 [root] WARNING: horse code set
2015-09-30 10:58:29 [root] WARNING: 52
2015-09-30 10:58:29 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 519, in parse_hkjc_racecard
    print("todays draw {}- {}").format(draw_, try_int(draw_))
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 10:58:32 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 10:58:32 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:32 [root] WARNING: horse code set
2015-09-30 10:58:32 [root] WARNING: 53
2015-09-30 10:58:32 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:32 [root] WARNING: horse code set
2015-09-30 10:58:32 [root] WARNING: 54
2015-09-30 10:58:32 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:32 [root] WARNING: horse code set
2015-09-30 10:58:32 [root] WARNING: 55
2015-09-30 10:58:32 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:32 [root] WARNING: horse code set
2015-09-30 10:58:32 [root] WARNING: 56
2015-09-30 10:58:32 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:32 [root] WARNING: horse code set
2015-09-30 10:58:32 [root] WARNING: 57
2015-09-30 10:58:32 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:32 [root] WARNING: horse code set
2015-09-30 10:58:32 [root] WARNING: 58
2015-09-30 10:58:32 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:32 [root] WARNING: horse code set
2015-09-30 10:58:32 [root] WARNING: 59
2015-09-30 10:58:32 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:32 [root] WARNING: horse code set
2015-09-30 10:58:32 [root] WARNING: 60
2015-09-30 10:58:32 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:32 [root] WARNING: horse code set
2015-09-30 10:58:32 [root] WARNING: 61
2015-09-30 10:58:32 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:32 [root] WARNING: horse code set
2015-09-30 10:58:32 [root] WARNING: 62
2015-09-30 10:58:32 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:32 [root] WARNING: horse code set
2015-09-30 10:58:32 [root] WARNING: 63
2015-09-30 10:58:32 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:32 [root] WARNING: horse code set
2015-09-30 10:58:32 [root] WARNING: 64
2015-09-30 10:58:32 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:32 [root] WARNING: horse code set
2015-09-30 10:58:32 [root] WARNING: 65
2015-09-30 10:58:32 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:32 [root] WARNING: horse code set
2015-09-30 10:58:32 [root] WARNING: 66
2015-09-30 10:58:32 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 10:58:32 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:32 [root] WARNING: horse code set
2015-09-30 10:58:32 [root] WARNING: 67
2015-09-30 10:58:32 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:32 [root] WARNING: horse code set
2015-09-30 10:58:32 [root] WARNING: 68
2015-09-30 10:58:32 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:32 [root] WARNING: horse code set
2015-09-30 10:58:32 [root] WARNING: 69
2015-09-30 10:58:32 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:32 [root] WARNING: horse code set
2015-09-30 10:58:32 [root] WARNING: 70
2015-09-30 10:58:32 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:32 [root] WARNING: horse code set
2015-09-30 10:58:32 [root] WARNING: 71
2015-09-30 10:58:32 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:32 [root] WARNING: horse code set
2015-09-30 10:58:32 [root] WARNING: 72
2015-09-30 10:58:32 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:32 [root] WARNING: horse code set
2015-09-30 10:58:32 [root] WARNING: 73
2015-09-30 10:58:32 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:32 [root] WARNING: horse code set
2015-09-30 10:58:32 [root] WARNING: 74
2015-09-30 10:58:32 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:32 [root] WARNING: horse code set
2015-09-30 10:58:32 [root] WARNING: 75
2015-09-30 10:58:32 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:32 [root] WARNING: horse code set
2015-09-30 10:58:32 [root] WARNING: 76
2015-09-30 10:58:32 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:32 [root] WARNING: horse code set
2015-09-30 10:58:32 [root] WARNING: 77
2015-09-30 10:58:32 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:32 [root] WARNING: horse code set
2015-09-30 10:58:32 [root] WARNING: 78
2015-09-30 10:58:32 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:32 [root] WARNING: horse code set
2015-09-30 10:58:32 [root] WARNING: 79
2015-09-30 10:58:34 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 10:58:34 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 10:58:34 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 80
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 81
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 82
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 83
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 84
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 85
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 86
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 87
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 88
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 89
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 90
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 91
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 92
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 93
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 94
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 95
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 96
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 97
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 98
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 99
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 100
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 101
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 102
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 103
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 104
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 105
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 106
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 107
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 108
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 109
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 110
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 111
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 112
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 113
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 114
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 115
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 116
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 117
2015-09-30 10:58:34 [root] WARNING: -------------------------------------------------
2015-09-30 10:58:34 [root] WARNING: horse code set
2015-09-30 10:58:34 [root] WARNING: 118
2015-09-30 10:58:38 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S298&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 10:58:38 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:58:38 [root] WARNING: 1
2015-09-30 10:58:38 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S298&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 10:58:40 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 10:58:40 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:58:40 [root] WARNING: 2
2015-09-30 10:58:40 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 10:58:43 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P446&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 10:58:44 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:58:44 [root] WARNING: 3
2015-09-30 10:58:44 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P446&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 10:58:44 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S266&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 10:58:44 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:58:44 [root] WARNING: 4
2015-09-30 10:58:44 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S266&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 10:58:49 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S194&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 10:58:49 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:58:49 [root] WARNING: 5
2015-09-30 10:58:49 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S194&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 10:58:49 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T117&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 10:58:49 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:58:49 [root] WARNING: 6
2015-09-30 10:58:49 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T117&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 10:58:51 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T217&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 10:58:52 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:58:52 [root] WARNING: 7
2015-09-30 10:58:52 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T217&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 10:58:52 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T285&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 10:58:53 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:58:53 [root] WARNING: 8
2015-09-30 10:58:53 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T285&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 10:58:53 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S142&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 10:58:53 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:58:53 [root] WARNING: 9
2015-09-30 10:58:53 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S142&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 10:58:54 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N300&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 10:58:54 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:58:54 [root] WARNING: 10
2015-09-30 10:58:54 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N300&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 10:58:57 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P412&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 10:58:57 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:58:57 [root] WARNING: 11
2015-09-30 10:58:57 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P412&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 10:58:58 [scrapy] INFO: Crawled 24 pages (at 24 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 10:58:59 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N217&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 10:58:59 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:58:59 [root] WARNING: 12
2015-09-30 10:59:00 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N217&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 10:59:00 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S189&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 10:59:00 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:59:00 [root] WARNING: 13
2015-09-30 10:59:00 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S189&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 10:59:04 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P167&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 10:59:04 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:59:04 [root] WARNING: 14
2015-09-30 10:59:04 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P167&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 10:59:09 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S395&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 10:59:09 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:59:09 [root] WARNING: 15
2015-09-30 10:59:09 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S395&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 10:59:10 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P364&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 10:59:10 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:59:10 [root] WARNING: 16
2015-09-30 10:59:10 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P364&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 10:59:12 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P269&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 10:59:12 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:59:12 [root] WARNING: 17
2015-09-30 10:59:12 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P269&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 10:59:12 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P017&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 10:59:12 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:59:12 [root] WARNING: 18
2015-09-30 10:59:13 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P017&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 10:59:17 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T105&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 10:59:17 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:59:17 [root] WARNING: 19
2015-09-30 10:59:17 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T105&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 10:59:18 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M327&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 10:59:18 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:59:18 [root] WARNING: 20
2015-09-30 10:59:18 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M327&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 10:59:19 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N090&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 10:59:20 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:59:20 [root] WARNING: 21
2015-09-30 10:59:20 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N090&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 10:59:22 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T045&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 10:59:22 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:59:22 [root] WARNING: 22
2015-09-30 10:59:22 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T045&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 10:59:24 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T081&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 10:59:24 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:59:24 [root] WARNING: 23
2015-09-30 10:59:24 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T081&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 10:59:25 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S113&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 10:59:25 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:59:25 [root] WARNING: 24
2015-09-30 10:59:25 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S113&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 10:59:28 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T334&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 10:59:28 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:59:28 [root] WARNING: 25
2015-09-30 10:59:28 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T334&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 10:59:29 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M401&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 10:59:29 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T023&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 10:59:29 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:59:29 [root] WARNING: 26
2015-09-30 10:59:30 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M401&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 10:59:30 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:59:30 [root] WARNING: 27
2015-09-30 10:59:30 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T023&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 10:59:34 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T230&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 10:59:34 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:59:34 [root] WARNING: 28
2015-09-30 10:59:34 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T230&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 10:59:34 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N218&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 10:59:34 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:59:34 [root] WARNING: 29
2015-09-30 10:59:35 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N218&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 10:59:44 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P046&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 10:59:44 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:59:44 [root] WARNING: 30
2015-09-30 10:59:44 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P046&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 10:59:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N265&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 10:59:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:59:46 [root] WARNING: 31
2015-09-30 10:59:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N265&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 10:59:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N416&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 10:59:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:59:47 [root] WARNING: 32
2015-09-30 10:59:48 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N416&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 10:59:50 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S417&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 10:59:50 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:59:50 [root] WARNING: 33
2015-09-30 10:59:50 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S417&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 10:59:52 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P436&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 10:59:52 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:59:52 [root] WARNING: 34
2015-09-30 10:59:52 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P436&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 10:59:52 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T029&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 10:59:52 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:59:52 [root] WARNING: 35
2015-09-30 10:59:52 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T029&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 754, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 10:59:52 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 10:59:52 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:59:52 [root] WARNING: 36
2015-09-30 10:59:53 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 10:59:55 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S356&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 10:59:55 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:59:55 [root] WARNING: 37
2015-09-30 10:59:55 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S356&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 754, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 10:59:58 [scrapy] INFO: Crawled 50 pages (at 26 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 10:59:58 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T283&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 10:59:58 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 10:59:58 [root] WARNING: 38
2015-09-30 10:59:58 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T283&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:00:00 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T073&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 11:00:00 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 11:00:00 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:00:00 [root] WARNING: 39
2015-09-30 11:00:00 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T073&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:00:00 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:00:00 [root] WARNING: 40
2015-09-30 11:00:00 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:00:08 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T027&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:00:08 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:00:08 [root] WARNING: 41
2015-09-30 11:00:08 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T027&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:00:08 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T345&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:00:08 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:00:08 [root] WARNING: 42
2015-09-30 11:00:08 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T345&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:00:11 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P444&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 11:00:11 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:00:11 [root] WARNING: 43
2015-09-30 11:00:11 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P444&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:00:11 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S431&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:00:11 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:00:11 [root] WARNING: 44
2015-09-30 11:00:11 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S431&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:00:12 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P440&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:00:12 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:00:12 [root] WARNING: 45
2015-09-30 11:00:12 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P440&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:00:12 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P308&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:00:12 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:00:12 [root] WARNING: 46
2015-09-30 11:00:12 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P308&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:00:12 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T262&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:00:13 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:00:13 [root] WARNING: 47
2015-09-30 11:00:13 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T262&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:00:15 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T385&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:00:15 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:00:15 [root] WARNING: 48
2015-09-30 11:00:15 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T385&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:00:16 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T357&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:00:16 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P299&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:00:17 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:00:17 [root] WARNING: 49
2015-09-30 11:00:17 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T357&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:00:17 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:00:17 [root] WARNING: 50
2015-09-30 11:00:17 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P299&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:00:20 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T155&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:00:21 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:00:21 [root] WARNING: 51
2015-09-30 11:00:21 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T155&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:00:21 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N360&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 11:00:21 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:00:21 [root] WARNING: 52
2015-09-30 11:00:21 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N360&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:00:22 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P383&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:00:22 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:00:22 [root] WARNING: 53
2015-09-30 11:00:22 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P383&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:00:22 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P239&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:00:23 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:00:23 [root] WARNING: 54
2015-09-30 11:00:23 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P239&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:00:23 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P343&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:00:23 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:00:23 [root] WARNING: 55
2015-09-30 11:00:23 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P343&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:00:33 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S290&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:00:33 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:00:33 [root] WARNING: 56
2015-09-30 11:00:33 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S290&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:00:36 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P353&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:00:36 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:00:36 [root] WARNING: 57
2015-09-30 11:00:36 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P353&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:00:36 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P227&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:00:36 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:00:36 [root] WARNING: 58
2015-09-30 11:00:36 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P227&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:00:42 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N146&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:00:43 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:00:43 [root] WARNING: 59
2015-09-30 11:00:43 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N146&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:00:44 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S423&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:00:44 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:00:44 [root] WARNING: 60
2015-09-30 11:00:44 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S423&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:00:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S006&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:00:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:00:46 [root] WARNING: 61
2015-09-30 11:00:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S006&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:00:50 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N331&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:00:50 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:00:50 [root] WARNING: 62
2015-09-30 11:00:50 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N331&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:00:51 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T028&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:00:51 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:00:51 [root] WARNING: 63
2015-09-30 11:00:51 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T028&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:00:53 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M152&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:00:53 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:00:53 [root] WARNING: 64
2015-09-30 11:00:53 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M152&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:00:53 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P354&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:00:53 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:00:53 [root] WARNING: 65
2015-09-30 11:00:54 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P354&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:00:54 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N115&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:00:54 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:00:54 [root] WARNING: 66
2015-09-30 11:00:54 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N115&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:00:57 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S378&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:00:57 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:00:57 [root] WARNING: 67
2015-09-30 11:00:57 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S378&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:00:57 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P072&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:00:57 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:00:57 [root] WARNING: 68
2015-09-30 11:00:58 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P072&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:00:58 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S370&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:00:58 [scrapy] INFO: Crawled 82 pages (at 32 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 11:00:58 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:00:58 [root] WARNING: 69
2015-09-30 11:00:58 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S370&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:01:00 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S070&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:01:00 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:01:00 [root] WARNING: 70
2015-09-30 11:01:00 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S070&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:01:04 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S116&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:01:04 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:01:04 [root] WARNING: 71
2015-09-30 11:01:04 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S116&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:01:07 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T065&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:01:07 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:01:07 [root] WARNING: 72
2015-09-30 11:01:07 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T065&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:01:14 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S234&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:01:14 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=L401&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:01:14 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:01:14 [root] WARNING: 73
2015-09-30 11:01:14 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S234&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:01:14 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:01:14 [root] WARNING: 74
2015-09-30 11:01:15 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=L401&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:01:15 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T212&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:01:15 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:01:15 [root] WARNING: 75
2015-09-30 11:01:15 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T212&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:01:15 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S387&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:01:15 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:01:15 [root] WARNING: 76
2015-09-30 11:01:15 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S387&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:01:16 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T184&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:01:16 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:01:16 [root] WARNING: 77
2015-09-30 11:01:16 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T184&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:01:20 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T293&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 11:01:21 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:01:21 [root] WARNING: 78
2015-09-30 11:01:21 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T293&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 754, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 11:01:26 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T365&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 11:01:26 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:01:26 [root] WARNING: 79
2015-09-30 11:01:26 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T365&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:01:30 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P062&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:01:30 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:01:30 [root] WARNING: 80
2015-09-30 11:01:30 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P062&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:01:31 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S191&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 11:01:31 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T300&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 11:01:31 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:01:31 [root] WARNING: 81
2015-09-30 11:01:31 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S191&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:01:31 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:01:31 [root] WARNING: 82
2015-09-30 11:01:31 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T300&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:01:31 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P225&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 11:01:31 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:01:31 [root] WARNING: 83
2015-09-30 11:01:32 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P225&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:01:32 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P214&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 11:01:32 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:01:32 [root] WARNING: 84
2015-09-30 11:01:32 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P214&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:01:36 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P267&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 11:01:36 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:01:36 [root] WARNING: 85
2015-09-30 11:01:36 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P267&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:01:37 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T059&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:01:37 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:01:37 [root] WARNING: 86
2015-09-30 11:01:37 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T059&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:01:44 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T190&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:01:44 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:01:44 [root] WARNING: 87
2015-09-30 11:01:44 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T190&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:01:45 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T271&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:01:45 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:01:45 [root] WARNING: 88
2015-09-30 11:01:45 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T271&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:01:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M325&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 11:01:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:01:46 [root] WARNING: 89
2015-09-30 11:01:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M325&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:01:48 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T382&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:01:48 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P351&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:01:48 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:01:48 [root] WARNING: 90
2015-09-30 11:01:48 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T382&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:01:48 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T158&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:01:48 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:01:48 [root] WARNING: 91
2015-09-30 11:01:48 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P351&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:01:48 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:01:48 [root] WARNING: 92
2015-09-30 11:01:48 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T158&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:01:48 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M172&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 11:01:49 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:01:49 [root] WARNING: 93
2015-09-30 11:01:49 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M172&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:01:49 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T350&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:01:49 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:01:49 [root] WARNING: 94
2015-09-30 11:01:49 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T350&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 754, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 11:01:49 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T373&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:01:49 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:01:49 [root] WARNING: 95
2015-09-30 11:01:49 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T373&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 754, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 11:01:53 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S014&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:01:53 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:01:53 [root] WARNING: 96
2015-09-30 11:01:53 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S014&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:01:57 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T284&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:01:57 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:01:57 [root] WARNING: 97
2015-09-30 11:01:57 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T284&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 754, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 11:01:58 [scrapy] INFO: Crawled 110 pages (at 28 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 11:01:59 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S011&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:01:59 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:01:59 [root] WARNING: 98
2015-09-30 11:02:00 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S011&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:02:01 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T245&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:02:01 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:02:01 [root] WARNING: 99
2015-09-30 11:02:01 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T245&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:02:07 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T366&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:02:08 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:02:08 [root] WARNING: 100
2015-09-30 11:02:08 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T366&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:02:10 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S449&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:02:11 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:02:11 [root] WARNING: 101
2015-09-30 11:02:11 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S449&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:02:14 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N375&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:02:14 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:02:14 [root] WARNING: 102
2015-09-30 11:02:14 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N375&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:02:14 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T199&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:02:14 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:02:14 [root] WARNING: 103
2015-09-30 11:02:14 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T199&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:02:20 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N438&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:02:20 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:02:20 [root] WARNING: 104
2015-09-30 11:02:20 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N438&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:02:22 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T236&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:02:22 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:02:22 [root] WARNING: 105
2015-09-30 11:02:22 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T236&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:02:23 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P053&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:02:23 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:02:23 [root] WARNING: 106
2015-09-30 11:02:23 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P053&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:02:23 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T363&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:02:23 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:02:23 [root] WARNING: 107
2015-09-30 11:02:23 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T363&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:02:24 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P281&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:02:24 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:02:24 [root] WARNING: 108
2015-09-30 11:02:24 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P281&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:02:24 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P428&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:02:24 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:02:24 [root] WARNING: 109
2015-09-30 11:02:24 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P428&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:02:25 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:02:26 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:02:26 [root] WARNING: 110
2015-09-30 11:02:26 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:02:27 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N121&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:02:27 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:02:27 [root] WARNING: 111
2015-09-30 11:02:27 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N121&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:02:27 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T375&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 11:02:27 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:02:27 [root] WARNING: 112
2015-09-30 11:02:27 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T375&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 754, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 11:02:28 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T391&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 11:02:28 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:02:28 [root] WARNING: 113
2015-09-30 11:02:28 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T391&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 754, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 11:02:29 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S263&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 11:02:29 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:02:29 [root] WARNING: 114
2015-09-30 11:02:29 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S263&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:02:33 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S362&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 11:02:33 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:02:33 [root] WARNING: 115
2015-09-30 11:02:33 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S362&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 71, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:02:33 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N209&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:02:34 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:02:34 [root] WARNING: 116
2015-09-30 11:02:34 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N209&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 676, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 72, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:02:43 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N268&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 11:02:43 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:02:43 [root] WARNING: 117
2015-09-30 11:02:43 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N268&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 625, in parse_horse
    prev_rps = [int(x.strip()) for x in prev_rps if x not in [u' ', u'', u'--', None]]
ValueError: invalid literal for int() with base 10: '1.25.60'
2015-09-30 11:02:43 [scrapy] INFO: Closing spider (finished)
2015-09-30 11:02:43 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 70729,
 'downloader/request_count': 131,
 'downloader/request_method_count/GET': 130,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 10655547,
 'downloader/response_count': 131,
 'downloader/response_status_count/200': 130,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 11, 2, 43, 914530),
 'log_count/DEBUG': 133,
 'log_count/ERROR': 118,
 'log_count/INFO': 11,
 'log_count/WARNING': 588,
 'request_depth_max': 5,
 'response_received_count': 130,
 'scheduler/dequeued': 131,
 'scheduler/dequeued/memory': 131,
 'scheduler/enqueued': 131,
 'scheduler/enqueued/memory': 131,
 'spider_exceptions/IndexError': 108,
 'spider_exceptions/UnicodeEncodeError': 1,
 'spider_exceptions/ValueError': 1,
 'spider_exceptions/ZeroDivisionError': 8,
 'start_time': datetime.datetime(2015, 9, 30, 10, 57, 58, 63826)}
2015-09-30 11:02:43 [scrapy] INFO: Spider closed (finished)
2015-09-30 11:04:55 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 11:04:55 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 11:04:55 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 11:04:55 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 11:04:55 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 11:04:55 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 11:04:55 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 11:04:55 [scrapy] INFO: Spider opened
2015-09-30 11:04:55 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 11:04:55 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 11:04:57 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 11:05:00 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 11:05:06 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 11:05:11 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 11:05:18 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 11:05:18 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 11:05:26 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 11:05:26 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:26 [root] WARNING: horse code set
2015-09-30 11:05:26 [root] WARNING: 1
2015-09-30 11:05:26 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:26 [root] WARNING: horse code set
2015-09-30 11:05:26 [root] WARNING: 2
2015-09-30 11:05:26 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:26 [root] WARNING: horse code set
2015-09-30 11:05:26 [root] WARNING: 3
2015-09-30 11:05:26 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:26 [root] WARNING: horse code set
2015-09-30 11:05:26 [root] WARNING: 4
2015-09-30 11:05:26 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:26 [root] WARNING: horse code set
2015-09-30 11:05:26 [root] WARNING: 5
2015-09-30 11:05:26 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:26 [root] WARNING: horse code set
2015-09-30 11:05:26 [root] WARNING: 6
2015-09-30 11:05:26 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:26 [root] WARNING: horse code set
2015-09-30 11:05:26 [root] WARNING: 7
2015-09-30 11:05:26 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:26 [root] WARNING: horse code set
2015-09-30 11:05:26 [root] WARNING: 8
2015-09-30 11:05:26 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:26 [root] WARNING: horse code set
2015-09-30 11:05:26 [root] WARNING: 9
2015-09-30 11:05:26 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:26 [root] WARNING: horse code set
2015-09-30 11:05:26 [root] WARNING: 10
2015-09-30 11:05:26 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:26 [root] WARNING: horse code set
2015-09-30 11:05:26 [root] WARNING: 11
2015-09-30 11:05:26 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:26 [root] WARNING: horse code set
2015-09-30 11:05:26 [root] WARNING: 12
2015-09-30 11:05:26 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:26 [root] WARNING: horse code set
2015-09-30 11:05:26 [root] WARNING: 13
2015-09-30 11:05:26 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:26 [root] WARNING: horse code set
2015-09-30 11:05:26 [root] WARNING: 14
2015-09-30 11:05:29 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 11:05:29 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:29 [root] WARNING: horse code set
2015-09-30 11:05:29 [root] WARNING: 15
2015-09-30 11:05:29 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:29 [root] WARNING: horse code set
2015-09-30 11:05:29 [root] WARNING: 16
2015-09-30 11:05:29 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:29 [root] WARNING: horse code set
2015-09-30 11:05:29 [root] WARNING: 17
2015-09-30 11:05:29 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:29 [root] WARNING: horse code set
2015-09-30 11:05:29 [root] WARNING: 18
2015-09-30 11:05:29 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:29 [root] WARNING: horse code set
2015-09-30 11:05:29 [root] WARNING: 19
2015-09-30 11:05:29 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:29 [root] WARNING: horse code set
2015-09-30 11:05:29 [root] WARNING: 20
2015-09-30 11:05:29 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:29 [root] WARNING: horse code set
2015-09-30 11:05:29 [root] WARNING: 21
2015-09-30 11:05:29 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:29 [root] WARNING: horse code set
2015-09-30 11:05:29 [root] WARNING: 22
2015-09-30 11:05:29 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:29 [root] WARNING: horse code set
2015-09-30 11:05:29 [root] WARNING: 23
2015-09-30 11:05:29 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:29 [root] WARNING: horse code set
2015-09-30 11:05:29 [root] WARNING: 24
2015-09-30 11:05:29 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:29 [root] WARNING: horse code set
2015-09-30 11:05:29 [root] WARNING: 25
2015-09-30 11:05:29 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 519, in parse_hkjc_racecard
    print("todays draw {}- {}").format(draw_, try_int(draw_))
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 11:05:35 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 11:05:35 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:35 [root] WARNING: horse code set
2015-09-30 11:05:35 [root] WARNING: 26
2015-09-30 11:05:35 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:35 [root] WARNING: horse code set
2015-09-30 11:05:35 [root] WARNING: 27
2015-09-30 11:05:35 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:35 [root] WARNING: horse code set
2015-09-30 11:05:35 [root] WARNING: 28
2015-09-30 11:05:35 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:35 [root] WARNING: horse code set
2015-09-30 11:05:35 [root] WARNING: 29
2015-09-30 11:05:35 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:35 [root] WARNING: horse code set
2015-09-30 11:05:35 [root] WARNING: 30
2015-09-30 11:05:35 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:35 [root] WARNING: horse code set
2015-09-30 11:05:35 [root] WARNING: 31
2015-09-30 11:05:35 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:35 [root] WARNING: horse code set
2015-09-30 11:05:35 [root] WARNING: 32
2015-09-30 11:05:35 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:35 [root] WARNING: horse code set
2015-09-30 11:05:35 [root] WARNING: 33
2015-09-30 11:05:35 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:35 [root] WARNING: horse code set
2015-09-30 11:05:35 [root] WARNING: 34
2015-09-30 11:05:35 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:35 [root] WARNING: horse code set
2015-09-30 11:05:35 [root] WARNING: 35
2015-09-30 11:05:35 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:35 [root] WARNING: horse code set
2015-09-30 11:05:35 [root] WARNING: 36
2015-09-30 11:05:35 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:35 [root] WARNING: horse code set
2015-09-30 11:05:35 [root] WARNING: 37
2015-09-30 11:05:35 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:35 [root] WARNING: horse code set
2015-09-30 11:05:35 [root] WARNING: 38
2015-09-30 11:05:35 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:35 [root] WARNING: horse code set
2015-09-30 11:05:35 [root] WARNING: 39
2015-09-30 11:05:36 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 11:05:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:36 [root] WARNING: horse code set
2015-09-30 11:05:36 [root] WARNING: 40
2015-09-30 11:05:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:36 [root] WARNING: horse code set
2015-09-30 11:05:36 [root] WARNING: 41
2015-09-30 11:05:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:36 [root] WARNING: horse code set
2015-09-30 11:05:36 [root] WARNING: 42
2015-09-30 11:05:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:36 [root] WARNING: horse code set
2015-09-30 11:05:36 [root] WARNING: 43
2015-09-30 11:05:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:36 [root] WARNING: horse code set
2015-09-30 11:05:36 [root] WARNING: 44
2015-09-30 11:05:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:36 [root] WARNING: horse code set
2015-09-30 11:05:36 [root] WARNING: 45
2015-09-30 11:05:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:36 [root] WARNING: horse code set
2015-09-30 11:05:36 [root] WARNING: 46
2015-09-30 11:05:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:36 [root] WARNING: horse code set
2015-09-30 11:05:36 [root] WARNING: 47
2015-09-30 11:05:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:36 [root] WARNING: horse code set
2015-09-30 11:05:36 [root] WARNING: 48
2015-09-30 11:05:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:36 [root] WARNING: horse code set
2015-09-30 11:05:36 [root] WARNING: 49
2015-09-30 11:05:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:36 [root] WARNING: horse code set
2015-09-30 11:05:36 [root] WARNING: 50
2015-09-30 11:05:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:36 [root] WARNING: horse code set
2015-09-30 11:05:36 [root] WARNING: 51
2015-09-30 11:05:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:36 [root] WARNING: horse code set
2015-09-30 11:05:36 [root] WARNING: 52
2015-09-30 11:05:36 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 11:05:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:36 [root] WARNING: horse code set
2015-09-30 11:05:36 [root] WARNING: 53
2015-09-30 11:05:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:36 [root] WARNING: horse code set
2015-09-30 11:05:36 [root] WARNING: 54
2015-09-30 11:05:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:36 [root] WARNING: horse code set
2015-09-30 11:05:36 [root] WARNING: 55
2015-09-30 11:05:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:36 [root] WARNING: horse code set
2015-09-30 11:05:36 [root] WARNING: 56
2015-09-30 11:05:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:36 [root] WARNING: horse code set
2015-09-30 11:05:36 [root] WARNING: 57
2015-09-30 11:05:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:36 [root] WARNING: horse code set
2015-09-30 11:05:36 [root] WARNING: 58
2015-09-30 11:05:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:36 [root] WARNING: horse code set
2015-09-30 11:05:36 [root] WARNING: 59
2015-09-30 11:05:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:36 [root] WARNING: horse code set
2015-09-30 11:05:36 [root] WARNING: 60
2015-09-30 11:05:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:36 [root] WARNING: horse code set
2015-09-30 11:05:36 [root] WARNING: 61
2015-09-30 11:05:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:36 [root] WARNING: horse code set
2015-09-30 11:05:36 [root] WARNING: 62
2015-09-30 11:05:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:36 [root] WARNING: horse code set
2015-09-30 11:05:36 [root] WARNING: 63
2015-09-30 11:05:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:36 [root] WARNING: horse code set
2015-09-30 11:05:36 [root] WARNING: 64
2015-09-30 11:05:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:36 [root] WARNING: horse code set
2015-09-30 11:05:36 [root] WARNING: 65
2015-09-30 11:05:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:36 [root] WARNING: horse code set
2015-09-30 11:05:36 [root] WARNING: 66
2015-09-30 11:05:37 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 11:05:37 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:37 [root] WARNING: horse code set
2015-09-30 11:05:37 [root] WARNING: 67
2015-09-30 11:05:37 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:37 [root] WARNING: horse code set
2015-09-30 11:05:37 [root] WARNING: 68
2015-09-30 11:05:37 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:37 [root] WARNING: horse code set
2015-09-30 11:05:37 [root] WARNING: 69
2015-09-30 11:05:37 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:37 [root] WARNING: horse code set
2015-09-30 11:05:37 [root] WARNING: 70
2015-09-30 11:05:37 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:37 [root] WARNING: horse code set
2015-09-30 11:05:37 [root] WARNING: 71
2015-09-30 11:05:37 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:37 [root] WARNING: horse code set
2015-09-30 11:05:37 [root] WARNING: 72
2015-09-30 11:05:37 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:37 [root] WARNING: horse code set
2015-09-30 11:05:37 [root] WARNING: 73
2015-09-30 11:05:37 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:37 [root] WARNING: horse code set
2015-09-30 11:05:37 [root] WARNING: 74
2015-09-30 11:05:37 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:37 [root] WARNING: horse code set
2015-09-30 11:05:37 [root] WARNING: 75
2015-09-30 11:05:37 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:37 [root] WARNING: horse code set
2015-09-30 11:05:37 [root] WARNING: 76
2015-09-30 11:05:37 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:37 [root] WARNING: horse code set
2015-09-30 11:05:37 [root] WARNING: 77
2015-09-30 11:05:37 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:37 [root] WARNING: horse code set
2015-09-30 11:05:37 [root] WARNING: 78
2015-09-30 11:05:37 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:37 [root] WARNING: horse code set
2015-09-30 11:05:37 [root] WARNING: 79
2015-09-30 11:05:37 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:37 [root] WARNING: horse code set
2015-09-30 11:05:37 [root] WARNING: 80
2015-09-30 11:05:38 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 11:05:38 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:38 [root] WARNING: horse code set
2015-09-30 11:05:38 [root] WARNING: 81
2015-09-30 11:05:38 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:38 [root] WARNING: horse code set
2015-09-30 11:05:38 [root] WARNING: 82
2015-09-30 11:05:38 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:38 [root] WARNING: horse code set
2015-09-30 11:05:38 [root] WARNING: 83
2015-09-30 11:05:38 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:38 [root] WARNING: horse code set
2015-09-30 11:05:38 [root] WARNING: 84
2015-09-30 11:05:38 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:38 [root] WARNING: horse code set
2015-09-30 11:05:38 [root] WARNING: 85
2015-09-30 11:05:38 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:38 [root] WARNING: horse code set
2015-09-30 11:05:38 [root] WARNING: 86
2015-09-30 11:05:38 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:38 [root] WARNING: horse code set
2015-09-30 11:05:38 [root] WARNING: 87
2015-09-30 11:05:38 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:38 [root] WARNING: horse code set
2015-09-30 11:05:38 [root] WARNING: 88
2015-09-30 11:05:38 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:38 [root] WARNING: horse code set
2015-09-30 11:05:38 [root] WARNING: 89
2015-09-30 11:05:38 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:38 [root] WARNING: horse code set
2015-09-30 11:05:38 [root] WARNING: 90
2015-09-30 11:05:38 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:38 [root] WARNING: horse code set
2015-09-30 11:05:38 [root] WARNING: 91
2015-09-30 11:05:38 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:38 [root] WARNING: horse code set
2015-09-30 11:05:38 [root] WARNING: 92
2015-09-30 11:05:38 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:38 [root] WARNING: horse code set
2015-09-30 11:05:38 [root] WARNING: 93
2015-09-30 11:05:41 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 11:05:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:41 [root] WARNING: horse code set
2015-09-30 11:05:41 [root] WARNING: 94
2015-09-30 11:05:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:41 [root] WARNING: horse code set
2015-09-30 11:05:41 [root] WARNING: 95
2015-09-30 11:05:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:41 [root] WARNING: horse code set
2015-09-30 11:05:41 [root] WARNING: 96
2015-09-30 11:05:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:41 [root] WARNING: horse code set
2015-09-30 11:05:41 [root] WARNING: 97
2015-09-30 11:05:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:41 [root] WARNING: horse code set
2015-09-30 11:05:41 [root] WARNING: 98
2015-09-30 11:05:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:41 [root] WARNING: horse code set
2015-09-30 11:05:41 [root] WARNING: 99
2015-09-30 11:05:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:41 [root] WARNING: horse code set
2015-09-30 11:05:41 [root] WARNING: 100
2015-09-30 11:05:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:41 [root] WARNING: horse code set
2015-09-30 11:05:41 [root] WARNING: 101
2015-09-30 11:05:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:41 [root] WARNING: horse code set
2015-09-30 11:05:41 [root] WARNING: 102
2015-09-30 11:05:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:41 [root] WARNING: horse code set
2015-09-30 11:05:41 [root] WARNING: 103
2015-09-30 11:05:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:41 [root] WARNING: horse code set
2015-09-30 11:05:41 [root] WARNING: 104
2015-09-30 11:05:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:41 [root] WARNING: horse code set
2015-09-30 11:05:41 [root] WARNING: 105
2015-09-30 11:05:44 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T363&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:05:44 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:05:44 [root] WARNING: 1
2015-09-30 11:05:44 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T363&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:05:46 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 11:05:46 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:46 [root] WARNING: horse code set
2015-09-30 11:05:46 [root] WARNING: 106
2015-09-30 11:05:46 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:46 [root] WARNING: horse code set
2015-09-30 11:05:46 [root] WARNING: 107
2015-09-30 11:05:46 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:46 [root] WARNING: horse code set
2015-09-30 11:05:46 [root] WARNING: 108
2015-09-30 11:05:46 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:46 [root] WARNING: horse code set
2015-09-30 11:05:46 [root] WARNING: 109
2015-09-30 11:05:46 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:46 [root] WARNING: horse code set
2015-09-30 11:05:46 [root] WARNING: 110
2015-09-30 11:05:46 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:46 [root] WARNING: horse code set
2015-09-30 11:05:46 [root] WARNING: 111
2015-09-30 11:05:46 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:46 [root] WARNING: horse code set
2015-09-30 11:05:46 [root] WARNING: 112
2015-09-30 11:05:46 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:46 [root] WARNING: horse code set
2015-09-30 11:05:46 [root] WARNING: 113
2015-09-30 11:05:46 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:46 [root] WARNING: horse code set
2015-09-30 11:05:46 [root] WARNING: 114
2015-09-30 11:05:46 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:46 [root] WARNING: horse code set
2015-09-30 11:05:46 [root] WARNING: 115
2015-09-30 11:05:46 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:46 [root] WARNING: horse code set
2015-09-30 11:05:46 [root] WARNING: 116
2015-09-30 11:05:46 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:46 [root] WARNING: horse code set
2015-09-30 11:05:46 [root] WARNING: 117
2015-09-30 11:05:46 [root] WARNING: -------------------------------------------------
2015-09-30 11:05:46 [root] WARNING: horse code set
2015-09-30 11:05:46 [root] WARNING: 118
2015-09-30 11:05:55 [scrapy] INFO: Crawled 14 pages (at 14 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 11:05:56 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T366&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:05:56 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:05:56 [root] WARNING: 2
2015-09-30 11:05:56 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T366&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:06:00 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P428&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:06:00 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:06:00 [root] WARNING: 3
2015-09-30 11:06:00 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P428&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:06:02 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S449&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:06:02 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:06:02 [root] WARNING: 4
2015-09-30 11:06:02 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S449&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:06:06 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T285&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 11:06:06 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:06:06 [root] WARNING: 5
2015-09-30 11:06:06 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T285&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:06:11 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:06:11 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:06:11 [root] WARNING: 6
2015-09-30 11:06:11 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:06:15 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N217&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:06:16 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:06:16 [root] WARNING: 7
2015-09-30 11:06:16 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N217&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:06:16 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N438&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:06:16 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:06:16 [root] WARNING: 8
2015-09-30 11:06:16 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N438&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:06:18 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N375&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:06:18 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:06:18 [root] WARNING: 9
2015-09-30 11:06:18 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N375&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:06:18 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S189&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:06:18 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:06:18 [root] WARNING: 10
2015-09-30 11:06:18 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S189&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:06:21 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T217&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:06:22 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:06:22 [root] WARNING: 11
2015-09-30 11:06:22 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T217&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:06:26 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S142&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 11:06:26 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:06:26 [root] WARNING: 12
2015-09-30 11:06:27 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S142&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:06:29 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P053&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:06:29 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:06:29 [root] WARNING: 13
2015-09-30 11:06:29 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P053&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:06:38 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P308&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:06:38 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:06:38 [root] WARNING: 14
2015-09-30 11:06:38 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P308&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:06:43 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S431&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:06:43 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:06:43 [root] WARNING: 15
2015-09-30 11:06:43 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S431&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:06:44 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T045&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 11:06:44 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:06:44 [root] WARNING: 16
2015-09-30 11:06:44 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T045&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:06:44 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T027&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:06:44 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:06:44 [root] WARNING: 17
2015-09-30 11:06:44 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T027&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:06:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P440&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:06:48 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:06:48 [root] WARNING: 18
2015-09-30 11:06:48 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P440&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:06:48 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T345&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:06:48 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:06:48 [root] WARNING: 19
2015-09-30 11:06:48 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T345&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:06:49 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P269&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:06:49 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:06:49 [root] WARNING: 20
2015-09-30 11:06:49 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P269&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:06:51 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N090&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 11:06:51 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:06:51 [root] WARNING: 21
2015-09-30 11:06:51 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N090&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:06:52 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T385&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:06:53 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:06:53 [root] WARNING: 22
2015-09-30 11:06:53 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T385&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:06:55 [scrapy] INFO: Crawled 35 pages (at 21 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 11:06:57 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T262&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:06:57 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:06:57 [root] WARNING: 23
2015-09-30 11:06:57 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T262&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:06:58 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N218&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 11:06:58 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:06:58 [root] WARNING: 24
2015-09-30 11:06:59 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N218&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:06:59 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T357&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:06:59 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:06:59 [root] WARNING: 25
2015-09-30 11:06:59 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T357&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:07:03 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P299&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:07:04 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:07:04 [root] WARNING: 26
2015-09-30 11:07:04 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P299&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:07:04 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P383&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:07:05 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:07:05 [root] WARNING: 27
2015-09-30 11:07:05 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P383&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:07:06 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P239&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:07:07 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:07:07 [root] WARNING: 28
2015-09-30 11:07:07 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P239&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:07:10 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T334&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 11:07:10 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:07:10 [root] WARNING: 29
2015-09-30 11:07:10 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T334&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:07:10 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T081&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 11:07:10 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:07:10 [root] WARNING: 30
2015-09-30 11:07:10 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T081&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:07:10 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T023&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 11:07:10 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:07:10 [root] WARNING: 31
2015-09-30 11:07:10 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T023&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:07:12 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P343&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:07:12 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:07:12 [root] WARNING: 32
2015-09-30 11:07:12 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P343&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:07:15 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T029&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 11:07:15 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:07:15 [root] WARNING: 33
2015-09-30 11:07:15 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T029&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 755, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 11:07:21 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T073&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 11:07:21 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:07:21 [root] WARNING: 34
2015-09-30 11:07:21 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T073&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:07:22 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T155&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:07:22 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:07:22 [root] WARNING: 35
2015-09-30 11:07:22 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T155&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:07:23 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S356&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 11:07:23 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:07:23 [root] WARNING: 36
2015-09-30 11:07:23 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S356&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 755, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 11:07:23 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T283&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 11:07:23 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:07:23 [root] WARNING: 37
2015-09-30 11:07:24 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T283&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:07:34 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N265&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 11:07:34 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:07:34 [root] WARNING: 38
2015-09-30 11:07:35 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N265&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:07:35 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P444&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 11:07:35 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:07:35 [root] WARNING: 39
2015-09-30 11:07:35 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P444&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:07:38 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P167&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:07:38 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:07:38 [root] WARNING: 40
2015-09-30 11:07:38 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P167&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:07:44 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P353&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:07:44 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:07:44 [root] WARNING: 41
2015-09-30 11:07:44 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P353&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:07:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P227&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:07:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:07:46 [root] WARNING: 42
2015-09-30 11:07:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P227&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:07:53 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N360&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 11:07:54 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:07:54 [root] WARNING: 43
2015-09-30 11:07:54 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N360&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:07:55 [scrapy] INFO: Crawled 56 pages (at 21 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 11:07:57 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S290&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:07:57 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:07:57 [root] WARNING: 44
2015-09-30 11:07:57 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S290&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:07:59 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S423&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:07:59 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:07:59 [root] WARNING: 45
2015-09-30 11:07:59 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S423&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:08:01 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S006&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:08:01 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:08:01 [root] WARNING: 46
2015-09-30 11:08:01 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S006&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:08:02 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N146&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:08:02 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:08:02 [root] WARNING: 47
2015-09-30 11:08:03 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N146&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:08:04 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T375&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 11:08:04 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:08:04 [root] WARNING: 48
2015-09-30 11:08:04 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T375&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 755, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 11:08:10 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N331&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:08:10 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:08:10 [root] WARNING: 49
2015-09-30 11:08:10 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N331&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:08:10 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M152&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:08:11 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:08:11 [root] WARNING: 50
2015-09-30 11:08:11 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M152&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:08:12 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T391&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 11:08:12 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:08:12 [root] WARNING: 51
2015-09-30 11:08:12 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T391&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 755, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 11:08:13 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P017&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:08:13 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:08:13 [root] WARNING: 52
2015-09-30 11:08:13 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P017&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:08:20 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P354&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:08:20 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:08:20 [root] WARNING: 53
2015-09-30 11:08:20 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P354&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:08:20 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S194&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 11:08:20 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:08:20 [root] WARNING: 54
2015-09-30 11:08:20 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S194&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:08:22 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 11:08:22 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:08:22 [root] WARNING: 55
2015-09-30 11:08:22 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:08:22 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S263&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 11:08:22 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:08:22 [root] WARNING: 56
2015-09-30 11:08:22 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S263&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:08:26 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S266&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 11:08:26 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:08:26 [root] WARNING: 57
2015-09-30 11:08:26 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S266&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:08:27 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T117&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 11:08:27 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:08:27 [root] WARNING: 58
2015-09-30 11:08:28 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T117&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:08:35 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P446&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 11:08:35 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:08:35 [root] WARNING: 59
2015-09-30 11:08:35 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P446&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:08:37 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N300&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 11:08:37 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:08:37 [root] WARNING: 60
2015-09-30 11:08:38 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N300&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:08:41 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S362&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 11:08:41 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:08:41 [root] WARNING: 61
2015-09-30 11:08:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S362&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:08:41 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S395&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 11:08:42 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:08:42 [root] WARNING: 62
2015-09-30 11:08:42 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S395&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:08:45 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P072&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:08:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:08:46 [root] WARNING: 63
2015-09-30 11:08:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P072&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:08:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P364&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 11:08:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:08:46 [root] WARNING: 64
2015-09-30 11:08:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P364&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:08:51 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P412&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 11:08:51 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:08:51 [root] WARNING: 65
2015-09-30 11:08:51 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P412&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:08:54 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T105&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 11:08:55 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:08:55 [root] WARNING: 66
2015-09-30 11:08:55 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T105&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:08:55 [scrapy] INFO: Crawled 79 pages (at 23 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 11:09:00 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T230&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 11:09:00 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:09:00 [root] WARNING: 67
2015-09-30 11:09:00 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T230&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:09:05 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N268&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 11:09:05 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:09:05 [root] WARNING: 68
2015-09-30 11:09:05 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N268&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:09:10 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S298&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 11:09:10 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:09:10 [root] WARNING: 69
2015-09-30 11:09:10 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S298&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:09:18 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S113&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 11:09:18 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:09:18 [root] WARNING: 70
2015-09-30 11:09:19 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S113&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:09:22 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P046&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 11:09:22 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:09:22 [root] WARNING: 71
2015-09-30 11:09:22 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P046&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:09:29 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S417&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 11:09:29 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:09:29 [root] WARNING: 72
2015-09-30 11:09:29 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S417&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:09:30 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M401&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 11:09:30 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:09:30 [root] WARNING: 73
2015-09-30 11:09:30 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M401&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:09:30 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M327&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 11:09:30 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P436&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 11:09:30 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:09:30 [root] WARNING: 74
2015-09-30 11:09:30 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M327&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:09:30 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:09:30 [root] WARNING: 75
2015-09-30 11:09:30 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P436&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:09:31 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N416&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 11:09:31 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:09:31 [root] WARNING: 76
2015-09-30 11:09:31 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N416&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:09:32 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T059&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:09:32 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:09:32 [root] WARNING: 77
2015-09-30 11:09:32 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T059&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:09:38 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T382&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:09:38 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:09:38 [root] WARNING: 78
2015-09-30 11:09:38 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T382&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:09:40 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T158&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:09:40 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:09:40 [root] WARNING: 79
2015-09-30 11:09:40 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T158&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:09:41 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T190&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:09:41 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:09:41 [root] WARNING: 80
2015-09-30 11:09:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T190&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:09:41 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T350&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:09:41 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:09:41 [root] WARNING: 81
2015-09-30 11:09:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T350&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 755, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 11:09:42 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T271&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:09:42 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:09:42 [root] WARNING: 82
2015-09-30 11:09:42 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T271&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:09:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T373&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:09:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:09:47 [root] WARNING: 83
2015-09-30 11:09:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T373&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 755, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 11:09:49 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T284&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:09:49 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:09:49 [root] WARNING: 84
2015-09-30 11:09:49 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T284&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 755, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 11:09:50 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 11:09:50 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T245&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:09:50 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:09:50 [root] WARNING: 85
2015-09-30 11:09:51 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:09:51 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:09:51 [root] WARNING: 86
2015-09-30 11:09:51 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T245&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:09:55 [scrapy] INFO: Crawled 99 pages (at 20 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 11:09:56 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P351&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:09:56 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:09:56 [root] WARNING: 87
2015-09-30 11:09:56 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P351&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:10:01 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S011&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:10:01 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:10:01 [root] WARNING: 88
2015-09-30 11:10:01 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S011&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:10:06 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S370&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:10:06 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:10:06 [root] WARNING: 89
2015-09-30 11:10:06 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S370&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:10:08 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N115&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:10:08 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:10:08 [root] WARNING: 90
2015-09-30 11:10:08 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N115&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:10:11 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 11:10:11 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:10:11 [root] WARNING: 91
2015-09-30 11:10:11 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:10:19 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T065&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:10:19 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:10:19 [root] WARNING: 92
2015-09-30 11:10:19 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T065&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:10:22 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S378&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:10:22 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:10:22 [root] WARNING: 93
2015-09-30 11:10:22 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S378&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:10:23 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S116&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:10:23 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:10:23 [root] WARNING: 94
2015-09-30 11:10:23 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S116&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:10:28 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S070&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:10:28 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:10:28 [root] WARNING: 95
2015-09-30 11:10:28 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S070&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:10:30 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S387&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:10:30 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:10:30 [root] WARNING: 96
2015-09-30 11:10:30 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S387&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:10:30 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T212&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:10:30 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:10:30 [root] WARNING: 97
2015-09-30 11:10:30 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T212&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:10:34 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T184&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:10:34 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:10:34 [root] WARNING: 98
2015-09-30 11:10:34 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T184&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:10:34 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S014&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:10:34 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:10:34 [root] WARNING: 99
2015-09-30 11:10:35 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S014&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:10:45 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S234&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:10:45 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:10:45 [root] WARNING: 100
2015-09-30 11:10:45 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S234&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:10:45 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P214&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 11:10:45 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:10:45 [root] WARNING: 101
2015-09-30 11:10:45 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P214&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp), hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:10:52 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T365&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 11:10:52 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:10:52 [root] WARNING: 102
2015-09-30 11:10:52 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T365&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp),
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:10:55 [scrapy] INFO: Crawled 115 pages (at 16 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 11:10:59 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T293&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 11:10:59 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:10:59 [root] WARNING: 103
2015-09-30 11:10:59 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T293&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 755, in parse_horse
    total_runs = len(valid_indexes)
ZeroDivisionError: float division by zero
2015-09-30 11:11:00 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T028&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:11:01 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:11:01 [root] WARNING: 104
2015-09-30 11:11:01 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T028&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp),
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:11:01 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M325&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 11:11:02 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:11:02 [root] WARNING: 105
2015-09-30 11:11:02 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M325&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp),
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:11:02 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T300&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 11:11:02 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:11:02 [root] WARNING: 106
2015-09-30 11:11:02 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T300&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp),
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:11:08 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P062&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:11:08 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:11:08 [root] WARNING: 107
2015-09-30 11:11:08 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P062&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp),
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:11:13 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S191&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 11:11:13 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:11:13 [root] WARNING: 108
2015-09-30 11:11:13 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S191&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp),
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:11:16 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P267&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 11:11:16 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:11:16 [root] WARNING: 109
2015-09-30 11:11:16 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P267&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp),
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:11:17 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P225&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 11:11:17 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T199&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:11:17 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:11:17 [root] WARNING: 110
2015-09-30 11:11:17 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P225&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp),
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:11:17 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:11:17 [root] WARNING: 111
2015-09-30 11:11:17 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T199&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp),
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:11:24 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T236&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:11:24 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:11:24 [root] WARNING: 112
2015-09-30 11:11:24 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T236&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp),
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:11:30 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N121&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:11:30 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:11:30 [root] WARNING: 113
2015-09-30 11:11:31 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N121&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp),
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:11:51 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P281&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:11:51 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:11:51 [root] WARNING: 114
2015-09-30 11:11:51 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P281&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp),
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:11:53 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=L401&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:11:53 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:11:53 [root] WARNING: 115
2015-09-30 11:11:53 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=L401&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp),
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:11:55 [scrapy] INFO: Crawled 128 pages (at 13 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 11:12:02 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M172&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 11:12:02 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:12:02 [root] WARNING: 116
2015-09-30 11:12:03 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M172&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp),
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:12:19 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N209&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:12:19 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:12:19 [root] WARNING: 117
2015-09-30 11:12:20 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N209&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 677, in parse_horse
    _tmp,hkjc_utilities.ismadeall(_tmp), hkjc_utilities.islostlead(_tmp),
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:12:20 [scrapy] INFO: Closing spider (finished)
2015-09-30 11:12:20 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 66397,
 'downloader/request_count': 131,
 'downloader/request_method_count/GET': 130,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 10657111,
 'downloader/response_count': 131,
 'downloader/response_status_count/200': 130,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 11, 12, 20, 237303),
 'log_count/DEBUG': 133,
 'log_count/ERROR': 118,
 'log_count/INFO': 14,
 'log_count/WARNING': 588,
 'request_depth_max': 5,
 'response_received_count': 130,
 'scheduler/dequeued': 131,
 'scheduler/dequeued/memory': 131,
 'scheduler/enqueued': 131,
 'scheduler/enqueued/memory': 131,
 'spider_exceptions/IndexError': 109,
 'spider_exceptions/UnicodeEncodeError': 1,
 'spider_exceptions/ZeroDivisionError': 8,
 'start_time': datetime.datetime(2015, 9, 30, 11, 4, 55, 477550)}
2015-09-30 11:12:20 [scrapy] INFO: Spider closed (finished)
2015-09-30 11:13:49 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 11:13:49 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 11:13:49 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 11:13:50 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 11:13:50 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 11:13:50 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 11:13:50 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 11:13:50 [scrapy] INFO: Spider opened
2015-09-30 11:13:50 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 11:13:50 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6027
2015-09-30 11:13:52 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 11:13:57 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 11:14:04 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 11:14:08 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 11:14:16 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 11:14:16 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 11:14:22 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 11:14:23 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:23 [root] WARNING: horse code set
2015-09-30 11:14:23 [root] WARNING: 1
2015-09-30 11:14:23 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:23 [root] WARNING: horse code set
2015-09-30 11:14:23 [root] WARNING: 2
2015-09-30 11:14:23 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:23 [root] WARNING: horse code set
2015-09-30 11:14:23 [root] WARNING: 3
2015-09-30 11:14:23 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:23 [root] WARNING: horse code set
2015-09-30 11:14:23 [root] WARNING: 4
2015-09-30 11:14:23 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:23 [root] WARNING: horse code set
2015-09-30 11:14:23 [root] WARNING: 5
2015-09-30 11:14:23 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:23 [root] WARNING: horse code set
2015-09-30 11:14:23 [root] WARNING: 6
2015-09-30 11:14:23 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:23 [root] WARNING: horse code set
2015-09-30 11:14:23 [root] WARNING: 7
2015-09-30 11:14:23 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:23 [root] WARNING: horse code set
2015-09-30 11:14:23 [root] WARNING: 8
2015-09-30 11:14:23 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:23 [root] WARNING: horse code set
2015-09-30 11:14:23 [root] WARNING: 9
2015-09-30 11:14:23 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:23 [root] WARNING: horse code set
2015-09-30 11:14:23 [root] WARNING: 10
2015-09-30 11:14:23 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:23 [root] WARNING: horse code set
2015-09-30 11:14:23 [root] WARNING: 11
2015-09-30 11:14:23 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:23 [root] WARNING: horse code set
2015-09-30 11:14:23 [root] WARNING: 12
2015-09-30 11:14:23 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:23 [root] WARNING: horse code set
2015-09-30 11:14:23 [root] WARNING: 13
2015-09-30 11:14:23 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:23 [root] WARNING: horse code set
2015-09-30 11:14:23 [root] WARNING: 14
2015-09-30 11:14:31 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 11:14:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:31 [root] WARNING: horse code set
2015-09-30 11:14:31 [root] WARNING: 15
2015-09-30 11:14:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:31 [root] WARNING: horse code set
2015-09-30 11:14:31 [root] WARNING: 16
2015-09-30 11:14:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:31 [root] WARNING: horse code set
2015-09-30 11:14:31 [root] WARNING: 17
2015-09-30 11:14:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:31 [root] WARNING: horse code set
2015-09-30 11:14:31 [root] WARNING: 18
2015-09-30 11:14:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:31 [root] WARNING: horse code set
2015-09-30 11:14:31 [root] WARNING: 19
2015-09-30 11:14:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:31 [root] WARNING: horse code set
2015-09-30 11:14:31 [root] WARNING: 20
2015-09-30 11:14:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:31 [root] WARNING: horse code set
2015-09-30 11:14:31 [root] WARNING: 21
2015-09-30 11:14:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:31 [root] WARNING: horse code set
2015-09-30 11:14:31 [root] WARNING: 22
2015-09-30 11:14:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:31 [root] WARNING: horse code set
2015-09-30 11:14:31 [root] WARNING: 23
2015-09-30 11:14:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:31 [root] WARNING: horse code set
2015-09-30 11:14:31 [root] WARNING: 24
2015-09-30 11:14:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:31 [root] WARNING: horse code set
2015-09-30 11:14:31 [root] WARNING: 25
2015-09-30 11:14:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:31 [root] WARNING: horse code set
2015-09-30 11:14:31 [root] WARNING: 26
2015-09-30 11:14:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:31 [root] WARNING: horse code set
2015-09-30 11:14:31 [root] WARNING: 27
2015-09-30 11:14:31 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 11:14:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:31 [root] WARNING: horse code set
2015-09-30 11:14:31 [root] WARNING: 28
2015-09-30 11:14:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:31 [root] WARNING: horse code set
2015-09-30 11:14:31 [root] WARNING: 29
2015-09-30 11:14:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:31 [root] WARNING: horse code set
2015-09-30 11:14:31 [root] WARNING: 30
2015-09-30 11:14:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:31 [root] WARNING: horse code set
2015-09-30 11:14:31 [root] WARNING: 31
2015-09-30 11:14:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:31 [root] WARNING: horse code set
2015-09-30 11:14:31 [root] WARNING: 32
2015-09-30 11:14:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:31 [root] WARNING: horse code set
2015-09-30 11:14:31 [root] WARNING: 33
2015-09-30 11:14:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:31 [root] WARNING: horse code set
2015-09-30 11:14:31 [root] WARNING: 34
2015-09-30 11:14:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:31 [root] WARNING: horse code set
2015-09-30 11:14:31 [root] WARNING: 35
2015-09-30 11:14:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:31 [root] WARNING: horse code set
2015-09-30 11:14:31 [root] WARNING: 36
2015-09-30 11:14:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:31 [root] WARNING: horse code set
2015-09-30 11:14:31 [root] WARNING: 37
2015-09-30 11:14:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:31 [root] WARNING: horse code set
2015-09-30 11:14:31 [root] WARNING: 38
2015-09-30 11:14:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:31 [root] WARNING: horse code set
2015-09-30 11:14:31 [root] WARNING: 39
2015-09-30 11:14:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:31 [root] WARNING: horse code set
2015-09-30 11:14:31 [root] WARNING: 40
2015-09-30 11:14:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:31 [root] WARNING: horse code set
2015-09-30 11:14:31 [root] WARNING: 41
2015-09-30 11:14:34 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 11:14:34 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:34 [root] WARNING: horse code set
2015-09-30 11:14:34 [root] WARNING: 42
2015-09-30 11:14:34 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:34 [root] WARNING: horse code set
2015-09-30 11:14:34 [root] WARNING: 43
2015-09-30 11:14:34 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:34 [root] WARNING: horse code set
2015-09-30 11:14:34 [root] WARNING: 44
2015-09-30 11:14:34 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:34 [root] WARNING: horse code set
2015-09-30 11:14:34 [root] WARNING: 45
2015-09-30 11:14:34 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:34 [root] WARNING: horse code set
2015-09-30 11:14:34 [root] WARNING: 46
2015-09-30 11:14:34 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:34 [root] WARNING: horse code set
2015-09-30 11:14:34 [root] WARNING: 47
2015-09-30 11:14:34 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:34 [root] WARNING: horse code set
2015-09-30 11:14:34 [root] WARNING: 48
2015-09-30 11:14:34 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:34 [root] WARNING: horse code set
2015-09-30 11:14:34 [root] WARNING: 49
2015-09-30 11:14:34 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:34 [root] WARNING: horse code set
2015-09-30 11:14:34 [root] WARNING: 50
2015-09-30 11:14:34 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:34 [root] WARNING: horse code set
2015-09-30 11:14:34 [root] WARNING: 51
2015-09-30 11:14:34 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:34 [root] WARNING: horse code set
2015-09-30 11:14:34 [root] WARNING: 52
2015-09-30 11:14:34 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 519, in parse_hkjc_racecard
    print("todays draw {}- {}").format(draw_, try_int(draw_))
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 11:14:39 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 11:14:39 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:39 [root] WARNING: horse code set
2015-09-30 11:14:39 [root] WARNING: 53
2015-09-30 11:14:39 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:39 [root] WARNING: horse code set
2015-09-30 11:14:39 [root] WARNING: 54
2015-09-30 11:14:39 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:39 [root] WARNING: horse code set
2015-09-30 11:14:39 [root] WARNING: 55
2015-09-30 11:14:39 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:39 [root] WARNING: horse code set
2015-09-30 11:14:39 [root] WARNING: 56
2015-09-30 11:14:39 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:39 [root] WARNING: horse code set
2015-09-30 11:14:39 [root] WARNING: 57
2015-09-30 11:14:39 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:39 [root] WARNING: horse code set
2015-09-30 11:14:39 [root] WARNING: 58
2015-09-30 11:14:39 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:39 [root] WARNING: horse code set
2015-09-30 11:14:39 [root] WARNING: 59
2015-09-30 11:14:39 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:39 [root] WARNING: horse code set
2015-09-30 11:14:39 [root] WARNING: 60
2015-09-30 11:14:39 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:39 [root] WARNING: horse code set
2015-09-30 11:14:39 [root] WARNING: 61
2015-09-30 11:14:39 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:39 [root] WARNING: horse code set
2015-09-30 11:14:39 [root] WARNING: 62
2015-09-30 11:14:39 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:39 [root] WARNING: horse code set
2015-09-30 11:14:39 [root] WARNING: 63
2015-09-30 11:14:39 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:39 [root] WARNING: horse code set
2015-09-30 11:14:39 [root] WARNING: 64
2015-09-30 11:14:39 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:39 [root] WARNING: horse code set
2015-09-30 11:14:39 [root] WARNING: 65
2015-09-30 11:14:39 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:39 [root] WARNING: horse code set
2015-09-30 11:14:39 [root] WARNING: 66
2015-09-30 11:14:40 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 11:14:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:40 [root] WARNING: horse code set
2015-09-30 11:14:40 [root] WARNING: 67
2015-09-30 11:14:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:40 [root] WARNING: horse code set
2015-09-30 11:14:40 [root] WARNING: 68
2015-09-30 11:14:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:40 [root] WARNING: horse code set
2015-09-30 11:14:40 [root] WARNING: 69
2015-09-30 11:14:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:40 [root] WARNING: horse code set
2015-09-30 11:14:40 [root] WARNING: 70
2015-09-30 11:14:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:40 [root] WARNING: horse code set
2015-09-30 11:14:40 [root] WARNING: 71
2015-09-30 11:14:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:40 [root] WARNING: horse code set
2015-09-30 11:14:40 [root] WARNING: 72
2015-09-30 11:14:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:40 [root] WARNING: horse code set
2015-09-30 11:14:40 [root] WARNING: 73
2015-09-30 11:14:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:40 [root] WARNING: horse code set
2015-09-30 11:14:40 [root] WARNING: 74
2015-09-30 11:14:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:40 [root] WARNING: horse code set
2015-09-30 11:14:40 [root] WARNING: 75
2015-09-30 11:14:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:40 [root] WARNING: horse code set
2015-09-30 11:14:40 [root] WARNING: 76
2015-09-30 11:14:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:40 [root] WARNING: horse code set
2015-09-30 11:14:40 [root] WARNING: 77
2015-09-30 11:14:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:40 [root] WARNING: horse code set
2015-09-30 11:14:40 [root] WARNING: 78
2015-09-30 11:14:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:40 [root] WARNING: horse code set
2015-09-30 11:14:40 [root] WARNING: 79
2015-09-30 11:14:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:40 [root] WARNING: horse code set
2015-09-30 11:14:40 [root] WARNING: 80
2015-09-30 11:14:40 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 11:14:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:40 [root] WARNING: horse code set
2015-09-30 11:14:40 [root] WARNING: 81
2015-09-30 11:14:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:40 [root] WARNING: horse code set
2015-09-30 11:14:40 [root] WARNING: 82
2015-09-30 11:14:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:40 [root] WARNING: horse code set
2015-09-30 11:14:40 [root] WARNING: 83
2015-09-30 11:14:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:40 [root] WARNING: horse code set
2015-09-30 11:14:40 [root] WARNING: 84
2015-09-30 11:14:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:40 [root] WARNING: horse code set
2015-09-30 11:14:40 [root] WARNING: 85
2015-09-30 11:14:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:40 [root] WARNING: horse code set
2015-09-30 11:14:40 [root] WARNING: 86
2015-09-30 11:14:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:40 [root] WARNING: horse code set
2015-09-30 11:14:40 [root] WARNING: 87
2015-09-30 11:14:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:40 [root] WARNING: horse code set
2015-09-30 11:14:40 [root] WARNING: 88
2015-09-30 11:14:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:40 [root] WARNING: horse code set
2015-09-30 11:14:40 [root] WARNING: 89
2015-09-30 11:14:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:40 [root] WARNING: horse code set
2015-09-30 11:14:40 [root] WARNING: 90
2015-09-30 11:14:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:40 [root] WARNING: horse code set
2015-09-30 11:14:40 [root] WARNING: 91
2015-09-30 11:14:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:40 [root] WARNING: horse code set
2015-09-30 11:14:40 [root] WARNING: 92
2015-09-30 11:14:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:40 [root] WARNING: horse code set
2015-09-30 11:14:40 [root] WARNING: 93
2015-09-30 11:14:41 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 11:14:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:41 [root] WARNING: horse code set
2015-09-30 11:14:41 [root] WARNING: 94
2015-09-30 11:14:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:41 [root] WARNING: horse code set
2015-09-30 11:14:41 [root] WARNING: 95
2015-09-30 11:14:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:41 [root] WARNING: horse code set
2015-09-30 11:14:41 [root] WARNING: 96
2015-09-30 11:14:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:41 [root] WARNING: horse code set
2015-09-30 11:14:41 [root] WARNING: 97
2015-09-30 11:14:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:41 [root] WARNING: horse code set
2015-09-30 11:14:41 [root] WARNING: 98
2015-09-30 11:14:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:41 [root] WARNING: horse code set
2015-09-30 11:14:41 [root] WARNING: 99
2015-09-30 11:14:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:41 [root] WARNING: horse code set
2015-09-30 11:14:41 [root] WARNING: 100
2015-09-30 11:14:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:41 [root] WARNING: horse code set
2015-09-30 11:14:41 [root] WARNING: 101
2015-09-30 11:14:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:41 [root] WARNING: horse code set
2015-09-30 11:14:41 [root] WARNING: 102
2015-09-30 11:14:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:41 [root] WARNING: horse code set
2015-09-30 11:14:41 [root] WARNING: 103
2015-09-30 11:14:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:41 [root] WARNING: horse code set
2015-09-30 11:14:41 [root] WARNING: 104
2015-09-30 11:14:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:41 [root] WARNING: horse code set
2015-09-30 11:14:41 [root] WARNING: 105
2015-09-30 11:14:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:41 [root] WARNING: horse code set
2015-09-30 11:14:41 [root] WARNING: 106
2015-09-30 11:14:45 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T363&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:14:45 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:14:45 [root] WARNING: 1
2015-09-30 11:14:45 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T363&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 678, in parse_horse
    hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp),  hkjc_utilities.isbackmarker(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:14:46 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 11:14:46 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:46 [root] WARNING: horse code set
2015-09-30 11:14:46 [root] WARNING: 107
2015-09-30 11:14:46 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:46 [root] WARNING: horse code set
2015-09-30 11:14:46 [root] WARNING: 108
2015-09-30 11:14:46 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:46 [root] WARNING: horse code set
2015-09-30 11:14:46 [root] WARNING: 109
2015-09-30 11:14:46 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:46 [root] WARNING: horse code set
2015-09-30 11:14:46 [root] WARNING: 110
2015-09-30 11:14:46 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:46 [root] WARNING: horse code set
2015-09-30 11:14:46 [root] WARNING: 111
2015-09-30 11:14:46 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:46 [root] WARNING: horse code set
2015-09-30 11:14:46 [root] WARNING: 112
2015-09-30 11:14:46 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:46 [root] WARNING: horse code set
2015-09-30 11:14:46 [root] WARNING: 113
2015-09-30 11:14:46 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:46 [root] WARNING: horse code set
2015-09-30 11:14:46 [root] WARNING: 114
2015-09-30 11:14:46 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:46 [root] WARNING: horse code set
2015-09-30 11:14:46 [root] WARNING: 115
2015-09-30 11:14:46 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:46 [root] WARNING: horse code set
2015-09-30 11:14:46 [root] WARNING: 116
2015-09-30 11:14:46 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:46 [root] WARNING: horse code set
2015-09-30 11:14:46 [root] WARNING: 117
2015-09-30 11:14:46 [root] WARNING: -------------------------------------------------
2015-09-30 11:14:46 [root] WARNING: horse code set
2015-09-30 11:14:46 [root] WARNING: 118
2015-09-30 11:14:50 [scrapy] INFO: Crawled 14 pages (at 14 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 11:14:54 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T366&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:14:54 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:14:54 [root] WARNING: 2
2015-09-30 11:14:54 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T366&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 678, in parse_horse
    hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp),  hkjc_utilities.isbackmarker(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:14:54 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T199&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:14:54 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:14:54 [root] WARNING: 3
2015-09-30 11:14:54 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T199&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 678, in parse_horse
    hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp),  hkjc_utilities.isbackmarker(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:14:56 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P428&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:14:56 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:14:56 [root] WARNING: 4
2015-09-30 11:14:56 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P428&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 678, in parse_horse
    hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp),  hkjc_utilities.isbackmarker(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:14:58 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:14:58 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:14:58 [root] WARNING: 5
2015-09-30 11:14:58 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 678, in parse_horse
    hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp),  hkjc_utilities.isbackmarker(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:15:01 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T217&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:15:01 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:15:01 [root] WARNING: 6
2015-09-30 11:15:01 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T217&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 678, in parse_horse
    hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp),  hkjc_utilities.isbackmarker(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:15:03 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S449&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:15:03 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:15:03 [root] WARNING: 7
2015-09-30 11:15:03 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S449&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 678, in parse_horse
    hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp),  hkjc_utilities.isbackmarker(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:15:07 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N121&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:15:07 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:15:07 [root] WARNING: 8
2015-09-30 11:15:07 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N121&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 678, in parse_horse
    hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp),  hkjc_utilities.isbackmarker(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:15:08 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P281&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:15:08 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:15:08 [root] WARNING: 9
2015-09-30 11:15:09 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P281&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 678, in parse_horse
    hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp),  hkjc_utilities.isbackmarker(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:15:12 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T285&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 11:15:12 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:15:12 [root] WARNING: 10
2015-09-30 11:15:12 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T285&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 678, in parse_horse
    hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp),  hkjc_utilities.isbackmarker(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:15:15 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N217&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:15:16 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:15:16 [root] WARNING: 11
2015-09-30 11:15:16 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N217&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 678, in parse_horse
    hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp),  hkjc_utilities.isbackmarker(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:15:27 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T045&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 11:15:27 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:15:27 [root] WARNING: 12
2015-09-30 11:15:27 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T045&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 678, in parse_horse
    hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp),  hkjc_utilities.isbackmarker(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:15:30 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S189&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:15:30 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:15:30 [root] WARNING: 13
2015-09-30 11:15:30 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S189&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 678, in parse_horse
    hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp),  hkjc_utilities.isbackmarker(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:15:36 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N090&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 11:15:36 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:15:36 [root] WARNING: 14
2015-09-30 11:15:37 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N090&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 678, in parse_horse
    hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp),  hkjc_utilities.isbackmarker(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:15:45 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T081&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 11:15:45 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:15:45 [root] WARNING: 15
2015-09-30 11:15:45 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T081&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 678, in parse_horse
    hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp),  hkjc_utilities.isbackmarker(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:15:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T334&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 11:15:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:15:46 [root] WARNING: 16
2015-09-30 11:15:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T334&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 678, in parse_horse
    hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp),  hkjc_utilities.isbackmarker(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:15:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P269&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:15:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:15:47 [root] WARNING: 17
2015-09-30 11:15:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P269&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 678, in parse_horse
    hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp),  hkjc_utilities.isbackmarker(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:15:48 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P440&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:15:48 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:15:48 [root] WARNING: 18
2015-09-30 11:15:48 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P440&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 678, in parse_horse
    hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp),  hkjc_utilities.isbackmarker(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:15:50 [scrapy] INFO: Crawled 31 pages (at 17 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 11:15:53 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P308&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:15:53 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:15:53 [root] WARNING: 19
2015-09-30 11:15:53 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P308&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 678, in parse_horse
    hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp),  hkjc_utilities.isbackmarker(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:15:57 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T029&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 11:15:57 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:15:57 [root] WARNING: 20
2015-09-30 11:15:57 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T029&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 756, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 11:16:00 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S142&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 11:16:00 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:16:00 [root] WARNING: 21
2015-09-30 11:16:00 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S142&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 678, in parse_horse
    hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp),  hkjc_utilities.isbackmarker(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:16:03 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N218&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 11:16:03 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:16:03 [root] WARNING: 22
2015-09-30 11:16:04 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N218&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 678, in parse_horse
    hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp),  hkjc_utilities.isbackmarker(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 77, in pasthorsessecl1
    secl2 = rplist[-2]
IndexError: list index out of range
2015-09-30 11:16:06 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T283&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 11:16:06 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:16:06 [root] WARNING: 23
2015-09-30 11:16:06 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T283&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 678, in parse_horse
    hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp),  hkjc_utilities.isbackmarker(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:16:07 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T073&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 11:16:07 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:16:07 [root] WARNING: 24
2015-09-30 11:16:07 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T073&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 678, in parse_horse
    hkjc_utilities.pasthorsessecl1(_tmp), hkjc_utilities.isonpace(_tmp),  hkjc_utilities.isbackmarker(_tmp) )
  File "/home/vmac/PY/simpleraceday/simpleraceday/hkjc_utilities.py", line 76, in pasthorsessecl1
    secl1 = rplist[-1]
IndexError: list index out of range
2015-09-30 11:16:12 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S356&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 11:16:12 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:16:12 [root] WARNING: 25
2015-09-30 11:16:12 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S356&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 756, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 11:16:17 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 11:16:17 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 11:16:17 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 11:16:17 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 11:16:17 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 11:16:17 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 11:16:17 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 11:16:17 [scrapy] INFO: Spider opened
2015-09-30 11:16:17 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 11:16:17 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6028
2015-09-30 11:16:20 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 11:16:22 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 11:16:30 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 11:16:34 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 11:16:52 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 11:16:52 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 11:16:59 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 11:16:59 [root] WARNING: -------------------------------------------------
2015-09-30 11:16:59 [root] WARNING: horse code set
2015-09-30 11:16:59 [root] WARNING: 1
2015-09-30 11:16:59 [root] WARNING: -------------------------------------------------
2015-09-30 11:16:59 [root] WARNING: horse code set
2015-09-30 11:16:59 [root] WARNING: 2
2015-09-30 11:16:59 [root] WARNING: -------------------------------------------------
2015-09-30 11:16:59 [root] WARNING: horse code set
2015-09-30 11:16:59 [root] WARNING: 3
2015-09-30 11:16:59 [root] WARNING: -------------------------------------------------
2015-09-30 11:16:59 [root] WARNING: horse code set
2015-09-30 11:16:59 [root] WARNING: 4
2015-09-30 11:16:59 [root] WARNING: -------------------------------------------------
2015-09-30 11:16:59 [root] WARNING: horse code set
2015-09-30 11:16:59 [root] WARNING: 5
2015-09-30 11:16:59 [root] WARNING: -------------------------------------------------
2015-09-30 11:16:59 [root] WARNING: horse code set
2015-09-30 11:16:59 [root] WARNING: 6
2015-09-30 11:16:59 [root] WARNING: -------------------------------------------------
2015-09-30 11:16:59 [root] WARNING: horse code set
2015-09-30 11:16:59 [root] WARNING: 7
2015-09-30 11:16:59 [root] WARNING: -------------------------------------------------
2015-09-30 11:16:59 [root] WARNING: horse code set
2015-09-30 11:16:59 [root] WARNING: 8
2015-09-30 11:16:59 [root] WARNING: -------------------------------------------------
2015-09-30 11:16:59 [root] WARNING: horse code set
2015-09-30 11:16:59 [root] WARNING: 9
2015-09-30 11:16:59 [root] WARNING: -------------------------------------------------
2015-09-30 11:16:59 [root] WARNING: horse code set
2015-09-30 11:16:59 [root] WARNING: 10
2015-09-30 11:16:59 [root] WARNING: -------------------------------------------------
2015-09-30 11:16:59 [root] WARNING: horse code set
2015-09-30 11:16:59 [root] WARNING: 11
2015-09-30 11:16:59 [root] WARNING: -------------------------------------------------
2015-09-30 11:16:59 [root] WARNING: horse code set
2015-09-30 11:16:59 [root] WARNING: 12
2015-09-30 11:16:59 [root] WARNING: -------------------------------------------------
2015-09-30 11:16:59 [root] WARNING: horse code set
2015-09-30 11:16:59 [root] WARNING: 13
2015-09-30 11:17:00 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:00 [root] WARNING: horse code set
2015-09-30 11:17:00 [root] WARNING: 14
2015-09-30 11:17:12 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 11:17:12 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:12 [root] WARNING: horse code set
2015-09-30 11:17:12 [root] WARNING: 15
2015-09-30 11:17:12 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:12 [root] WARNING: horse code set
2015-09-30 11:17:12 [root] WARNING: 16
2015-09-30 11:17:12 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:12 [root] WARNING: horse code set
2015-09-30 11:17:12 [root] WARNING: 17
2015-09-30 11:17:12 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:12 [root] WARNING: horse code set
2015-09-30 11:17:12 [root] WARNING: 18
2015-09-30 11:17:12 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:12 [root] WARNING: horse code set
2015-09-30 11:17:12 [root] WARNING: 19
2015-09-30 11:17:12 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:12 [root] WARNING: horse code set
2015-09-30 11:17:12 [root] WARNING: 20
2015-09-30 11:17:12 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:12 [root] WARNING: horse code set
2015-09-30 11:17:12 [root] WARNING: 21
2015-09-30 11:17:12 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:12 [root] WARNING: horse code set
2015-09-30 11:17:12 [root] WARNING: 22
2015-09-30 11:17:12 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:12 [root] WARNING: horse code set
2015-09-30 11:17:12 [root] WARNING: 23
2015-09-30 11:17:12 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:12 [root] WARNING: horse code set
2015-09-30 11:17:12 [root] WARNING: 24
2015-09-30 11:17:12 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:12 [root] WARNING: horse code set
2015-09-30 11:17:12 [root] WARNING: 25
2015-09-30 11:17:12 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:12 [root] WARNING: horse code set
2015-09-30 11:17:12 [root] WARNING: 26
2015-09-30 11:17:12 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:12 [root] WARNING: horse code set
2015-09-30 11:17:12 [root] WARNING: 27
2015-09-30 11:17:12 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:12 [root] WARNING: horse code set
2015-09-30 11:17:12 [root] WARNING: 28
2015-09-30 11:17:16 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 11:17:17 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:17 [root] WARNING: horse code set
2015-09-30 11:17:17 [root] WARNING: 29
2015-09-30 11:17:17 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:17 [root] WARNING: horse code set
2015-09-30 11:17:17 [root] WARNING: 30
2015-09-30 11:17:17 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:17 [root] WARNING: horse code set
2015-09-30 11:17:17 [root] WARNING: 31
2015-09-30 11:17:17 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:17 [root] WARNING: horse code set
2015-09-30 11:17:17 [root] WARNING: 32
2015-09-30 11:17:17 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:17 [root] WARNING: horse code set
2015-09-30 11:17:17 [root] WARNING: 33
2015-09-30 11:17:17 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:17 [root] WARNING: horse code set
2015-09-30 11:17:17 [root] WARNING: 34
2015-09-30 11:17:17 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:17 [root] WARNING: horse code set
2015-09-30 11:17:17 [root] WARNING: 35
2015-09-30 11:17:17 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:17 [root] WARNING: horse code set
2015-09-30 11:17:17 [root] WARNING: 36
2015-09-30 11:17:17 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:17 [root] WARNING: horse code set
2015-09-30 11:17:17 [root] WARNING: 37
2015-09-30 11:17:17 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:17 [root] WARNING: horse code set
2015-09-30 11:17:17 [root] WARNING: 38
2015-09-30 11:17:17 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:17 [root] WARNING: horse code set
2015-09-30 11:17:17 [root] WARNING: 39
2015-09-30 11:17:17 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:17 [root] WARNING: horse code set
2015-09-30 11:17:17 [root] WARNING: 40
2015-09-30 11:17:17 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:17 [root] WARNING: horse code set
2015-09-30 11:17:17 [root] WARNING: 41
2015-09-30 11:17:17 [scrapy] INFO: Crawled 7 pages (at 7 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 11:17:22 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 11:17:22 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:22 [root] WARNING: horse code set
2015-09-30 11:17:22 [root] WARNING: 42
2015-09-30 11:17:22 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:22 [root] WARNING: horse code set
2015-09-30 11:17:22 [root] WARNING: 43
2015-09-30 11:17:22 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:22 [root] WARNING: horse code set
2015-09-30 11:17:22 [root] WARNING: 44
2015-09-30 11:17:22 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:22 [root] WARNING: horse code set
2015-09-30 11:17:22 [root] WARNING: 45
2015-09-30 11:17:22 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:22 [root] WARNING: horse code set
2015-09-30 11:17:22 [root] WARNING: 46
2015-09-30 11:17:22 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:22 [root] WARNING: horse code set
2015-09-30 11:17:22 [root] WARNING: 47
2015-09-30 11:17:22 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:22 [root] WARNING: horse code set
2015-09-30 11:17:22 [root] WARNING: 48
2015-09-30 11:17:22 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:22 [root] WARNING: horse code set
2015-09-30 11:17:22 [root] WARNING: 49
2015-09-30 11:17:22 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:22 [root] WARNING: horse code set
2015-09-30 11:17:22 [root] WARNING: 50
2015-09-30 11:17:22 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:22 [root] WARNING: horse code set
2015-09-30 11:17:22 [root] WARNING: 51
2015-09-30 11:17:22 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:22 [root] WARNING: horse code set
2015-09-30 11:17:22 [root] WARNING: 52
2015-09-30 11:17:22 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:22 [root] WARNING: horse code set
2015-09-30 11:17:22 [root] WARNING: 53
2015-09-30 11:17:22 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:22 [root] WARNING: horse code set
2015-09-30 11:17:22 [root] WARNING: 54
2015-09-30 11:17:22 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:22 [root] WARNING: horse code set
2015-09-30 11:17:22 [root] WARNING: 55
2015-09-30 11:17:22 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 11:17:23 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:23 [root] WARNING: horse code set
2015-09-30 11:17:23 [root] WARNING: 56
2015-09-30 11:17:23 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:23 [root] WARNING: horse code set
2015-09-30 11:17:23 [root] WARNING: 57
2015-09-30 11:17:23 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:23 [root] WARNING: horse code set
2015-09-30 11:17:23 [root] WARNING: 58
2015-09-30 11:17:23 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:23 [root] WARNING: horse code set
2015-09-30 11:17:23 [root] WARNING: 59
2015-09-30 11:17:23 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:23 [root] WARNING: horse code set
2015-09-30 11:17:23 [root] WARNING: 60
2015-09-30 11:17:23 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:23 [root] WARNING: horse code set
2015-09-30 11:17:23 [root] WARNING: 61
2015-09-30 11:17:23 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:23 [root] WARNING: horse code set
2015-09-30 11:17:23 [root] WARNING: 62
2015-09-30 11:17:23 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:23 [root] WARNING: horse code set
2015-09-30 11:17:23 [root] WARNING: 63
2015-09-30 11:17:23 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:23 [root] WARNING: horse code set
2015-09-30 11:17:23 [root] WARNING: 64
2015-09-30 11:17:23 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:23 [root] WARNING: horse code set
2015-09-30 11:17:23 [root] WARNING: 65
2015-09-30 11:17:23 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:23 [root] WARNING: horse code set
2015-09-30 11:17:23 [root] WARNING: 66
2015-09-30 11:17:23 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 519, in parse_hkjc_racecard
    print("todays draw {}- {}").format(draw_, try_int(draw_))
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 11:17:33 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 11:17:33 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:33 [root] WARNING: horse code set
2015-09-30 11:17:33 [root] WARNING: 67
2015-09-30 11:17:34 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:34 [root] WARNING: horse code set
2015-09-30 11:17:34 [root] WARNING: 68
2015-09-30 11:17:34 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:34 [root] WARNING: horse code set
2015-09-30 11:17:34 [root] WARNING: 69
2015-09-30 11:17:34 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:34 [root] WARNING: horse code set
2015-09-30 11:17:34 [root] WARNING: 70
2015-09-30 11:17:34 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:34 [root] WARNING: horse code set
2015-09-30 11:17:34 [root] WARNING: 71
2015-09-30 11:17:34 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:34 [root] WARNING: horse code set
2015-09-30 11:17:34 [root] WARNING: 72
2015-09-30 11:17:34 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:34 [root] WARNING: horse code set
2015-09-30 11:17:34 [root] WARNING: 73
2015-09-30 11:17:34 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:34 [root] WARNING: horse code set
2015-09-30 11:17:34 [root] WARNING: 74
2015-09-30 11:17:34 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:34 [root] WARNING: horse code set
2015-09-30 11:17:34 [root] WARNING: 75
2015-09-30 11:17:34 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:34 [root] WARNING: horse code set
2015-09-30 11:17:34 [root] WARNING: 76
2015-09-30 11:17:34 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:34 [root] WARNING: horse code set
2015-09-30 11:17:34 [root] WARNING: 77
2015-09-30 11:17:34 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:34 [root] WARNING: horse code set
2015-09-30 11:17:34 [root] WARNING: 78
2015-09-30 11:17:38 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 11:17:38 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:38 [root] WARNING: horse code set
2015-09-30 11:17:38 [root] WARNING: 79
2015-09-30 11:17:38 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:38 [root] WARNING: horse code set
2015-09-30 11:17:38 [root] WARNING: 80
2015-09-30 11:17:38 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:38 [root] WARNING: horse code set
2015-09-30 11:17:38 [root] WARNING: 81
2015-09-30 11:17:38 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:38 [root] WARNING: horse code set
2015-09-30 11:17:38 [root] WARNING: 82
2015-09-30 11:17:38 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:38 [root] WARNING: horse code set
2015-09-30 11:17:38 [root] WARNING: 83
2015-09-30 11:17:38 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:38 [root] WARNING: horse code set
2015-09-30 11:17:38 [root] WARNING: 84
2015-09-30 11:17:38 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:38 [root] WARNING: horse code set
2015-09-30 11:17:38 [root] WARNING: 85
2015-09-30 11:17:38 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:38 [root] WARNING: horse code set
2015-09-30 11:17:38 [root] WARNING: 86
2015-09-30 11:17:38 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:38 [root] WARNING: horse code set
2015-09-30 11:17:38 [root] WARNING: 87
2015-09-30 11:17:38 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:38 [root] WARNING: horse code set
2015-09-30 11:17:38 [root] WARNING: 88
2015-09-30 11:17:38 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:38 [root] WARNING: horse code set
2015-09-30 11:17:38 [root] WARNING: 89
2015-09-30 11:17:38 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:38 [root] WARNING: horse code set
2015-09-30 11:17:38 [root] WARNING: 90
2015-09-30 11:17:38 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:38 [root] WARNING: horse code set
2015-09-30 11:17:38 [root] WARNING: 91
2015-09-30 11:17:40 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 11:17:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:40 [root] WARNING: horse code set
2015-09-30 11:17:40 [root] WARNING: 92
2015-09-30 11:17:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:40 [root] WARNING: horse code set
2015-09-30 11:17:40 [root] WARNING: 93
2015-09-30 11:17:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:40 [root] WARNING: horse code set
2015-09-30 11:17:40 [root] WARNING: 94
2015-09-30 11:17:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:40 [root] WARNING: horse code set
2015-09-30 11:17:40 [root] WARNING: 95
2015-09-30 11:17:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:40 [root] WARNING: horse code set
2015-09-30 11:17:40 [root] WARNING: 96
2015-09-30 11:17:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:40 [root] WARNING: horse code set
2015-09-30 11:17:40 [root] WARNING: 97
2015-09-30 11:17:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:40 [root] WARNING: horse code set
2015-09-30 11:17:40 [root] WARNING: 98
2015-09-30 11:17:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:40 [root] WARNING: horse code set
2015-09-30 11:17:40 [root] WARNING: 99
2015-09-30 11:17:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:40 [root] WARNING: horse code set
2015-09-30 11:17:40 [root] WARNING: 100
2015-09-30 11:17:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:40 [root] WARNING: horse code set
2015-09-30 11:17:40 [root] WARNING: 101
2015-09-30 11:17:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:40 [root] WARNING: horse code set
2015-09-30 11:17:40 [root] WARNING: 102
2015-09-30 11:17:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:40 [root] WARNING: horse code set
2015-09-30 11:17:40 [root] WARNING: 103
2015-09-30 11:17:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:40 [root] WARNING: horse code set
2015-09-30 11:17:40 [root] WARNING: 104
2015-09-30 11:17:40 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:40 [root] WARNING: horse code set
2015-09-30 11:17:40 [root] WARNING: 105
2015-09-30 11:17:41 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S298&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 11:17:41 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:17:41 [root] WARNING: 1
2015-09-30 11:17:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S298&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:17:41 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 11:17:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:41 [root] WARNING: horse code set
2015-09-30 11:17:41 [root] WARNING: 106
2015-09-30 11:17:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:41 [root] WARNING: horse code set
2015-09-30 11:17:41 [root] WARNING: 107
2015-09-30 11:17:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:41 [root] WARNING: horse code set
2015-09-30 11:17:41 [root] WARNING: 108
2015-09-30 11:17:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:41 [root] WARNING: horse code set
2015-09-30 11:17:41 [root] WARNING: 109
2015-09-30 11:17:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:41 [root] WARNING: horse code set
2015-09-30 11:17:41 [root] WARNING: 110
2015-09-30 11:17:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:41 [root] WARNING: horse code set
2015-09-30 11:17:41 [root] WARNING: 111
2015-09-30 11:17:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:41 [root] WARNING: horse code set
2015-09-30 11:17:41 [root] WARNING: 112
2015-09-30 11:17:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:41 [root] WARNING: horse code set
2015-09-30 11:17:41 [root] WARNING: 113
2015-09-30 11:17:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:41 [root] WARNING: horse code set
2015-09-30 11:17:41 [root] WARNING: 114
2015-09-30 11:17:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:41 [root] WARNING: horse code set
2015-09-30 11:17:41 [root] WARNING: 115
2015-09-30 11:17:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:41 [root] WARNING: horse code set
2015-09-30 11:17:41 [root] WARNING: 116
2015-09-30 11:17:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:41 [root] WARNING: horse code set
2015-09-30 11:17:41 [root] WARNING: 117
2015-09-30 11:17:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:17:41 [root] WARNING: horse code set
2015-09-30 11:17:41 [root] WARNING: 118
2015-09-30 11:17:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 11:17:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:17:47 [root] WARNING: 2
2015-09-30 11:17:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:17:50 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T117&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 11:17:50 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:17:50 [root] WARNING: 3
2015-09-30 11:17:50 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T117&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:18:00 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T217&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:18:01 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:18:01 [root] WARNING: 4
2015-09-30 11:18:01 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T217&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:18:06 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P446&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 11:18:07 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:18:07 [root] WARNING: 5
2015-09-30 11:18:07 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P446&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:18:12 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S194&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 11:18:12 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:18:12 [root] WARNING: 6
2015-09-30 11:18:12 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S194&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:18:17 [scrapy] INFO: Crawled 19 pages (at 12 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 11:18:18 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S189&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:18:18 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:18:18 [root] WARNING: 7
2015-09-30 11:18:18 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S189&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:18:20 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T285&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 11:18:20 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:18:20 [root] WARNING: 8
2015-09-30 11:18:20 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T285&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:18:21 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S266&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 11:18:21 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:18:21 [root] WARNING: 9
2015-09-30 11:18:21 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S266&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:18:30 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S142&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 11:18:30 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:18:30 [root] WARNING: 10
2015-09-30 11:18:30 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S142&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:18:33 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P308&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:18:33 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:18:33 [root] WARNING: 11
2015-09-30 11:18:33 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P308&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:18:34 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N300&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 11:18:34 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:18:34 [root] WARNING: 12
2015-09-30 11:18:35 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N300&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:18:45 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P412&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 11:18:45 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:18:45 [root] WARNING: 13
2015-09-30 11:18:45 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P412&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:18:45 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N217&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:18:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:18:46 [root] WARNING: 14
2015-09-30 11:18:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N217&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:18:50 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P364&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 11:18:50 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:18:50 [root] WARNING: 15
2015-09-30 11:18:50 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P364&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:18:57 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N090&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 11:18:57 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:18:57 [root] WARNING: 16
2015-09-30 11:18:58 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N090&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:19:01 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P167&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:19:01 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:19:01 [root] WARNING: 17
2015-09-30 11:19:01 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P167&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:19:14 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P017&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:19:14 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:19:14 [root] WARNING: 18
2015-09-30 11:19:14 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P017&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:19:16 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P227&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:19:16 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:19:16 [root] WARNING: 19
2015-09-30 11:19:16 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P227&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:19:17 [scrapy] INFO: Crawled 32 pages (at 13 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 11:19:18 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S290&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:19:18 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:19:18 [root] WARNING: 20
2015-09-30 11:19:18 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S290&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:19:22 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P353&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:19:23 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:19:23 [root] WARNING: 21
2015-09-30 11:19:23 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P353&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:19:26 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P269&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:19:26 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:19:26 [root] WARNING: 22
2015-09-30 11:19:26 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P269&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:19:29 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S006&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:19:29 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:19:29 [root] WARNING: 23
2015-09-30 11:19:29 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S006&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:19:33 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S423&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:19:33 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:19:33 [root] WARNING: 24
2015-09-30 11:19:33 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S423&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:19:39 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P072&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:19:39 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:19:39 [root] WARNING: 25
2015-09-30 11:19:39 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P072&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:19:41 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S395&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 11:19:41 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:19:41 [root] WARNING: 26
2015-09-30 11:19:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S395&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:19:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N331&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:19:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:19:46 [root] WARNING: 27
2015-09-30 11:19:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N331&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:19:48 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N218&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 11:19:48 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:19:48 [root] WARNING: 28
2015-09-30 11:19:49 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N218&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:20:01 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T105&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 11:20:01 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:20:01 [root] WARNING: 29
2015-09-30 11:20:01 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T105&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:20:09 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M327&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 11:20:09 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:20:09 [root] WARNING: 30
2015-09-30 11:20:09 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M327&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:20:16 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T230&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 11:20:16 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:20:16 [root] WARNING: 31
2015-09-30 11:20:16 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T230&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:20:17 [scrapy] INFO: Crawled 44 pages (at 12 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 11:20:19 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N146&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:20:19 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:20:19 [root] WARNING: 32
2015-09-30 11:20:20 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N146&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:20:21 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P046&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 11:20:21 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:20:21 [root] WARNING: 33
2015-09-30 11:20:22 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P046&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:20:24 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S113&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 11:20:24 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M152&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:20:24 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:20:24 [root] WARNING: 34
2015-09-30 11:20:24 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S113&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:20:24 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:20:24 [root] WARNING: 35
2015-09-30 11:20:25 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M152&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:20:29 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P354&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
2015-09-30 11:20:29 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:20:29 [root] WARNING: 36
2015-09-30 11:20:29 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P354&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:20:49 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S417&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 11:20:49 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:20:49 [root] WARNING: 37
2015-09-30 11:20:49 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S417&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:20:53 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P436&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 11:20:53 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:20:53 [root] WARNING: 38
2015-09-30 11:20:53 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P436&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:20:56 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M401&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 11:20:56 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:20:56 [root] WARNING: 39
2015-09-30 11:20:56 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M401&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:21:02 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T027&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:21:03 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:21:03 [root] WARNING: 40
2015-09-30 11:21:03 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T027&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:21:05 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N416&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 11:21:05 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:21:05 [root] WARNING: 41
2015-09-30 11:21:05 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N416&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:21:08 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S431&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:21:08 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:21:08 [root] WARNING: 42
2015-09-30 11:21:08 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S431&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:21:08 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 11:21:08 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:21:08 [root] WARNING: 43
2015-09-30 11:21:08 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P376&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:21:13 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
2015-09-30 11:21:13 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:21:13 [root] WARNING: 44
2015-09-30 11:21:14 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M193&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:21:14 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T345&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:21:14 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:21:14 [root] WARNING: 45
2015-09-30 11:21:14 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T345&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:21:15 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T385&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:21:15 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:21:15 [root] WARNING: 46
2015-09-30 11:21:15 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T385&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:21:17 [scrapy] INFO: Crawled 59 pages (at 15 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 11:21:18 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P440&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:21:18 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:21:18 [root] WARNING: 47
2015-09-30 11:21:18 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P440&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:21:20 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T262&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:21:20 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:21:20 [root] WARNING: 48
2015-09-30 11:21:20 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T262&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:21:22 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P299&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:21:22 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:21:22 [root] WARNING: 49
2015-09-30 11:21:22 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P299&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:21:26 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T155&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:21:26 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:21:26 [root] WARNING: 50
2015-09-30 11:21:26 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T155&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:21:30 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P343&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:21:30 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:21:30 [root] WARNING: 51
2015-09-30 11:21:30 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P343&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:21:37 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T357&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:21:37 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:21:37 [root] WARNING: 52
2015-09-30 11:21:37 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T357&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:21:40 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T334&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 11:21:40 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:21:40 [root] WARNING: 53
2015-09-30 11:21:40 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T334&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:21:42 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P383&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:21:42 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:21:42 [root] WARNING: 54
2015-09-30 11:21:43 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P383&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:21:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T023&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 11:21:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:21:46 [root] WARNING: 55
2015-09-30 11:21:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T023&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:21:50 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T081&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 11:21:50 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:21:50 [root] WARNING: 56
2015-09-30 11:21:50 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T081&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:21:52 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T045&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 11:21:52 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:21:52 [root] WARNING: 57
2015-09-30 11:21:52 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T045&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:21:58 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S356&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 11:21:58 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:21:58 [root] WARNING: 58
2015-09-30 11:21:58 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S356&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 756, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 11:22:04 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T283&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 11:22:04 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:22:04 [root] WARNING: 59
2015-09-30 11:22:04 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T283&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:22:17 [scrapy] INFO: Crawled 72 pages (at 13 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 11:22:19 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T029&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 11:22:19 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:22:19 [root] WARNING: 60
2015-09-30 11:22:19 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T029&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 756, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 11:22:30 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P239&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
2015-09-30 11:22:30 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:22:30 [root] WARNING: 61
2015-09-30 11:22:30 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P239&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:22:49 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P214&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 11:22:49 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:22:49 [root] WARNING: 62
2015-09-30 11:22:49 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P214&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:22:53 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T073&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 11:22:53 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:22:53 [root] WARNING: 63
2015-09-30 11:22:53 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T073&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:22:55 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T293&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 11:22:55 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:22:55 [root] WARNING: 64
2015-09-30 11:22:55 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T293&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 756, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 11:23:01 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N265&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 11:23:01 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:23:01 [root] WARNING: 65
2015-09-30 11:23:02 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N265&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:23:02 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T300&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 11:23:02 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:23:02 [root] WARNING: 66
2015-09-30 11:23:02 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T300&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:23:13 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S191&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 11:23:13 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:23:13 [root] WARNING: 67
2015-09-30 11:23:13 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S191&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:23:13 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T365&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 11:23:13 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:23:13 [root] WARNING: 68
2015-09-30 11:23:13 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T365&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:23:17 [scrapy] INFO: Crawled 81 pages (at 9 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 11:23:18 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N360&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 11:23:18 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:23:18 [root] WARNING: 69
2015-09-30 11:23:18 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N360&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:23:28 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T028&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:23:28 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:23:28 [root] WARNING: 70
2015-09-30 11:23:28 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T028&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:23:36 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N115&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:23:36 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:23:36 [root] WARNING: 71
2015-09-30 11:23:36 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N115&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:23:40 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S370&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:23:41 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:23:41 [root] WARNING: 72
2015-09-30 11:23:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S370&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:23:41 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P225&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 11:23:41 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:23:41 [root] WARNING: 73
2015-09-30 11:23:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P225&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:23:41 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S070&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:23:41 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:23:41 [root] WARNING: 74
2015-09-30 11:23:41 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S070&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:23:42 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P444&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
2015-09-30 11:23:42 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:23:42 [root] WARNING: 75
2015-09-30 11:23:42 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P444&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:23:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S378&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:23:46 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:23:46 [root] WARNING: 76
2015-09-30 11:23:46 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S378&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:23:46 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M325&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 11:23:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:23:47 [root] WARNING: 77
2015-09-30 11:23:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M325&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:23:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P267&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 11:23:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:23:47 [root] WARNING: 78
2015-09-30 11:23:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P267&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:23:52 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S116&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:23:52 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:23:52 [root] WARNING: 79
2015-09-30 11:23:52 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S116&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:23:53 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M172&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
2015-09-30 11:23:53 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:23:53 [root] WARNING: 80
2015-09-30 11:23:54 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=M172&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:23:58 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T184&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:23:58 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:23:58 [root] WARNING: 81
2015-09-30 11:23:58 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T184&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:23:58 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T065&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:23:58 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:23:58 [root] WARNING: 82
2015-09-30 11:23:58 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T065&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:24:00 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T212&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:24:00 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:24:00 [root] WARNING: 83
2015-09-30 11:24:00 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T212&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:24:04 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S234&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:24:04 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:24:04 [root] WARNING: 84
2015-09-30 11:24:04 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S234&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:24:15 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T271&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:24:15 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:24:15 [root] WARNING: 85
2015-09-30 11:24:15 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T271&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:24:17 [scrapy] INFO: Crawled 98 pages (at 17 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 11:24:21 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T190&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:24:21 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:24:21 [root] WARNING: 86
2015-09-30 11:24:21 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T190&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:24:24 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S387&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:24:24 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:24:24 [root] WARNING: 87
2015-09-30 11:24:24 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S387&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:24:26 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T158&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:24:26 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:24:26 [root] WARNING: 88
2015-09-30 11:24:26 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T158&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:24:30 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T059&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:24:30 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:24:30 [root] WARNING: 89
2015-09-30 11:24:30 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T059&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:24:32 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P351&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:24:33 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:24:33 [root] WARNING: 90
2015-09-30 11:24:33 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P351&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:24:34 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P062&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:24:34 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:24:34 [root] WARNING: 91
2015-09-30 11:24:35 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P062&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:24:42 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T382&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:24:42 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T373&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:24:42 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:24:42 [root] WARNING: 92
2015-09-30 11:24:42 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T382&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:24:42 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:24:42 [root] WARNING: 93
2015-09-30 11:24:42 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T373&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 756, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 11:24:47 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T350&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:24:47 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:24:47 [root] WARNING: 94
2015-09-30 11:24:47 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T350&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 756, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 11:24:56 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T284&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:24:56 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:24:56 [root] WARNING: 95
2015-09-30 11:24:56 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T284&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 756, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 11:24:56 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S011&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:24:56 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:24:56 [root] WARNING: 96
2015-09-30 11:24:56 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S011&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:25:07 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T366&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:25:07 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:25:07 [root] WARNING: 97
2015-09-30 11:25:07 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T366&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:25:10 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S014&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:25:10 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:25:10 [root] WARNING: 98
2015-09-30 11:25:10 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S014&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:25:15 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T245&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
2015-09-30 11:25:16 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:25:16 [root] WARNING: 99
2015-09-30 11:25:16 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T245&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:25:17 [scrapy] INFO: Crawled 112 pages (at 14 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 11:25:20 [scrapy] DEBUG: Retrying <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P281&Option=1#htop> (failed 1 times): [<twisted.python.failure.Failure <class 'twisted.internet.error.ConnectionLost'>>, <twisted.python.failure.Failure <class 'twisted.web.http._DataLoss'>>]
2015-09-30 11:25:21 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S449&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:25:22 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:25:22 [root] WARNING: 100
2015-09-30 11:25:22 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S449&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:25:23 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N375&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:25:23 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:25:23 [root] WARNING: 101
2015-09-30 11:25:24 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N375&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:25:26 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T199&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:25:26 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:25:26 [root] WARNING: 102
2015-09-30 11:25:26 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T199&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:25:36 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P053&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:25:36 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:25:36 [root] WARNING: 103
2015-09-30 11:25:36 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P053&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:25:45 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N438&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:25:45 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:25:45 [root] WARNING: 104
2015-09-30 11:25:45 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N438&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:25:45 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T236&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:25:45 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:25:45 [root] WARNING: 105
2015-09-30 11:25:45 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T236&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:25:51 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N121&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:25:51 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:25:51 [root] WARNING: 106
2015-09-30 11:25:51 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N121&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:25:51 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P428&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:25:51 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:25:51 [root] WARNING: 107
2015-09-30 11:25:51 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P428&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:25:53 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T363&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:25:53 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:25:53 [root] WARNING: 108
2015-09-30 11:25:53 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T363&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:25:55 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T375&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 11:25:55 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:25:55 [root] WARNING: 109
2015-09-30 11:25:55 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T375&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 756, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 11:25:56 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T391&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 11:25:56 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:25:56 [root] WARNING: 110
2015-09-30 11:25:56 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=T391&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 756, in parse_horse
    roi = (total_winodds/float(total_runs))*100.0
ZeroDivisionError: float division by zero
2015-09-30 11:26:00 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S263&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 11:26:00 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:26:00 [root] WARNING: 111
2015-09-30 11:26:00 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S263&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:26:17 [scrapy] INFO: Crawled 124 pages (at 12 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 11:26:22 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S362&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 11:26:22 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:26:22 [root] WARNING: 112
2015-09-30 11:26:22 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=S362&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:26:28 [scrapy] DEBUG: Retrying <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=L401&Option=1#htop> (failed 1 times): User timeout caused connection failure: Getting http://www.hkjc.com/english/racing/horse.asp?HorseNo=L401&Option=1 took longer than 180.0 seconds..
2015-09-30 11:26:29 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P281&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:26:29 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:26:29 [root] WARNING: 113
2015-09-30 11:26:29 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P281&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:26:43 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N268&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
2015-09-30 11:26:43 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:26:43 [root] WARNING: 114
2015-09-30 11:26:43 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N268&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:27:16 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N209&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:27:16 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:27:16 [root] WARNING: 115
2015-09-30 11:27:16 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=N209&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    jtohweights_h=jtohweights_h,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:27:17 [scrapy] INFO: Crawled 128 pages (at 4 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 11:27:30 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=L401&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
2015-09-30 11:27:30 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:27:30 [root] WARNING: 116
2015-09-30 11:27:30 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=L401&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    prev_avg_spds_cl =  prev_avg_spds_cl,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:27:44 [scrapy] DEBUG: Crawled (200) <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
2015-09-30 11:27:44 [root] WARNING: RaceSpider.count_unique_horse_request
2015-09-30 11:27:44 [root] WARNING: 117
2015-09-30 11:27:44 [scrapy] ERROR: Spider error processing <GET http://www.hkjc.com/english/racing/horse.asp?HorseNo=P309&Option=1#htop> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 924, in parse_horse
    prev_avg_spds_cl =  prev_avg_spds_cl,
NameError: global name 'jtohweights_h' is not defined
2015-09-30 11:27:44 [scrapy] INFO: Closing spider (finished)
2015-09-30 11:27:44 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/exception_count': 2,
 'downloader/exception_type_count/twisted.internet.error.TimeoutError': 1,
 'downloader/exception_type_count/twisted.web._newclient.ResponseFailed': 1,
 'downloader/request_bytes': 65746,
 'downloader/request_count': 133,
 'downloader/request_method_count/GET': 132,
 'downloader/request_method_count/POST': 1,
 'downloader/response_bytes': 10661390,
 'downloader/response_count': 131,
 'downloader/response_status_count/200': 130,
 'downloader/response_status_count/302': 1,
 'dupefilter/filtered': 1,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2015, 9, 30, 11, 27, 44, 361986),
 'log_count/DEBUG': 135,
 'log_count/ERROR': 118,
 'log_count/INFO': 18,
 'log_count/WARNING': 588,
 'request_depth_max': 5,
 'response_received_count': 130,
 'scheduler/dequeued': 133,
 'scheduler/dequeued/memory': 133,
 'scheduler/enqueued': 133,
 'scheduler/enqueued/memory': 133,
 'spider_exceptions/NameError': 109,
 'spider_exceptions/UnicodeEncodeError': 1,
 'spider_exceptions/ZeroDivisionError': 8,
 'start_time': datetime.datetime(2015, 9, 30, 11, 16, 17, 809223)}
2015-09-30 11:27:44 [scrapy] INFO: Spider closed (finished)
2015-09-30 11:41:47 [scrapy] INFO: Scrapy 1.0.3 started (bot: simpleraceday)
2015-09-30 11:41:47 [scrapy] INFO: Optional features available: ssl, http11, boto
2015-09-30 11:41:47 [scrapy] INFO: Overridden settings: {'NEWSPIDER_MODULE': 'simpleraceday.spiders', 'FEED_URI': 'output.csv', 'SPIDER_MODULES': ['simpleraceday.spiders'], 'BOT_NAME': 'simpleraceday', 'USER_AGENT': 'Googlebot/2.1 ( http://www.google.com/bot.html)', 'FEED_FORMAT': 'csv', 'LOG_FILE': 'scrapy_simpleraceday_2015-09-30.log'}
2015-09-30 11:41:47 [scrapy] INFO: Enabled extensions: CloseSpider, FeedExporter, TelnetConsole, LogStats, CoreStats, SpiderState, AutoThrottle
2015-09-30 11:41:47 [scrapy] INFO: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, MetaRefreshMiddleware, HttpCompressionMiddleware, RedirectMiddleware, CookiesMiddleware, ChunkedTransferMiddleware, DownloaderStats
2015-09-30 11:41:47 [scrapy] INFO: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware
2015-09-30 11:41:47 [scrapy] INFO: Enabled item pipelines: 
2015-09-30 11:41:47 [scrapy] INFO: Spider opened
2015-09-30 11:41:47 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2015-09-30 11:41:47 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6028
2015-09-30 11:41:51 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/login.asp> (referer: None)
2015-09-30 11:41:55 [scrapy] DEBUG: Redirecting (302) to <GET http://racing.scmp.com/index.asp> from <POST http://racing.scmp.com/Login.asp>
2015-09-30 11:42:04 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/index.asp> (referer: http://racing.scmp.com/login.asp)
2015-09-30 11:42:08 [scrapy] DEBUG: Crawled (200) <GET http://racing.scmp.com/racecardpro/racecardpro.asp> (referer: http://racing.scmp.com/index.asp)
2015-09-30 11:42:15 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1> (referer: http://racing.scmp.com/racecardpro/racecardpro.asp)
2015-09-30 11:42:15 [scrapy] DEBUG: Filtered duplicate request: <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1> - no more duplicates will be shown (see DUPEFILTER_DEBUG to show all duplicates)
2015-09-30 11:42:19 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/10> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 11:42:19 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:19 [root] WARNING: horse code set
2015-09-30 11:42:19 [root] WARNING: 1
2015-09-30 11:42:19 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:19 [root] WARNING: horse code set
2015-09-30 11:42:19 [root] WARNING: 2
2015-09-30 11:42:19 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:19 [root] WARNING: horse code set
2015-09-30 11:42:19 [root] WARNING: 3
2015-09-30 11:42:19 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:19 [root] WARNING: horse code set
2015-09-30 11:42:19 [root] WARNING: 4
2015-09-30 11:42:19 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:19 [root] WARNING: horse code set
2015-09-30 11:42:19 [root] WARNING: 5
2015-09-30 11:42:19 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:19 [root] WARNING: horse code set
2015-09-30 11:42:19 [root] WARNING: 6
2015-09-30 11:42:19 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:19 [root] WARNING: horse code set
2015-09-30 11:42:19 [root] WARNING: 7
2015-09-30 11:42:19 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:19 [root] WARNING: horse code set
2015-09-30 11:42:19 [root] WARNING: 8
2015-09-30 11:42:19 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:19 [root] WARNING: horse code set
2015-09-30 11:42:19 [root] WARNING: 9
2015-09-30 11:42:19 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:19 [root] WARNING: horse code set
2015-09-30 11:42:19 [root] WARNING: 10
2015-09-30 11:42:19 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:19 [root] WARNING: horse code set
2015-09-30 11:42:19 [root] WARNING: 11
2015-09-30 11:42:19 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:19 [root] WARNING: horse code set
2015-09-30 11:42:19 [root] WARNING: 12
2015-09-30 11:42:19 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:19 [root] WARNING: horse code set
2015-09-30 11:42:19 [root] WARNING: 13
2015-09-30 11:42:19 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:19 [root] WARNING: horse code set
2015-09-30 11:42:19 [root] WARNING: 14
2015-09-30 11:42:22 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/9> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 11:42:22 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:22 [root] WARNING: horse code set
2015-09-30 11:42:22 [root] WARNING: 15
2015-09-30 11:42:22 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:22 [root] WARNING: horse code set
2015-09-30 11:42:22 [root] WARNING: 16
2015-09-30 11:42:22 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:22 [root] WARNING: horse code set
2015-09-30 11:42:22 [root] WARNING: 17
2015-09-30 11:42:22 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:22 [root] WARNING: horse code set
2015-09-30 11:42:22 [root] WARNING: 18
2015-09-30 11:42:22 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:22 [root] WARNING: horse code set
2015-09-30 11:42:22 [root] WARNING: 19
2015-09-30 11:42:22 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:22 [root] WARNING: horse code set
2015-09-30 11:42:22 [root] WARNING: 20
2015-09-30 11:42:22 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:22 [root] WARNING: horse code set
2015-09-30 11:42:22 [root] WARNING: 21
2015-09-30 11:42:22 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:22 [root] WARNING: horse code set
2015-09-30 11:42:22 [root] WARNING: 22
2015-09-30 11:42:22 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:22 [root] WARNING: horse code set
2015-09-30 11:42:22 [root] WARNING: 23
2015-09-30 11:42:22 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:22 [root] WARNING: horse code set
2015-09-30 11:42:22 [root] WARNING: 24
2015-09-30 11:42:22 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:22 [root] WARNING: horse code set
2015-09-30 11:42:22 [root] WARNING: 25
2015-09-30 11:42:22 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:22 [root] WARNING: horse code set
2015-09-30 11:42:22 [root] WARNING: 26
2015-09-30 11:42:22 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:22 [root] WARNING: horse code set
2015-09-30 11:42:22 [root] WARNING: 27
2015-09-30 11:42:22 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:22 [root] WARNING: horse code set
2015-09-30 11:42:22 [root] WARNING: 28
2015-09-30 11:42:24 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/8> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 11:42:24 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:24 [root] WARNING: horse code set
2015-09-30 11:42:24 [root] WARNING: 29
2015-09-30 11:42:24 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:24 [root] WARNING: horse code set
2015-09-30 11:42:24 [root] WARNING: 30
2015-09-30 11:42:24 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:24 [root] WARNING: horse code set
2015-09-30 11:42:24 [root] WARNING: 31
2015-09-30 11:42:24 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:24 [root] WARNING: horse code set
2015-09-30 11:42:24 [root] WARNING: 32
2015-09-30 11:42:24 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:24 [root] WARNING: horse code set
2015-09-30 11:42:24 [root] WARNING: 33
2015-09-30 11:42:24 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:24 [root] WARNING: horse code set
2015-09-30 11:42:24 [root] WARNING: 34
2015-09-30 11:42:24 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:24 [root] WARNING: horse code set
2015-09-30 11:42:24 [root] WARNING: 35
2015-09-30 11:42:24 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:24 [root] WARNING: horse code set
2015-09-30 11:42:24 [root] WARNING: 36
2015-09-30 11:42:24 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:24 [root] WARNING: horse code set
2015-09-30 11:42:24 [root] WARNING: 37
2015-09-30 11:42:24 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:24 [root] WARNING: horse code set
2015-09-30 11:42:24 [root] WARNING: 38
2015-09-30 11:42:24 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:24 [root] WARNING: horse code set
2015-09-30 11:42:24 [root] WARNING: 39
2015-09-30 11:42:24 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:24 [root] WARNING: horse code set
2015-09-30 11:42:24 [root] WARNING: 40
2015-09-30 11:42:24 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:24 [root] WARNING: horse code set
2015-09-30 11:42:24 [root] WARNING: 41
2015-09-30 11:42:30 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/4> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 11:42:30 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:30 [root] WARNING: horse code set
2015-09-30 11:42:30 [root] WARNING: 42
2015-09-30 11:42:30 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:30 [root] WARNING: horse code set
2015-09-30 11:42:30 [root] WARNING: 43
2015-09-30 11:42:30 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:30 [root] WARNING: horse code set
2015-09-30 11:42:30 [root] WARNING: 44
2015-09-30 11:42:30 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:30 [root] WARNING: horse code set
2015-09-30 11:42:30 [root] WARNING: 45
2015-09-30 11:42:30 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:30 [root] WARNING: horse code set
2015-09-30 11:42:30 [root] WARNING: 46
2015-09-30 11:42:30 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:30 [root] WARNING: horse code set
2015-09-30 11:42:30 [root] WARNING: 47
2015-09-30 11:42:30 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:30 [root] WARNING: horse code set
2015-09-30 11:42:30 [root] WARNING: 48
2015-09-30 11:42:30 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:30 [root] WARNING: horse code set
2015-09-30 11:42:30 [root] WARNING: 49
2015-09-30 11:42:30 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:30 [root] WARNING: horse code set
2015-09-30 11:42:30 [root] WARNING: 50
2015-09-30 11:42:30 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:30 [root] WARNING: horse code set
2015-09-30 11:42:30 [root] WARNING: 51
2015-09-30 11:42:30 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:30 [root] WARNING: horse code set
2015-09-30 11:42:30 [root] WARNING: 52
2015-09-30 11:42:30 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:30 [root] WARNING: horse code set
2015-09-30 11:42:30 [root] WARNING: 53
2015-09-30 11:42:30 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:30 [root] WARNING: horse code set
2015-09-30 11:42:30 [root] WARNING: 54
2015-09-30 11:42:30 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 11:42:30 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:30 [root] WARNING: horse code set
2015-09-30 11:42:30 [root] WARNING: 55
2015-09-30 11:42:30 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:30 [root] WARNING: horse code set
2015-09-30 11:42:30 [root] WARNING: 56
2015-09-30 11:42:30 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:30 [root] WARNING: horse code set
2015-09-30 11:42:30 [root] WARNING: 57
2015-09-30 11:42:30 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:30 [root] WARNING: horse code set
2015-09-30 11:42:30 [root] WARNING: 58
2015-09-30 11:42:30 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:30 [root] WARNING: horse code set
2015-09-30 11:42:30 [root] WARNING: 59
2015-09-30 11:42:30 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:30 [root] WARNING: horse code set
2015-09-30 11:42:30 [root] WARNING: 60
2015-09-30 11:42:30 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:30 [root] WARNING: horse code set
2015-09-30 11:42:30 [root] WARNING: 61
2015-09-30 11:42:30 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:30 [root] WARNING: horse code set
2015-09-30 11:42:30 [root] WARNING: 62
2015-09-30 11:42:30 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:30 [root] WARNING: horse code set
2015-09-30 11:42:30 [root] WARNING: 63
2015-09-30 11:42:30 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:30 [root] WARNING: horse code set
2015-09-30 11:42:30 [root] WARNING: 64
2015-09-30 11:42:30 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:30 [root] WARNING: horse code set
2015-09-30 11:42:30 [root] WARNING: 65
2015-09-30 11:42:30 [scrapy] ERROR: Spider error processing <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/7> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/offsite.py", line 28, in process_spider_output
    for x in result:
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/referer.py", line 22, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/usr/local/lib/python2.7/dist-packages/scrapy/spidermiddlewares/depth.py", line 54, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/home/vmac/PY/simpleraceday/simpleraceday/spiders/simpleraceday.py", line 519, in parse_hkjc_racecard
    print("todays draw {}- {}").format(draw_, try_int(draw_))
UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 0: ordinal not in range(128)
2015-09-30 11:42:31 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/5> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 11:42:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:31 [root] WARNING: horse code set
2015-09-30 11:42:31 [root] WARNING: 66
2015-09-30 11:42:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:31 [root] WARNING: horse code set
2015-09-30 11:42:31 [root] WARNING: 67
2015-09-30 11:42:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:31 [root] WARNING: horse code set
2015-09-30 11:42:31 [root] WARNING: 68
2015-09-30 11:42:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:31 [root] WARNING: horse code set
2015-09-30 11:42:31 [root] WARNING: 69
2015-09-30 11:42:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:31 [root] WARNING: horse code set
2015-09-30 11:42:31 [root] WARNING: 70
2015-09-30 11:42:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:31 [root] WARNING: horse code set
2015-09-30 11:42:31 [root] WARNING: 71
2015-09-30 11:42:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:31 [root] WARNING: horse code set
2015-09-30 11:42:31 [root] WARNING: 72
2015-09-30 11:42:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:31 [root] WARNING: horse code set
2015-09-30 11:42:31 [root] WARNING: 73
2015-09-30 11:42:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:31 [root] WARNING: horse code set
2015-09-30 11:42:31 [root] WARNING: 74
2015-09-30 11:42:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:31 [root] WARNING: horse code set
2015-09-30 11:42:31 [root] WARNING: 75
2015-09-30 11:42:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:31 [root] WARNING: horse code set
2015-09-30 11:42:31 [root] WARNING: 76
2015-09-30 11:42:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:31 [root] WARNING: horse code set
2015-09-30 11:42:31 [root] WARNING: 77
2015-09-30 11:42:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:31 [root] WARNING: horse code set
2015-09-30 11:42:31 [root] WARNING: 78
2015-09-30 11:42:31 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:31 [root] WARNING: horse code set
2015-09-30 11:42:31 [root] WARNING: 79
2015-09-30 11:42:33 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/6> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 11:42:33 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:33 [root] WARNING: horse code set
2015-09-30 11:42:33 [root] WARNING: 80
2015-09-30 11:42:33 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:33 [root] WARNING: horse code set
2015-09-30 11:42:33 [root] WARNING: 81
2015-09-30 11:42:33 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:33 [root] WARNING: horse code set
2015-09-30 11:42:33 [root] WARNING: 82
2015-09-30 11:42:33 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:33 [root] WARNING: horse code set
2015-09-30 11:42:33 [root] WARNING: 83
2015-09-30 11:42:33 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:33 [root] WARNING: horse code set
2015-09-30 11:42:33 [root] WARNING: 84
2015-09-30 11:42:33 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:33 [root] WARNING: horse code set
2015-09-30 11:42:33 [root] WARNING: 85
2015-09-30 11:42:33 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:33 [root] WARNING: horse code set
2015-09-30 11:42:33 [root] WARNING: 86
2015-09-30 11:42:33 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:33 [root] WARNING: horse code set
2015-09-30 11:42:33 [root] WARNING: 87
2015-09-30 11:42:33 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:33 [root] WARNING: horse code set
2015-09-30 11:42:33 [root] WARNING: 88
2015-09-30 11:42:33 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:33 [root] WARNING: horse code set
2015-09-30 11:42:33 [root] WARNING: 89
2015-09-30 11:42:33 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:33 [root] WARNING: horse code set
2015-09-30 11:42:33 [root] WARNING: 90
2015-09-30 11:42:33 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:33 [root] WARNING: horse code set
2015-09-30 11:42:33 [root] WARNING: 91
2015-09-30 11:42:33 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:33 [root] WARNING: horse code set
2015-09-30 11:42:33 [root] WARNING: 92
2015-09-30 11:42:33 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:33 [root] WARNING: horse code set
2015-09-30 11:42:33 [root] WARNING: 93
2015-09-30 11:42:36 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/2> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 11:42:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:36 [root] WARNING: horse code set
2015-09-30 11:42:36 [root] WARNING: 94
2015-09-30 11:42:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:36 [root] WARNING: horse code set
2015-09-30 11:42:36 [root] WARNING: 95
2015-09-30 11:42:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:36 [root] WARNING: horse code set
2015-09-30 11:42:36 [root] WARNING: 96
2015-09-30 11:42:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:36 [root] WARNING: horse code set
2015-09-30 11:42:36 [root] WARNING: 97
2015-09-30 11:42:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:36 [root] WARNING: horse code set
2015-09-30 11:42:36 [root] WARNING: 98
2015-09-30 11:42:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:36 [root] WARNING: horse code set
2015-09-30 11:42:36 [root] WARNING: 99
2015-09-30 11:42:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:36 [root] WARNING: horse code set
2015-09-30 11:42:36 [root] WARNING: 100
2015-09-30 11:42:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:36 [root] WARNING: horse code set
2015-09-30 11:42:36 [root] WARNING: 101
2015-09-30 11:42:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:36 [root] WARNING: horse code set
2015-09-30 11:42:36 [root] WARNING: 102
2015-09-30 11:42:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:36 [root] WARNING: horse code set
2015-09-30 11:42:36 [root] WARNING: 103
2015-09-30 11:42:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:36 [root] WARNING: horse code set
2015-09-30 11:42:36 [root] WARNING: 104
2015-09-30 11:42:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:36 [root] WARNING: horse code set
2015-09-30 11:42:36 [root] WARNING: 105
2015-09-30 11:42:36 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:36 [root] WARNING: horse code set
2015-09-30 11:42:36 [root] WARNING: 106
2015-09-30 11:42:41 [scrapy] INFO: Received SIGINT, shutting down gracefully. Send again to force 
2015-09-30 11:42:41 [scrapy] INFO: Closing spider (shutdown)
2015-09-30 11:42:41 [scrapy] DEBUG: Crawled (200) <GET http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/3> (referer: http://racing.hkjc.com/racing/Info/Meeting/RaceCard/English/Local/20150928/ST/1)
2015-09-30 11:42:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:41 [root] WARNING: horse code set
2015-09-30 11:42:41 [root] WARNING: 107
2015-09-30 11:42:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:41 [root] WARNING: horse code set
2015-09-30 11:42:41 [root] WARNING: 108
2015-09-30 11:42:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:41 [root] WARNING: horse code set
2015-09-30 11:42:41 [root] WARNING: 109
2015-09-30 11:42:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:41 [root] WARNING: horse code set
2015-09-30 11:42:41 [root] WARNING: 110
2015-09-30 11:42:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:41 [root] WARNING: horse code set
2015-09-30 11:42:41 [root] WARNING: 111
2015-09-30 11:42:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:41 [root] WARNING: horse code set
2015-09-30 11:42:41 [root] WARNING: 112
2015-09-30 11:42:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:41 [root] WARNING: horse code set
2015-09-30 11:42:41 [root] WARNING: 113
2015-09-30 11:42:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:41 [root] WARNING: horse code set
2015-09-30 11:42:41 [root] WARNING: 114
2015-09-30 11:42:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:41 [root] WARNING: horse code set
2015-09-30 11:42:41 [root] WARNING: 115
2015-09-30 11:42:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:41 [root] WARNING: horse code set
2015-09-30 11:42:41 [root] WARNING: 116
2015-09-30 11:42:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:41 [root] WARNING: horse code set
2015-09-30 11:42:41 [root] WARNING: 117
2015-09-30 11:42:41 [root] WARNING: -------------------------------------------------
2015-09-30 11:42:41 [root] WARNING: horse code set
2015-09-30 11:42:41 [root] WARNING: 118
